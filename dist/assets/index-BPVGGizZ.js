const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-Dpb-j42P.js","assets/dnd-7mlNwzRc.js","assets/vendor-Rh7fhQc2.js","assets/jszip.min-2X8rbmn9.js"])))=>i.map(i=>d[i]);
import{r as e,j as t,a as r}from"./dnd-7mlNwzRc.js";import{a,g as s}from"./vendor-Rh7fhQc2.js";import{C as o,X as n,a as i,S as l,B as c,V as d,F as m,b as p,P as h,c as u,d as g,H as y,M as x,G as f,e as b,f as v,U as w,L as j,D as N,Z as k,g as C,h as A,i as S,T as P,j as I,k as T,A as E,l as D,m as $,n as M,o as L,R as O,p as F,q as z,r as R,s as U,t as W,E as _,u as B,v as H,w as G,x as q,y as V,z as J,I as K,J as Y,K as Q,W as X,N as Z,O as ee,Q as te,Y as re,_ as ae,$ as se,a0 as oe,a1 as ne,a2 as ie,a3 as le,a4 as ce,a5 as de,a6 as me,a7 as pe,a8 as he,a9 as ue,aa as ge,ab as ye,ac as xe,ad as fe,ae as be,af as ve,ag as we,ah as je,ai as Ne,aj as ke,ak as Ce}from"./ui-BkjvJFgo.js";import{O as Ae}from"./ai-Bh8ckaFx.js";import{_ as Se}from"./pdf-Dpb-j42P.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var Pe,Ie={};const Te=s(function(){if(Pe)return Ie;Pe=1;var e=a();return Ie.createRoot=e.createRoot,Ie.hydrateRoot=e.hydrateRoot,Ie}());var Ee=Object.defineProperty,De=(e,t,r)=>((e,t,r)=>t in e?Ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);const $e={PROJECTS:"storyboard_projects",CURRENT_PROJECT:"storyboard_current_project",SETTINGS:"storyboard_settings",AI_CONVERSATIONS:"storyboard_ai_conversations"},Me="images",Le=class e{constructor(){De(this,"db",null),this.initDB()}static getInstance(){return e.instance||(e.instance=new e),e.instance}async initDB(){try{const e=indexedDB.open("StoryboardAI",1);e.onerror=()=>{console.error("Failed to open IndexedDB:",e.error)},e.onsuccess=()=>{this.db=e.result,console.log("âœ… IndexedDB initialized successfully")},e.onupgradeneeded=e=>{const t=e.target.result;if(!t.objectStoreNames.contains(Me)){t.createObjectStore(Me,{keyPath:"id"}).createIndex("createdAt","createdAt",{unique:!1}),console.log("ðŸ“¦ IndexedDB object store created")}}}catch(e){console.error("Failed to initialize IndexedDB:",e)}}async saveImageToDB(e,t){const r=indexedDB.open("StoryboardAI",1);return r.onupgradeneeded=()=>{const e=r.result;e.objectStoreNames.contains("images")||e.createObjectStore("images",{keyPath:"id"})},new Promise(((a,s)=>{r.onsuccess=()=>{const o=r.result.transaction(["images"],"readwrite");o.objectStore("images").put({id:e,data:t}),o.oncomplete=()=>a(),o.onerror=()=>s(o.error)},r.onerror=()=>s(r.error)}))}async getImageFromDB(e){const t=indexedDB.open("StoryboardAI",1);return new Promise(((r,a)=>{t.onsuccess=()=>{const a=t.result;if(!a.objectStoreNames.contains("images"))return void r(null);const s=a.transaction(["images"],"readonly").objectStore("images").get(e);s.onsuccess=()=>{const e=s.result;r(e?e.data:null)},s.onerror=()=>r(null)},t.onerror=()=>r(null)}))}async deleteImageFromDB(e){return new Promise((t=>{if(!this.db){try{localStorage.removeItem(`storyboard_image_${e}`)}catch(a){console.warn("Failed to delete image from localStorage:",a)}return void t()}const r=this.db.transaction([Me],"readwrite").objectStore(Me).delete(e);r.onsuccess=()=>t(),r.onerror=()=>{console.warn("Failed to delete image from IndexedDB:",r.error),t()}}))}async saveProject(e){try{console.log("ðŸ’¾ Saving project with enhanced storage...");const t=JSON.parse(JSON.stringify(e)),r=[];t.panels=await Promise.all(e.panels.map((async e=>{const t={...e};if(e.imageUrl&&e.imageUrl.startsWith("data:image/")){const a=`panel_${e.id}_${Date.now()}`;r.push(this.saveImageToDB(a,e.imageUrl)),t.imageUrl=`stored:${a}`,console.log(`ðŸ“¸ Storing large image separately: ${a}`)}return t}))),await Promise.all(r);const a=await this.getAllProjects(),s=a.findIndex((t=>t.id===e.id)),o={...t,updatedAt:new Date};s>=0?a[s]=o:a.push(o),localStorage.setItem($e.PROJECTS,JSON.stringify(a)),localStorage.setItem($e.CURRENT_PROJECT,JSON.stringify(o)),console.log("âœ… Project saved successfully with separated image storage")}catch(t){throw console.error("Failed to save project:",t),new Error("Failed to save project to browser storage")}}async getCurrentProject(){try{const e=localStorage.getItem($e.CURRENT_PROJECT);if(!e)return null;const t=JSON.parse(e);return{...t,createdAt:new Date(t.createdAt),updatedAt:new Date(t.updatedAt),lastOpened:t.lastOpened?new Date(t.lastOpened):void 0,panels:await Promise.all(t.panels.map((async e=>{const t={...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt)};if("object"==typeof t.description&&null!==t.description){console.warn(`ðŸ©¹ Fixing corrupted panel description for panel ID: ${t.id}`);const e=t.description;t.description=`Lighting: ${e.lighting||"N/A"}. Performance: ${e.performance||"N/A"}. Camera Movement: ${e.cameraMovement||"N/A"}. Composition: ${e.composition||"N/A"}. Sound: ${e.sound||"N/A"}.`}if(e.imageUrl&&e.imageUrl.startsWith("stored:")){const r=e.imageUrl.replace("stored:",""),a=await this.getImageFromDB(r);a?(t.imageUrl=a,console.log(`ðŸ“¸ Restored image: ${r}`)):(console.warn(`âš ï¸ Could not restore image: ${r}`),t.imageUrl=null)}return t})))}}catch(e){return console.error("Failed to load current project:",e),null}}async getAllProjects(){try{const e=localStorage.getItem($e.PROJECTS);if(!e)return[];return JSON.parse(e).map((e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),lastOpened:e.lastOpened?new Date(e.lastOpened):void 0,panels:e.panels.map((e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),imageUrl:e.imageUrl&&e.imageUrl.startsWith("stored:")?null:e.imageUrl})))})))}catch(e){return console.error("Failed to load projects:",e),[]}}async deleteProject(e){try{const t=await this.getAllProjects(),r=t.find((t=>t.id===e));if(r){const e=r.panels.filter((e=>e.imageUrl&&e.imageUrl.startsWith("stored:"))).map((e=>{const t=e.imageUrl.replace("stored:","");return this.deleteImageFromDB(t)}));await Promise.all(e),console.log("ðŸ—‘ï¸ Deleted associated images")}const a=t.filter((t=>t.id!==e));localStorage.setItem($e.PROJECTS,JSON.stringify(a));const s=await this.getCurrentProject();s&&s.id===e&&localStorage.removeItem($e.CURRENT_PROJECT)}catch(t){throw console.error("Failed to delete project:",t),new Error("Failed to delete project from browser storage")}}getSettings(){try{const e=localStorage.getItem($e.SETTINGS);if(!e)return{darkMode:!1,autoSave:!0,lastUsed:new Date};const t=JSON.parse(e);return{...t,lastUsed:new Date(t.lastUsed)}}catch(e){return console.error("Failed to load settings:",e),{darkMode:!1,autoSave:!0,lastUsed:new Date}}}saveSettings(e){try{const t={...this.getSettings(),...e,lastUsed:new Date};localStorage.setItem($e.SETTINGS,JSON.stringify(t))}catch(t){throw console.error("Failed to save settings:",t),new Error("Failed to save settings to browser storage")}}saveConversation(e,t){try{const r=this.getConversations();r[e]={messages:t,updatedAt:(new Date).toISOString()},localStorage.setItem($e.AI_CONVERSATIONS,JSON.stringify(r))}catch(r){console.error("Failed to save conversation:",r)}}getConversations(){try{const e=localStorage.getItem($e.AI_CONVERSATIONS);return e?JSON.parse(e):{}}catch(e){return console.error("Failed to load conversations:",e),{}}}async exportData(){try{const e=await this.getAllProjects(),t={projects:await Promise.all(e.map((async e=>({...e,panels:await Promise.all(e.panels.map((async e=>{if(e.imageUrl&&e.imageUrl.startsWith("stored:")){const t=e.imageUrl.replace("stored:",""),r=await this.getImageFromDB(t);return{...e,imageUrl:r}}return e})))})))),settings:this.getSettings(),conversations:this.getConversations(),exportedAt:(new Date).toISOString(),version:"1.0.0"};return JSON.stringify(t,null,2)}catch(e){throw console.error("Failed to export data:",e),new Error("Failed to export data")}}async importData(e){try{const s=JSON.parse(e);let o=0,n=!1,i=!1;if(!s||"object"!=typeof s)throw new Error("Invalid import data structure");if(s.projects&&Array.isArray(s.projects)){console.log(`ðŸ“¦ Importing ${s.projects.length} projects...`);for(const e of s.projects)try{if(!e.id||!e.title||!Array.isArray(e.panels)){console.warn("âš ï¸ Skipping invalid project:",e.title||"Unnamed");continue}const t={...e,id:e.id||`imported-${Date.now()}-${Math.random()}`,title:e.title||"Imported Project",description:e.description||"",createdAt:e.createdAt?new Date(e.createdAt):new Date,updatedAt:e.updatedAt?new Date(e.updatedAt):new Date,panels:e.panels.map(((e,t)=>({id:e.id||`imported-panel-${Date.now()}-${t}`,title:e.title||`Panel ${t+1}`,description:e.description||"",imageUrl:e.imageUrl,videoUrl:e.videoUrl,videoPrompt:e.videoPrompt||e.aiGeneratedPrompt,aiGeneratedPrompt:e.aiGeneratedPrompt||e.videoPrompt,shotType:e.shotType||"medium-shot",cameraAngle:e.cameraAngle||"eye-level",notes:e.notes||"",duration:"number"==typeof e.duration?e.duration:3,order:t,createdAt:e.createdAt?new Date(e.createdAt):new Date,updatedAt:e.updatedAt?new Date(e.updatedAt):new Date})))};await this.saveProject(t),o++,console.log(`âœ… Imported project: ${t.title}`)}catch(t){console.error(`âŒ Failed to import project ${e.title||"Unknown"}:`,t)}}else if(s.project){console.log("ðŸ“¦ Importing single project...");try{const e=s.project;if(!(e.id&&e.title&&Array.isArray(e.panels)))throw new Error("Invalid project structure in import data");await this.saveProject(e),o=1,console.log(`âœ… Imported project: ${e.title}`)}catch(t){console.error("âŒ Failed to import project:",t)}}else if(s.id&&s.title&&Array.isArray(s.panels)){console.log("ðŸ“¦ Importing direct project format...");try{await this.saveProject(s),o=1,console.log(`âœ… Imported project: ${s.title}`)}catch(t){console.error("âŒ Failed to import project:",t)}}if(s.settings&&"object"==typeof s.settings)try{const e={...s.settings,lastUsed:new Date};delete e.openaiApiKey,localStorage.setItem($e.SETTINGS,JSON.stringify(e)),n=!0,console.log("âœ… Imported settings")}catch(r){console.error("âŒ Failed to import settings:",r)}if(s.conversations&&"object"==typeof s.conversations)try{localStorage.setItem($e.AI_CONVERSATIONS,JSON.stringify(s.conversations)),i=!0,console.log("âœ… Imported AI conversations")}catch(a){console.error("âŒ Failed to import conversations:",a)}return console.log(`ðŸ“ˆ Import summary: ${o} projects, settings: ${n}, conversations: ${i}`),{projects:o,settings:n,conversations:i}}catch(s){throw console.error("Failed to import data:",s),s instanceof SyntaxError?new Error("Invalid JSON format - please check your import file"):s instanceof Error?new Error(`Import failed: ${s.message}`):new Error("Failed to import data - unknown error")}}clearAllData(){try{if(Object.values($e).forEach((e=>{localStorage.removeItem(e)})),this.db){const e=this.db.transaction([Me],"readwrite");e.objectStore(Me).clear()}}catch(e){throw console.error("Failed to clear data:",e),new Error("Failed to clear browser storage")}}async getStorageUsage(){try{let e=0;for(let o in localStorage)localStorage.hasOwnProperty(o)&&(e+=localStorage[o].length+o.length);let t=0;this.db&&(t=await this.estimateIndexedDBSize());const r=e+t,a=52428800,s=r/a*100;return{used:r,available:a-r,percentage:Math.min(s,100),breakdown:{localStorage:e,indexedDB:t}}}catch(e){return console.error("Failed to calculate storage usage:",e),{used:0,available:0,percentage:0,breakdown:{}}}}async estimateIndexedDBSize(){return new Promise((e=>{if(this.db)try{const t=this.db.transaction([Me],"readonly"),r=t.objectStore(Me).getAll();r.onsuccess=()=>{const t=r.result.reduce(((e,t)=>e+t.data.length),0);e(t)},r.onerror=()=>e(0)}catch(t){e(0)}else e(0)}))}};De(Le,"instance");const Oe=Le.getInstance(),Fe=[{id:"1",title:"Opening Shot",description:"Wide establishing shot of the cityscape at dawn",shotType:"wide-shot",cameraAngle:"high-angle",notes:"Golden hour lighting, peaceful atmosphere",duration:5,order:0,createdAt:new Date,updatedAt:new Date},{id:"2",title:"Character Introduction",description:"Close-up of protagonist waking up",shotType:"close-up",cameraAngle:"eye-level",notes:"Focus on facial expression, natural lighting",duration:3,order:1,createdAt:new Date,updatedAt:new Date},{id:"3",title:"Daily Routine",description:"Medium shot of character preparing coffee",shotType:"medium-shot",cameraAngle:"eye-level",notes:"Show character's morning routine, warm tones",duration:4,order:2,createdAt:new Date,updatedAt:new Date}];function ze(e,t){let r;switch(t.type){case"SET_PROJECT":return r={...e,currentProject:t.payload,panels:t.payload.panels},Oe.saveProject(t.payload).catch(console.error),r;case"ADD_PANEL":const a=[...e.panels,t.payload];if(r={...e,panels:a},e.currentProject){const t={...e.currentProject,panels:a,updatedAt:new Date};Oe.saveProject(t).catch(console.error),r.currentProject=t}return r;case"UPDATE_PANEL":const s=e.panels.map((e=>e.id===t.payload.id?{...e,...t.payload.updates,updatedAt:new Date}:e));if(r={...e,panels:s},e.currentProject){const t={...e.currentProject,panels:s,updatedAt:new Date};Oe.saveProject(t).catch(console.error),r.currentProject=t}return r;case"DELETE_PANEL":const o=e.panels.filter((e=>e.id!==t.payload));if(r={...e,panels:o,selectedPanel:e.selectedPanel===t.payload?null:e.selectedPanel},e.currentProject){const t={...e.currentProject,panels:o,updatedAt:new Date};Oe.saveProject(t).catch(console.error),r.currentProject=t}return r;case"REORDER_PANELS":console.log("ðŸ”„ Processing REORDER_PANELS action:",t.payload),console.log("ðŸ“‹ Original panels:",e.panels.map((e=>({id:e.id,order:e.order}))));const n=[...e.panels],[i]=n.splice(t.payload.fromIndex,1);n.splice(t.payload.toIndex,0,i);const l=n.map(((e,t)=>({...e,order:t})));if(console.log("ðŸ“‹ Reordered panels:",l.map((e=>({id:e.id,order:e.order})))),r={...e,panels:l},e.currentProject){const t={...e.currentProject,panels:l,updatedAt:new Date};Oe.saveProject(t).catch(console.error),r.currentProject=t}return r;case"SELECT_PANEL":return{...e,selectedPanel:t.payload};case"SET_LOADING":return{...e,isLoading:t.payload};case"SET_ERROR":return{...e,error:t.payload};case"SET_PANELS":const c=t.payload;if(r={...e,panels:c},e.currentProject){const t={...e.currentProject,panels:c,updatedAt:new Date};Oe.saveProject(t).catch(console.error),r.currentProject=t}return r;default:return e}}const Re=e.createContext(null);function Ue({children:r}){const[a,s]=e.useReducer(ze,{currentProject:null,panels:[],selectedPanel:null,isLoading:!0,error:null});return e.useEffect((()=>{(async()=>{try{const e=await Oe.getCurrentProject();if(e)s({type:"SET_PROJECT",payload:e}),s({type:"SET_LOADING",payload:!1});else{const e={id:"sample-project",title:"My First Storyboard",description:"A sample storyboard project to get you started",panels:Fe,createdAt:new Date,updatedAt:new Date};await Oe.saveProject(e),s({type:"SET_PROJECT",payload:e}),s({type:"SET_LOADING",payload:!1})}}catch(e){console.error("Failed to initialize from storage:",e),s({type:"SET_ERROR",payload:"Failed to load project data"}),s({type:"SET_LOADING",payload:!1})}})()}),[]),e.useEffect((()=>{if(Oe.getSettings().autoSave&&a.currentProject){const e=setTimeout((()=>{Oe.saveProject(a.currentProject).catch(console.error)}),1e3);return()=>clearTimeout(e)}}),[a.panels,a.currentProject]),t.jsx(Re.Provider,{value:{state:a,dispatch:s},children:r})}function We(){const t=e.useContext(Re);if(!t)throw new Error("useStoryboard must be used within a StoryboardProvider");return t}const _e=e=>({status:{success:{background:(e.id,"#10b981"),text:"#ffffff",border:(e.id,"#059669"),light:"dark"===e.id?"#10b98120":"#f0fdf4",hover:(e.id,"#059669")},warning:{background:(e.id,"#f59e0b"),text:"#ffffff",border:(e.id,"#d97706"),light:"dark"===e.id?"#f59e0b20":"#fffbeb",hover:(e.id,"#d97706")},error:{background:(e.id,"#ef4444"),text:"#ffffff",border:(e.id,"#dc2626"),light:"dark"===e.id?"#ef444420":"#fef2f2",hover:(e.id,"#dc2626")},info:{background:e.colors.primary[500],text:"#ffffff",border:e.colors.primary[600],light:"dark"===e.id?`${e.colors.primary[500]}20`:e.colors.primary[50],hover:e.colors.primary[600]}},text:{primary:{color:"dark"===e.id?"#ffffff":"#0f172a",opacity:1},secondary:{color:"dark"===e.id?"#e2e8f0":"#374151",opacity:.9},tertiary:{color:"dark"===e.id?"#cbd5e1":"#4b5563",opacity:.8},muted:{color:"dark"===e.id?"#94a3b8":"#6b7280",opacity:.7}},interactive:{primary:{background:e.colors.primary[500],hover:e.colors.primary[600],active:e.colors.primary[700],text:"#ffffff",disabled:e.colors.primary[300]},secondary:{background:e.colors.background.secondary,hover:"dark"===e.id?e.colors.secondary[700]:e.colors.secondary[100],active:"dark"===e.id?e.colors.secondary[600]:e.colors.secondary[200],text:"dark"===e.id?"#ffffff":"#0f172a",border:e.colors.border.primary}},project:{blue:{background:"#3b82f6",text:"#ffffff",light:"#dbeafe"},purple:{background:"#8b5cf6",text:"#ffffff",light:"#e9d5ff"},green:{background:"#10b981",text:"#ffffff",light:"#d1fae5"},red:{background:"#ef4444",text:"#ffffff",light:"#fee2e2"},orange:{background:"#f59e0b",text:"#ffffff",light:"#fef3c7"},pink:{background:"#ec4899",text:"#ffffff",light:"#fce7f3"},indigo:{background:"#6366f1",text:"#ffffff",light:"#e0e7ff"},gray:{background:"#6b7280",text:"#ffffff",light:"#f3f4f6"},yellow:{background:"#eab308",text:"#ffffff",light:"#fefce8"},teal:{background:"#14b8a6",text:"#ffffff",light:"#f0fdfa"}},window:{controls:{close:{background:"#ef4444",hover:"#dc2626"},minimize:{background:"#f59e0b",hover:"#d97706"},maximize:{background:"#10b981",hover:"#059669"}}},overlay:{backdrop:"dark"===e.id?"rgba(0, 0, 0, 0.9)":"rgba(0, 0, 0, 0.6)",modal:"dark"===e.id?"rgba(255, 255, 255, 0.05)":"rgba(255, 255, 255, 0.95)",dropdown:"dark"===e.id?"rgba(255, 255, 255, 0.1)":"rgba(255, 255, 255, 0.9)"},shadows:{sm:"dark"===e.id?"0 1px 2px rgba(0,0,0,0.3)":"0 1px 2px rgba(0,0,0,0.05)",md:"dark"===e.id?"0 4px 8px rgba(0,0,0,0.3)":"0 4px 8px rgba(0,0,0,0.1)",lg:"dark"===e.id?"0 10px 30px rgba(0,0,0,0.4)":"0 10px 30px rgba(0,0,0,0.1)",xl:"dark"===e.id?"0 20px 40px rgba(0,0,0,0.5)":"0 20px 40px rgba(0,0,0,0.15)"}}),Be={light:{id:"light",name:"Light",colors:{primary:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e"},secondary:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827"},background:{primary:"#ffffff",secondary:"#f9fafb",tertiary:"#f3f4f6"},text:{primary:"#111827",secondary:"#4b5563",tertiary:"#6b7280"},border:{primary:"#e5e7eb",secondary:"#d1d5db"}}},dark:{id:"dark",name:"Dark",colors:{primary:{50:"#1e293b",100:"#334155",200:"#475569",300:"#64748b",400:"#94a3b8",500:"#cbd5e1",600:"#e2e8f0",700:"#f1f5f9",800:"#f8fafc",900:"#ffffff"},secondary:{50:"#0f172a",100:"#1e293b",200:"#334155",300:"#475569",400:"#64748b",500:"#94a3b8",600:"#cbd5e1",700:"#e2e8f0",800:"#f1f5f9",900:"#f8fafc"},background:{primary:"#0f172a",secondary:"#1e293b",tertiary:"#334155"},text:{primary:"#f8fafc",secondary:"#cbd5e1",tertiary:"#94a3b8"},border:{primary:"#334155",secondary:"#475569"}}},purple:{id:"purple",name:"Purple",colors:{primary:{50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7c3aed",800:"#6b21a8",900:"#581c87"},secondary:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827"},background:{primary:"#ffffff",secondary:"#faf5ff",tertiary:"#f3e8ff"},text:{primary:"#111827",secondary:"#4b5563",tertiary:"#6b7280"},border:{primary:"#e9d5ff",secondary:"#d8b4fe"}}},blue:{id:"blue",name:"Ocean Blue",colors:{primary:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a"},secondary:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e"},background:{primary:"#ffffff",secondary:"#eff6ff",tertiary:"#dbeafe"},text:{primary:"#111827",secondary:"#4b5563",tertiary:"#6b7280"},border:{primary:"#bfdbfe",secondary:"#93c5fd"}}},green:{id:"green",name:"Forest Green",colors:{primary:{50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d"},secondary:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e"},background:{primary:"#ffffff",secondary:"#f0fdf4",tertiary:"#dcfce7"},text:{primary:"#111827",secondary:"#4b5563",tertiary:"#6b7280"},border:{primary:"#bbf7d0",secondary:"#86efac"}}},orange:{id:"orange",name:"Sunset Orange",colors:{primary:{50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12"},secondary:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d"},background:{primary:"#ffffff",secondary:"#fff7ed",tertiary:"#ffedd5"},text:{primary:"#111827",secondary:"#4b5563",tertiary:"#6b7280"},border:{primary:"#fed7aa",secondary:"#fdba74"}}},rose:{id:"rose",name:"Rose",colors:{primary:{50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337"},secondary:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827"},background:{primary:"#ffffff",secondary:"#fff1f2",tertiary:"#ffe4e6"},text:{primary:"#111827",secondary:"#4b5563",tertiary:"#6b7280"},border:{primary:"#fecdd3",secondary:"#fda4af"}}},emerald:{id:"emerald",name:"Emerald",colors:{primary:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b"},secondary:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e"},background:{primary:"#ffffff",secondary:"#ecfdf5",tertiary:"#d1fae5"},text:{primary:"#111827",secondary:"#4b5563",tertiary:"#6b7280"},border:{primary:"#a7f3d0",secondary:"#6ee7b7"}}},teal:{id:"teal",name:"Teal",colors:{primary:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a"},secondary:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827"},background:{primary:"#ffffff",secondary:"#f0fdfa",tertiary:"#ccfbf1"},text:{primary:"#111827",secondary:"#4b5563",tertiary:"#6b7280"},border:{primary:"#99f6e4",secondary:"#5eead4"}}},amber:{id:"amber",name:"Amber",colors:{primary:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f"},secondary:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827"},background:{primary:"#ffffff",secondary:"#fffbeb",tertiary:"#fef3c7"},text:{primary:"#111827",secondary:"#4b5563",tertiary:"#6b7280"},border:{primary:"#fde68a",secondary:"#fcd34d"}}},violet:{id:"violet",name:"Violet",colors:{primary:{50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95"},secondary:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827"},background:{primary:"#ffffff",secondary:"#f5f3ff",tertiary:"#ede9fe"},text:{primary:"#111827",secondary:"#4b5563",tertiary:"#6b7280"},border:{primary:"#ddd6fe",secondary:"#c4b5fd"}}},slate:{id:"slate",name:"Slate",colors:{primary:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a"},secondary:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827"},background:{primary:"#ffffff",secondary:"#f8fafc",tertiary:"#f1f5f9"},text:{primary:"#111827",secondary:"#4b5563",tertiary:"#6b7280"},border:{primary:"#e2e8f0",secondary:"#cbd5e1"}}}},He=()=>{let e="light";if("undefined"!=typeof window)try{const t=localStorage.getItem("storyboard-theme");t&&Be[t]&&(e=t)}catch(t){console.warn("Could not access localStorage to get initial theme.")}return{currentTheme:e,theme:Be[e]||Be.light}};function Ge(e,t){if("SET_THEME"===t.type){const a=Be[t.payload];if(!a)return e;try{localStorage.setItem("storyboard-theme",t.payload)}catch(r){console.warn("Could not save theme to localStorage.")}return{currentTheme:t.payload,theme:a}}return e}const qe=e.createContext(null);function Ve({children:r}){const[a,s]=e.useReducer(Ge,void 0,He);e.useEffect((()=>{!function(e){const t=document.documentElement;t.style.setProperty("--primary-50",e.colors.primary[50]),t.style.setProperty("--primary-100",e.colors.primary[100]),t.style.setProperty("--primary-200",e.colors.primary[200]),t.style.setProperty("--primary-300",e.colors.primary[300]),t.style.setProperty("--primary-400",e.colors.primary[400]),t.style.setProperty("--primary-500",e.colors.primary[500]),t.style.setProperty("--primary-600",e.colors.primary[600]),t.style.setProperty("--primary-700",e.colors.primary[700]),t.style.setProperty("--primary-800",e.colors.primary[800]),t.style.setProperty("--primary-900",e.colors.primary[900]),t.style.setProperty("--bg-primary",e.colors.background.primary),t.style.setProperty("--bg-secondary",e.colors.background.secondary),t.style.setProperty("--bg-tertiary",e.colors.background.tertiary),t.style.setProperty("--text-primary",e.colors.text.primary),t.style.setProperty("--text-secondary",e.colors.text.secondary),t.style.setProperty("--text-tertiary",e.colors.text.tertiary),t.style.setProperty("--border-primary",e.colors.border.primary),t.style.setProperty("--border-secondary",e.colors.border.secondary),t.setAttribute("data-theme",e.id),"dark"===e.id?(t.style.setProperty("--scrollbar-track","rgba(255, 255, 255, 0.05)"),t.style.setProperty("--scrollbar-thumb","rgba(255, 255, 255, 0.2)"),t.style.setProperty("--scrollbar-thumb-hover","rgba(255, 255, 255, 0.3)")):(t.style.setProperty("--scrollbar-track","rgba(0, 0, 0, 0.05)"),t.style.setProperty("--scrollbar-thumb","rgba(0, 0, 0, 0.2)"),t.style.setProperty("--scrollbar-thumb-hover","rgba(0, 0, 0, 0.3)"))}(a.theme),(e=>{const t=_e(e),r=document.documentElement;r.style.setProperty("--color-success",t.status.success.background),r.style.setProperty("--color-success-hover",t.status.success.hover),r.style.setProperty("--color-success-light",t.status.success.light),r.style.setProperty("--color-warning",t.status.warning.background),r.style.setProperty("--color-warning-hover",t.status.warning.hover),r.style.setProperty("--color-warning-light",t.status.warning.light),r.style.setProperty("--color-error",t.status.error.background),r.style.setProperty("--color-error-hover",t.status.error.hover),r.style.setProperty("--color-error-light",t.status.error.light),r.style.setProperty("--color-interactive-hover",t.interactive.secondary.hover),r.style.setProperty("--color-interactive-active",t.interactive.secondary.active),r.style.setProperty("--color-backdrop",t.overlay.backdrop),r.style.setProperty("--color-modal",t.overlay.modal)})(a.theme)}),[a.theme]);return t.jsx(qe.Provider,{value:{state:a,dispatch:s,setTheme:e=>{s({type:"SET_THEME",payload:e})}},children:r})}function Je(){const t=e.useContext(qe);if(!t)throw new Error("useTheme must be used within a ThemeProvider");return t}const Ke=[{id:"ai-assistant",label:"AI Assistant",icon:t.jsx(c,{className:"w-5 h-5"}),description:"Intelligent creative companion",action:"toggleAI",color:"text-purple-600",gradient:"from-purple-500 to-blue-500"},{id:"video-prompts",label:"Video Prompts",icon:t.jsx(d,{className:"w-5 h-5"}),description:"Generate video content ideas",action:"openVideoPrompts",color:"text-green-600",gradient:"from-green-500 to-emerald-500"},{id:"projects",label:"Project Manager",icon:t.jsx(m,{className:"w-5 h-5"}),description:"Manage your projects",action:"openProjectManager",color:"text-blue-600",gradient:"from-blue-500 to-cyan-500"},{id:"templates",label:"Templates",icon:t.jsx(p,{className:"w-5 h-5"}),description:"Browse project templates",action:"openTemplates",color:"text-orange-600",gradient:"from-orange-500 to-amber-500"},{id:"new-project",label:"New Project",icon:t.jsx(h,{className:"w-5 h-5"}),description:"Start fresh storyboard",action:"newProject",color:"text-green-600",gradient:"from-green-500 to-teal-500"},{id:"themes",label:"Theme Settings",icon:t.jsx(u,{className:"w-5 h-5"}),description:"Customize appearance",action:"openThemeSettings",color:"text-pink-600",gradient:"from-pink-500 to-rose-500"},{id:"settings",label:"Settings",icon:t.jsx(g,{className:"w-5 h-5"}),description:"App preferences",action:"openSettings",color:"text-gray-600",gradient:"from-gray-500 to-slate-500"},{id:"user-guide",label:"User Guide",icon:t.jsx(y,{className:"w-5 h-5"}),description:"Learn how to use the app",action:"openUserGuide",color:"text-indigo-600",gradient:"from-indigo-500 to-purple-500"}];function Ye({isOpen:r,onClose:a,onNavigate:s,currentSection:c}){const[d,m]=e.useState(!1),[p,h]=e.useState(-1),{state:u}=Je(),g=e.useRef(null),y=e.useRef(null);e.useEffect((()=>{if(!r)return;const e=e=>{"Escape"===e.key?x():"ArrowDown"===e.key?(e.preventDefault(),h((e=>(e+1)%Ke.length))):"ArrowUp"===e.key?(e.preventDefault(),h((e=>e<=0?Ke.length-1:e-1))):"Enter"===e.key&&p>=0&&(e.preventDefault(),f(Ke[p].action))},t=e=>{g.current&&!g.current.contains(e.target)&&x()};return document.addEventListener("keydown",e),document.addEventListener("mousedown",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("mousedown",t)}}),[r,p]),e.useEffect((()=>{r&&g.current&&(g.current.focus(),h(-1))}),[r]);const x=()=>{m(!0),setTimeout((()=>{a(),m(!1),h(-1)}),200)},f=e=>{s(e),x()};return r||d?t.jsxs("div",{className:"fixed inset-0 z-50 hidden md:block",children:[t.jsx("div",{ref:y,className:"absolute inset-0 transition-all duration-200 animate-nav-backdrop-fade "+(r&&!d?"bg-black/30 backdrop-blur-sm":"bg-black/0 backdrop-blur-none"),onClick:x}),t.jsxs("div",{ref:g,tabIndex:-1,className:"absolute top-16 left-6 w-80 max-h-[calc(100vh-80px)] rounded-xl shadow-2xl border transform transition-all duration-200 ease-out animate-nav-slide-in "+(r&&!d?"translate-y-0 opacity-100 scale-100":"-translate-y-4 opacity-0 scale-95"),style:{backgroundColor:u.theme.colors.background.primary,borderColor:u.theme.colors.border.primary,boxShadow:`0 20px 40px rgba(0, 0, 0, 0.15), 0 0 0 1px ${u.theme.colors.border.primary}`},children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b rounded-t-xl",style:{background:`linear-gradient(135deg, ${u.theme.colors.primary[600]}, ${u.theme.colors.primary[700]})`,borderColor:u.theme.colors.border.primary},children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:"rgba(255, 255, 255, 0.2)"},children:t.jsx(o,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"font-bold text-lg text-white",children:"Navigation"}),t.jsx("p",{className:"text-white/80 text-sm",children:"Quick access menu"})]})]}),t.jsx("button",{onClick:x,className:"w-10 h-10 rounded-lg flex items-center justify-center transition-colors hover:bg-white/20 text-white",style:{backgroundColor:"rgba(255, 255, 255, 0.1)"},"aria-label":"Close navigation menu",children:t.jsx(n,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"max-h-[calc(100vh-200px)] overflow-y-auto scrollable",children:[t.jsx("div",{className:"p-4 space-y-2",children:Ke.map(((e,r)=>t.jsxs("button",{onClick:()=>f(e.action),onMouseEnter:()=>h(r),onMouseLeave:()=>h(-1),className:`w-full flex items-center space-x-4 p-4 rounded-xl transition-all duration-200 border-2 group animate-menu-item-entrance transform-gpu ${p===r?"transform scale-105 shadow-lg":"hover:transform hover:scale-102 hover:shadow-md"} ${c===e.id?"shadow-lg":"border-transparent"}`,style:{animationDelay:30*r+"ms",backgroundColor:p===r||c===e.id?`${u.theme.colors.primary[100]}`:u.theme.colors.background.secondary,borderColor:p===r||c===e.id?u.theme.colors.primary[300]:"transparent"},"aria-label":`${e.label}: ${e.description}`,children:[t.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center shadow-sm transition-all duration-200",style:{background:p===r||c===e.id?`linear-gradient(135deg, ${u.theme.colors.primary[500]}, ${u.theme.colors.primary[600]})`:u.theme.colors.background.primary,color:p===r||c===e.id?"white":u.theme.colors.text.secondary},children:e.icon}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("h3",{className:"font-semibold text-sm",style:{color:p===r||c===e.id?u.theme.colors.primary[700]:u.theme.colors.text.primary},children:e.label}),t.jsx("p",{className:"text-xs",style:{color:u.theme.colors.text.tertiary},children:e.description})]}),t.jsx(i,{className:"w-4 h-4 transition-all duration-200 "+(p===r?"translate-x-1 opacity-100":"opacity-40"),style:{color:p===r||c===e.id?u.theme.colors.primary[600]:u.theme.colors.text.tertiary}}),c===e.id&&t.jsx("div",{className:"absolute right-2 w-2 h-2 rounded-full animate-pulse",style:{backgroundColor:u.theme.colors.primary[500]}})]},e.id)))}),t.jsx("div",{className:"p-4 mt-4 border-t",style:{borderColor:u.theme.colors.border.primary},children:t.jsxs("div",{className:"rounded-xl p-4 text-center",style:{backgroundColor:`${u.theme.colors.primary[50]}`,border:`1px solid ${u.theme.colors.primary[200]}`},children:[t.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[t.jsx(l,{className:"w-4 h-4",style:{color:u.theme.colors.primary[600]}}),t.jsx("span",{className:"font-medium text-sm",style:{color:u.theme.colors.primary[800]},children:"Pro Tip"})]}),t.jsx("p",{className:"text-xs",style:{color:u.theme.colors.primary[700]},children:"Use keyboard arrows and Enter to navigate, or Escape to close"})]})})]})]})]}):null}function Qe({onToggleAI:r,isAIOpen:a,viewMode:s="grid",onViewModeChange:o,onOpenTemplates:n,onOpenProjectManager:i,onOpenThemeSettings:d,onOpenSettings:p,onOpenUserGuide:C,onOpenExportDialog:A,currentSection:S,onToggleMobileDrawer:P,isMobileDrawerOpen:I}){const{state:T,dispatch:E}=We(),{state:D}=Je(),[$,M]=e.useState(!1),L=()=>{confirm("Create a new project? This will clear your current storyboard.")&&E({type:"SET_PROJECT",payload:{id:"new-project-"+Date.now(),title:"New Storyboard Project",description:"A fresh start for your story",panels:[],createdAt:new Date,updatedAt:new Date}})};return t.jsxs("header",{className:"h-16 border-b flex items-center justify-between px-6 animate-slide-in",style:{backgroundColor:D.theme.colors.background.primary,borderColor:D.theme.colors.border.primary},children:[t.jsxs("div",{className:"flex items-center space-x-6",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("button",{onClick:()=>{window.innerWidth<768?null==P||P():M(!$),navigator.vibrate&&navigator.vibrate(50)},className:"hamburger-menu-button w-10 h-10 rounded-lg flex items-center justify-center transition-all duration-300 hover:scale-110 focus:outline-none focus:ring-2 focus:ring-offset-2 transform-gpu "+($||I?"active bg-primary-500 text-white shadow-lg animate-hamburger-active-glow":"hover:bg-secondary text-secondary-theme hover:shadow-md"),style:{backgroundColor:$||I?D.theme.colors.primary[500]:"transparent",color:$||I?"#ffffff":D.theme.colors.text.secondary},title:"Navigation Menu","aria-label":"Toggle navigation menu","aria-expanded":$||I,children:t.jsx(x,{className:"w-6 h-6 transition-all duration-300 transform-gpu "+($||I?"rotate-90 scale-110":"rotate-0 scale-100")})}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("h1",{className:"text-xl font-bold text-high-contrast hover:text-secondary-theme transition-colors duration-300",children:"Storyboard AI"}),t.jsx(l,{className:"w-5 h-5 animate-pulse",style:{color:D.theme.colors.primary[500]}}),($||I)&&t.jsxs("div",{className:"hidden md:flex items-center space-x-1 px-2 py-1 rounded-md bg-primary-100 text-primary-700 text-xs font-medium animate-fade-in",children:[t.jsx("span",{children:"Menu Open"}),t.jsx("kbd",{className:"px-1 py-0.5 bg-white rounded text-xs",children:"ESC"})]})]})]}),o&&t.jsxs("div",{className:"hidden md:flex items-center bg-secondary rounded-lg p-1",children:[t.jsxs("button",{onClick:()=>o("grid"),className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-300 "+("grid"===s?"bg-primary text-primary shadow-md":"text-secondary hover:text-primary"),children:[t.jsx(f,{className:"w-5 h-5"}),t.jsx("span",{className:"hidden lg:inline",children:"Grid"})]}),t.jsxs("button",{onClick:()=>o("timeline"),className:"flex items-center space-x-2 px-3 py-2 rounded-md text-sm font-medium transition-all duration-300 "+("timeline"===s?"bg-primary text-primary shadow-md":"text-secondary hover:text-primary"),children:[t.jsx(b,{className:"w-5 h-5"}),t.jsx("span",{className:"hidden lg:inline",children:"Timeline"})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("div",{className:"hidden sm:flex items-center space-x-1 bg-secondary rounded-lg p-1",children:[t.jsx("button",{id:"quick-save-btn",onClick:async()=>{if(!T.currentProject)return void alert("No project to save");const e=document.getElementById("quick-save-btn");e&&e.classList.add("animate-pulse");try{const t={...T.currentProject,panels:T.panels,updatedAt:new Date};if(E({type:"SET_PROJECT",payload:t}),e){e.classList.remove("animate-pulse"),e.classList.add("animate-wiggle");const t=e.innerHTML;e.innerHTML='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>',setTimeout((()=>{e.innerHTML=t,e.classList.remove("animate-wiggle")}),2e3)}console.log("âœ… Quick save successful:",t.title)}catch(t){console.error("âŒ Quick save failed:",t),e&&(e.classList.remove("animate-pulse"),e.classList.add("animate-bounce"),setTimeout((()=>{e.classList.remove("animate-bounce")}),1e3)),alert("Failed to save project. Please try again.")}},className:"btn-secondary p-2 hover:bg-green-100 hover:text-green-700 transition-all duration-300",title:"Quick save",children:t.jsx(v,{className:"w-5 h-5"})}),t.jsx("button",{id:"quick-import-btn",onClick:()=>{const e=document.createElement("input");e.type="file",e.accept=".json",e.onchange=async e=>{var t;const r=null==(t=e.target.files)?void 0:t[0];if(!r)return;const a=document.getElementById("quick-import-btn");try{a&&a.classList.add("animate-pulse");const e=new FileReader;e.onload=async e=>{var t;try{const r=null==(t=e.target)?void 0:t.result,s=JSON.parse(r);let o=null;if(s.project)o=s.project;else{if(!(s.id&&s.title&&s.panels))throw new Error("Invalid project file format");o=s}if(!o.id||!o.title||!Array.isArray(o.panels))throw new Error("Project file is missing required fields (id, title, panels)");if(o.createdAt=o.createdAt?new Date(o.createdAt):new Date,o.updatedAt=o.updatedAt?new Date(o.updatedAt):new Date,o.panels=o.panels.map(((e,t)=>({id:e.id||`imported-panel-${Date.now()}-${t}`,title:e.title||`Imported Panel ${t+1}`,description:e.description||"",imageUrl:e.imageUrl,videoUrl:e.videoUrl,videoPrompt:e.videoPrompt||e.aiGeneratedPrompt,aiGeneratedPrompt:e.aiGeneratedPrompt||e.videoPrompt,shotType:e.shotType||"medium-shot",cameraAngle:e.cameraAngle||"eye-level",notes:e.notes||"",duration:"number"==typeof e.duration?e.duration:3,order:t,createdAt:e.createdAt?new Date(e.createdAt):new Date,updatedAt:e.updatedAt?new Date(e.updatedAt):new Date}))),E({type:"SET_PROJECT",payload:o}),a){a.classList.remove("animate-pulse"),a.classList.add("animate-glow");const e=a.innerHTML;a.innerHTML='<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>',setTimeout((()=>{a.innerHTML=e,a.classList.remove("animate-glow")}),2e3)}console.log("âœ… Project imported successfully:",o.title)}catch(r){console.error("âŒ Import failed:",r),a&&(a.classList.remove("animate-pulse"),a.classList.add("animate-bounce"),setTimeout((()=>{a.classList.remove("animate-bounce")}),1e3)),alert(`Error importing project: ${r instanceof Error?r.message:"Invalid file format"}`)}},e.onerror=()=>{a&&a.classList.remove("animate-pulse"),alert("Error reading file. Please try again.")},e.readAsText(r)}catch(s){console.error("âŒ Import setup failed:",s),a&&a.classList.remove("animate-pulse"),alert("Error setting up import. Please try again.")}},e.click()},className:"btn-secondary p-2 hover:bg-purple-100 hover:text-purple-700 transition-all duration-300",title:"Import project",children:t.jsx(w,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"hidden md:flex items-center space-x-1 bg-secondary rounded-lg p-1",children:[t.jsx("button",{onClick:i,className:"btn-secondary p-2 hover:bg-blue-100 hover:text-blue-700 transition-all duration-300",title:"Project Manager",children:t.jsx(m,{className:"w-5 h-5"})}),t.jsx("button",{onClick:n,className:"btn-secondary p-2 hover:bg-purple-100 hover:text-purple-700 transition-all duration-300",title:"Templates",children:t.jsx(j,{className:"w-5 h-5"})}),t.jsx("button",{onClick:L,className:"btn-secondary p-2 hover:bg-green-100 hover:text-green-700 transition-all duration-300",title:"New Project",children:t.jsx(h,{className:"w-5 h-5"})}),t.jsx("button",{onClick:C,className:"btn-secondary p-2 hover:bg-indigo-100 hover:text-indigo-700 transition-all duration-300",title:"User Guide",children:t.jsx(y,{className:"w-5 h-5"})}),t.jsx("button",{onClick:d,className:"btn-secondary p-2 hover:bg-pink-100 hover:text-pink-700 transition-all duration-300",title:"Theme Settings",children:t.jsx(u,{className:"w-5 h-5"})}),t.jsx("button",{onClick:A,className:"btn-secondary p-2 hover:bg-blue-100 hover:text-blue-700 transition-all duration-300",title:"Advanced Export",children:t.jsx(N,{className:"w-5 h-5"})}),t.jsx("button",{onClick:p,className:"btn-secondary p-2 hover:bg-gray-100 hover:text-gray-700 transition-all duration-300",title:"Settings",children:t.jsx(g,{className:"w-5 h-5"})})]}),t.jsxs("button",{onClick:r,className:"relative flex items-center space-x-2 px-3 sm:px-4 py-2 rounded-lg font-medium transition-all duration-300 "+(a?"bg-gradient-to-r from-purple-600 to-blue-600 text-white shadow-lg":"bg-secondary text-secondary hover:bg-tertiary hover:text-primary"),children:[t.jsx(k,{className:"w-5 h-5"}),t.jsx(c,{className:"w-5 h-5"}),t.jsx("span",{className:"hidden sm:inline",children:"AI Assistant"}),t.jsx("span",{className:"sm:hidden",children:"AI"}),a&&t.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 bg-green-400 rounded-full animate-ping"})]})]}),t.jsx(Ye,{isOpen:$,onClose:()=>M(!1),onNavigate:e=>{switch(e){case"openTemplates":null==n||n();break;case"openProjectManager":null==i||i();break;case"openThemeSettings":null==d||d();break;case"openSettings":null==p||p();break;case"openUserGuide":null==C||C();break;case"toggleAI":r();break;case"newProject":L();break;default:console.log("Unknown navigation action:",e)}},currentSection:S})]})}function Xe({onNewProject:r,onOpenTemplates:a,onToggleAI:s,onGenerateVideoPrompts:o,onOpenProjectManager:n,onOpenSettings:i}){const{state:c,dispatch:p}=We(),{state:u}=Je(),[y,x]=e.useState("current"),[f,b]=e.useState([]),[w,N]=e.useState(!1),[E,D]=e.useState(""),[$,M]=e.useState({}),[L,O]=e.useState(null);e.useEffect((()=>{(async()=>{try{const e=await Oe.getAllProjects();b(e)}catch(e){console.error("Error loading projects:",e),b([])}})()}),[]),e.useEffect((()=>{(async()=>{try{const e=await Oe.getAllProjects();b(e)}catch(e){console.error("Error refreshing projects:",e)}})()}),[c.currentProject]),e.useEffect((()=>{c.currentProject&&(D(c.currentProject.directorNotes||""),M(c.currentProject.videoStyle||{}))}),[c.currentProject]);const F=e=>{x(y===e?"":e)},z=f.sort(((e,t)=>{try{const r=e.lastOpened?new Date(e.lastOpened):new Date(e.updatedAt);return(t.lastOpened?new Date(t.lastOpened):new Date(t.updatedAt)).getTime()-r.getTime()}catch(r){return console.error("Error sorting projects:",r),0}})).slice(0,5);return f.filter((e=>e.isFavorite)),t.jsxs("aside",{className:"w-80 border-r flex flex-col h-full max-h-screen overflow-hidden",style:{backgroundColor:u.theme.colors.background.primary,borderColor:u.theme.colors.border.primary},children:[t.jsxs("div",{className:"p-6 border-b",style:{backgroundColor:u.theme.colors.background.secondary,borderColor:u.theme.colors.border.primary},children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center shadow-lg",style:{background:`linear-gradient(135deg, ${u.theme.colors.primary[600]}, ${u.theme.colors.primary[500]})`},children:t.jsx(j,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-lg font-bold text-primary-theme",children:"Project Hub"}),t.jsx("p",{className:"text-sm text-secondary-theme",children:"Manage your stories"})]})]}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsxs("button",{onClick:n,className:"flex-1 flex items-center justify-center space-x-2 btn-primary text-sm py-2",children:[t.jsx(m,{className:"w-5 h-5"}),t.jsx("span",{children:"Projects"})]}),t.jsxs("button",{onClick:r,className:"flex-1 flex items-center justify-center space-x-2 btn-secondary text-sm py-2",children:[t.jsx(h,{className:"w-5 h-5"}),t.jsx("span",{children:"New"})]})]})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto scrollable min-h-0",children:[c.currentProject&&t.jsxs("div",{className:"p-4 border-b animate-fade-in",style:{borderColor:u.theme.colors.border.primary},children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h3",{className:"font-semibold text-primary-theme",children:"Current Project"}),t.jsxs("div",{className:"status-indicator status-online animate-pulse-soft",children:[t.jsx(l,{className:"w-3 h-3"}),t.jsx("span",{children:"Active"})]})]}),t.jsxs("div",{className:"glass-subtle rounded-lg p-4 mb-4 animate-slide-in-bottom",style:{background:`linear-gradient(135deg, ${u.theme.colors.background.secondary}, ${u.theme.colors.background.tertiary})`},children:[t.jsx("h4",{className:"font-medium text-high-contrast mb-2",children:c.currentProject.title}),t.jsx("p",{className:"text-sm text-secondary-theme mb-3",children:c.currentProject.description}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:"bg-primary/50 rounded-lg p-3 text-center",children:[t.jsx("div",{className:"text-lg font-bold text-primary",children:c.panels.length}),t.jsx("div",{className:"text-xs text-secondary",children:"Total Panels"})]}),t.jsxs("div",{className:"bg-primary/50 rounded-lg p-3 text-center",children:[t.jsx("div",{className:"text-lg font-bold text-primary",children:c.panels.filter((e=>e.imageUrl)).length}),t.jsx("div",{className:"text-xs text-secondary",children:"With Images"})]}),t.jsxs("div",{className:"bg-primary/50 rounded-lg p-3 text-center",children:[t.jsx("div",{className:"text-lg font-bold text-primary",children:Math.round(c.panels.reduce(((e,t)=>{var r;return e+((null==(r=t.description)?void 0:r.split(" ").length)||0)}),0))}),t.jsx("div",{className:"text-xs text-secondary",children:"Word Count"})]}),t.jsxs("div",{className:"bg-primary/50 rounded-lg p-3 text-center",children:[t.jsxs("div",{className:"text-lg font-bold text-primary",children:[Math.round(c.panels.reduce(((e,t)=>e+(t.duration||0)),0)),"s"]}),t.jsx("div",{className:"text-xs text-secondary",children:"Duration"})]})]}),t.jsxs("div",{className:"mt-3 pt-3 border-t border-primary/20",children:[t.jsxs("div",{className:"flex items-center justify-between text-xs text-secondary-theme mb-1",children:[t.jsx("span",{children:"Project Completion"}),t.jsxs("span",{children:[Math.round(c.panels.filter((e=>e.imageUrl)).length/Math.max(c.panels.length,1)*100),"%"]})]}),t.jsx("div",{className:"w-full bg-tertiary/50 rounded-full h-2 overflow-hidden",children:t.jsx("div",{className:"h-full transition-all duration-1000 ease-out animate-shimmer",style:{width:c.panels.filter((e=>e.imageUrl)).length/Math.max(c.panels.length,1)*100+"%",background:`linear-gradient(90deg, ${u.theme.colors.primary[500]}, ${u.theme.colors.primary[400]})`}})})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("button",{onClick:()=>N(!w),className:"w-full flex items-center justify-between text-sm font-medium text-primary-theme hover:text-secondary-theme transition-all duration-300 p-2 rounded-lg hover:bg-tertiary/50",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full animate-pulse"}),t.jsx("span",{children:"Director's Notes"})]}),w?t.jsx(C,{className:"w-5 h-5 transition-transform duration-300"}):t.jsx(A,{className:"w-5 h-5 transition-transform duration-300"})]}),w&&t.jsxs("div",{className:"space-y-4 animate-slide-in-bottom",children:[t.jsxs("div",{className:"space-y-3",children:[t.jsx("label",{className:"text-xs font-medium text-secondary-theme uppercase tracking-wide",children:"Story Notes"}),t.jsx("textarea",{value:E,onChange:e=>D(e.target.value),placeholder:"Add your director's notes, character details, or story guidelines...",className:"textarea-modern w-full h-24 text-sm",style:{backgroundColor:u.theme.colors.background.primary,borderColor:u.theme.colors.border.primary,color:u.theme.colors.text.primary}})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsx("label",{className:"text-xs font-medium text-secondary-theme uppercase tracking-wide",children:"Video Style"}),t.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[t.jsx("input",{type:"text",value:$.lightingMood||"",onChange:e=>M((t=>({...t,lightingMood:e.target.value}))),placeholder:"Lighting Mood (e.g., cinematic, natural, dramatic)",className:"input-modern text-sm",style:{backgroundColor:u.theme.colors.background.primary,borderColor:u.theme.colors.border.primary,color:u.theme.colors.text.primary}}),t.jsx("input",{type:"text",value:$.pacing||"",onChange:e=>M((t=>({...t,pacing:e.target.value}))),placeholder:"Pacing (e.g., fast, slow, dynamic)",className:"input-modern text-sm",style:{backgroundColor:u.theme.colors.background.primary,borderColor:u.theme.colors.border.primary,color:u.theme.colors.text.primary}})]})]}),t.jsxs("button",{onClick:()=>{if(!c.currentProject)return;const e={...c.currentProject,panels:c.panels,directorNotes:E,videoStyle:$,updatedAt:new Date};p({type:"SET_PROJECT",payload:e}),Oe.getAllProjects().then(b).catch(console.error);const t=document.querySelector("[data-save-notes]");if(t){const e=t.textContent;t.textContent="âœ… Saved!",t.classList.add("animate-pulse"),t.disabled=!0,setTimeout((()=>{t.textContent=e,t.classList.remove("animate-pulse"),t.disabled=!1}),2e3)}},"data-save-notes":!0,className:"btn-primary w-full text-sm py-3 flex items-center justify-center space-x-2 animate-bounce-in",children:[t.jsx(v,{className:"w-4 h-4"}),t.jsx("span",{children:"Save Notes & Style"})]})]})]})]}),z.length>0&&t.jsxs("div",{className:"p-4 border-b animate-fade-in animate-delay-200",style:{borderColor:u.theme.colors.border.primary},children:[t.jsxs("button",{onClick:()=>F("recent"),className:"w-full flex items-center justify-between mb-4 text-primary-theme hover:text-secondary-theme transition-all duration-300 p-2 rounded-lg hover:bg-tertiary/50",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center shadow-md",style:{background:`linear-gradient(135deg, ${u.theme.colors.primary[400]}, ${u.theme.colors.primary[600]})`},children:t.jsx(S,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{children:[t.jsx("span",{className:"font-semibold text-sm",children:"Recent Projects"}),t.jsxs("p",{className:"text-xs text-secondary-theme",children:[z.length," available"]})]})]}),"recent"===y?t.jsx(C,{className:"w-5 h-5 transition-transform duration-300"}):t.jsx(A,{className:"w-5 h-5 transition-transform duration-300"})]}),"recent"===y&&t.jsx("div",{className:"space-y-3 animate-slide-in-bottom",children:z.map(((e,r)=>{var a,s,o;return t.jsx("div",{className:"group card-interactive p-3 cursor-pointer animate-fade-in animate-delay-"+100*(r+1),onMouseEnter:()=>O(e.id),onMouseLeave:()=>O(null),onClick:()=>(e=>{const t={...e,lastOpened:new Date};p({type:"SET_PROJECT",payload:t}),Oe.getAllProjects().then(b).catch(console.error)})(e),style:{backgroundColor:L===e.id?u.theme.colors.background.tertiary:u.theme.colors.background.secondary,borderColor:u.theme.colors.border.primary},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[t.jsx("h4",{className:"font-medium text-primary-theme text-sm",children:e.title}),L===e.id&&t.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-heartbeat"})]}),t.jsxs("div",{className:"flex items-center space-x-4 text-xs text-secondary-theme",children:[t.jsxs("span",{className:"flex items-center space-x-1",children:[t.jsx("span",{children:(null==(a=e.panels)?void 0:a.length)||0}),t.jsx("span",{children:"panels"})]}),t.jsxs("span",{className:"flex items-center space-x-1",children:[t.jsx("span",{children:(null==(o=null==(s=e.panels)?void 0:s.filter((e=>e.imageUrl)))?void 0:o.length)||0}),t.jsx("span",{children:"images"})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"text-xs text-tertiary-theme",children:new Date(e.lastOpened||e.updatedAt).toLocaleDateString()}),t.jsx("button",{onClick:t=>{t.stopPropagation(),(async e=>{var t;if(confirm("Are you sure you want to delete this project? This action cannot be undone."))try{await Oe.deleteProject(e);const r=await Oe.getAllProjects();if(b(r),(null==(t=c.currentProject)?void 0:t.id)===e){const e={id:"empty-"+Date.now(),title:"New Project",description:"Start creating your story",panels:[],createdAt:new Date,updatedAt:new Date};p({type:"SET_PROJECT",payload:e})}}catch(r){console.error("Error deleting project:",r),alert("Failed to delete project. Please try again.")}})(e.id)},className:"opacity-0 group-hover:opacity-100 transition-all duration-300 p-1.5 hover:bg-red-100 rounded-lg transform hover:scale-110",children:t.jsx(P,{className:"w-3.5 h-3.5 text-red-500"})})]})]})},e.id)}))})]}),t.jsxs("div",{className:"p-4 animate-fade-in animate-delay-300",children:[t.jsxs("button",{onClick:()=>F("tools"),className:"w-full flex items-center justify-between mb-4 text-primary-theme hover:text-secondary-theme transition-all duration-300 p-2 rounded-lg hover:bg-tertiary/50",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center shadow-md",style:{background:`linear-gradient(135deg, ${u.theme.colors.primary[500]}, ${u.theme.colors.primary[700]})`},children:t.jsx(I,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{children:[t.jsx("span",{className:"font-semibold text-sm",children:"Creative Tools"}),t.jsx("p",{className:"text-xs text-secondary-theme",children:"AI powered features"})]})]}),"tools"===y?t.jsx(C,{className:"w-5 h-5 transition-transform duration-300"}):t.jsx(A,{className:"w-5 h-5 transition-transform duration-300"})]}),"tools"===y&&t.jsxs("div",{className:"space-y-3 animate-slide-in-bottom",children:[t.jsxs("button",{onClick:s,className:"w-full flex items-center space-x-3 card-interactive p-3 text-sm hover:scale-105 animate-fade-in animate-delay-100",style:{background:`linear-gradient(135deg, ${u.theme.colors.background.secondary}, ${u.theme.colors.background.tertiary})`,borderColor:u.theme.colors.border.primary},children:[t.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-purple-500 to-blue-600 flex items-center justify-center shadow-md",children:t.jsx(k,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("div",{className:"font-medium text-primary-theme",children:"AI Assistant"}),t.jsx("div",{className:"text-xs text-secondary-theme",children:"Generate content & ideas"})]})]}),t.jsxs("button",{onClick:o,className:"w-full flex items-center space-x-3 card-interactive p-3 text-sm hover:scale-105 animate-fade-in animate-delay-200",style:{background:`linear-gradient(135deg, ${u.theme.colors.background.secondary}, ${u.theme.colors.background.tertiary})`,borderColor:u.theme.colors.border.primary},children:[t.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-green-500 to-teal-600 flex items-center justify-center shadow-md",children:t.jsx(d,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("div",{className:"font-medium text-primary-theme",children:"Video Prompts"}),t.jsx("div",{className:"text-xs text-secondary-theme",children:"Generate video descriptions"})]})]}),t.jsxs("button",{onClick:a,className:"w-full flex items-center space-x-3 card-interactive p-3 text-sm hover:scale-105 animate-fade-in animate-delay-300",style:{background:`linear-gradient(135deg, ${u.theme.colors.background.secondary}, ${u.theme.colors.background.tertiary})`,borderColor:u.theme.colors.border.primary},children:[t.jsx("div",{className:"w-8 h-8 rounded-lg bg-gradient-to-br from-orange-500 to-pink-600 flex items-center justify-center shadow-md",children:t.jsx(T,{className:"w-4 h-4 text-white"})}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("div",{className:"font-medium text-primary-theme",children:"Templates"}),t.jsx("div",{className:"text-xs text-secondary-theme",children:"Pre-built storyboards"})]})]}),t.jsxs("button",{onClick:i,className:"w-full flex items-center space-x-3 btn-secondary text-sm py-3 hover:bg-gradient-to-r hover:from-indigo-100 hover:to-purple-100",children:[t.jsx(g,{className:"w-5 h-5"}),t.jsx("span",{children:"Settings"})]})]})]})]})]})}var Ze=Object.defineProperty,et=(e,t,r)=>((e,t,r)=>t in e?Ze(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);const tt=new class{constructor(){et(this,"openai",null),et(this,"isInitialized",!1),this.initializeOpenAI()}initializeOpenAI(){try{const e=Oe.getSettings();e.openaiApiKey?(this.openai=new Ae({apiKey:e.openaiApiKey,dangerouslyAllowBrowser:!0,timeout:6e4,maxRetries:2}),this.isInitialized=!0,console.log("âœ… OpenAI service initialized successfully")):console.warn("âš ï¸ No OpenAI API key found in settings")}catch(e){console.error("âŒ Failed to initialize OpenAI:",e),this.openai=null,this.isInitialized=!1}}setApiKey(e){Oe.saveSettings({openaiApiKey:e}),this.initializeOpenAI()}getApiKey(){return Oe.getSettings().openaiApiKey}isReady(){return this.isInitialized&&null!==this.openai}createSystemPrompt(e){return`${e.agentPersonality||"You're a friendly, experienced film director and storyboard artist who can actually help create and modify storyboards. You talk like a real person and can take action when users ask for help."}\n\nCurrent project: "${e.projectTitle}" - ${e.projectDescription}\n${e.directorNotes?`Director's vision: "${e.directorNotes}"`:"No director notes yet"}\n\nWhat you're working with:\n${e.allPanels.length>0?`${e.allPanels.length} panels so far:\n`+e.allPanels.slice(0,3).map((e=>`â€¢ Panel ${e.number}: ${e.title} - ${e.description}`)).join("\n")+(e.allPanels.length>3?`\nâ€¢ ...and ${e.allPanels.length-3} more`:""):"No panels yet - blank canvas!"}\n\nCRITICAL: When users ask you to DO something (create, add, edit, generate, modify, change, update, remove, delete, analyze), you MUST include action commands. ALWAYS respond with both conversation AND action!\n\nðŸš¨ BATCH OPERATIONS PRIORITY: When users say words like "ALL", "EVERY", "EVERYTHING", "ENTIRE", "WHOLE", or want to modify multiple panels, USE BATCH ACTIONS!\n\nAction format: [ACTION:action_type:parameters]\n\nðŸ“‹ SINGLE PANEL ACTIONS:\nâ€¢ [ACTION:generate_storyboard:story description] - When users want to create/generate/make storyboards\nâ€¢ [ACTION:add_panel:scene description] - When users want to add/create new scenes/panels  \nâ€¢ [ACTION:edit_panel:instructions] - When users want to edit/modify/change ONE specific panel\nâ€¢ [ACTION:remove_panel:panel_number] - When users want to remove/delete panels\nâ€¢ [ACTION:analyze_storyboard] - When users want analysis/feedback on current storyboard\nâ€¢ [ACTION:generate_video_prompts] - When users want video prompts created\nâ€¢ [ACTION:update_director_notes:new notes text] - When users want to update project vision\n\nðŸŽ¬ BATCH/MULTIPLE PANEL ACTIONS (USE THESE FOR "ALL", "EVERY", "WHOLE" REQUESTS):\nâ€¢ [ACTION:batch_edit:instructions] - Edit ALL panels with same instructions\nâ€¢ [ACTION:batch_edit_range:start:end:instructions] - Edit specific range (e.g., panels 2-5)\nâ€¢ [ACTION:batch_apply_style:style_type:style_instructions] - Apply consistent style to ALL panels\nâ€¢ [ACTION:enhance_all_cinematography:instructions] - Enhance cinematography across ALL panels\nâ€¢ [ACTION:standardize_shot_types:instructions] - Standardize shot progression across ALL panels\n\nBATCH DETECTION KEYWORDS - When you see these, USE BATCH ACTIONS:\nâ€¢ "all panels", "every panel", "entire storyboard", "whole project" â†’ [ACTION:batch_edit:instructions]\nâ€¢ "all of them", "everything", "the whole thing" â†’ [ACTION:batch_edit:instructions]\nâ€¢ "make them all more..." â†’ [ACTION:batch_edit:make all panels more...]\nâ€¢ "apply X style to everything" â†’ [ACTION:batch_apply_style:X:style instructions]\nâ€¢ "enhance all", "improve all", "update all" â†’ [ACTION:batch_edit:instructions]\nâ€¢ "panels 1-3", "first few panels", "panels 2 to 5" â†’ [ACTION:batch_edit_range:start:end:instructions]\nâ€¢ "better cinematography for all" â†’ [ACTION:enhance_all_cinematography:instructions]\nâ€¢ "fix the shot types" â†’ [ACTION:standardize_shot_types:instructions]\n\nEXAMPLES OF PROPER BATCH RESPONSES:\nUser: "Make all panels more dramatic"\nResponse: "Absolutely! I'll make every panel in your storyboard more dramatic with intense lighting and dynamic compositions. [ACTION:batch_edit:make all panels more dramatic with intense lighting, dynamic camera angles, and heightened emotional tension]"\n\nUser: "Apply horror movie style to everything"\nResponse: "Perfect! I'll transform your entire storyboard into horror movie style with dark atmosphere and suspenseful elements. [ACTION:batch_apply_style:horror:dark shadows, eerie lighting, suspenseful atmosphere, horror movie cinematography]"\n\nUser: "Make panels 2-4 more action-packed"\nResponse: "Great idea! I'll amp up the action in panels 2 through 4 with dynamic movement and energy. [ACTION:batch_edit_range:2:4:make these panels more action-packed with dynamic movement, fast-paced action, and energetic cinematography]"\n\nUser: "Enhance the cinematography for the whole storyboard"\nResponse: "Excellent! I'll enhance the cinematography across all your panels with professional techniques and visual variety. [ACTION:enhance_all_cinematography:apply professional cinematography techniques with varied shot types and dynamic camera work]"\n\nðŸŽ¯ SINGLE PANEL EXAMPLES:\nUser: "Edit panel 3 to be more dramatic"\nResponse: "I'll make panel 3 much more dramatic for you! [ACTION:edit_panel:make panel 3 more dramatic with intense lighting and dynamic camera angle]"\n\nUser: "Add a chase scene"\nResponse: "Great idea! I'll add an exciting chase scene to your storyboard. [ACTION:add_panel:thrilling car chase through busy city streets with close-up shots of determined faces]"\n\nREMEMBER: \n- Be conversational AND include actions\n- ALWAYS use batch actions for "all/every/whole" requests\n- The action executes while your message displays\n- Don't be afraid to use batch operations - they're powerful!`}async sendMessage(e,t){var r,a;if(!this.isReady())return this.generateFallbackResponse((null==(r=e[e.length-1])?void 0:r.content)||"");try{return(await this.openai.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:this.createSystemPrompt(t)},...e],max_tokens:500,temperature:.7})).choices[0].message.content||"Sorry, I couldn't generate a response."}catch(s){return console.error("OpenAI API Error:",s),401===s.status?"It looks like your OpenAI API key is invalid. Please check your API key in the settings.":429===s.status?"You've reached the rate limit for the OpenAI API. Please try again in a moment.":402===s.status?"Your OpenAI account has insufficient credits. Please add credits to your OpenAI account.":this.generateFallbackResponse((null==(a=e[e.length-1])?void 0:a.content)||"")}}async generateStoryboard(e,t=6,r="drama"){if(!this.isReady())return this.generateFallbackStoryboard(e,t);try{const s=`Create a professional ${t}-panel storyboard for this story idea:\n\n**Story**: ${e}\n**Genre**: ${r}\n**Panels**: ${t}\n\nRequirements for each panel:\n\n1. **TITLE**: Create compelling, specific titles that describe the key action/moment (NOT just "Panel X - Brief Title")\n   - Good: "Hero Discovers Ancient Artifact", "Villain Reveals True Identity", "Final Confrontation Begins"\n   - Bad: "Panel 1 - Scene", "Panel 2 - Action"\n\n2. **DESCRIPTION**: Write detailed 2-3 sentence scene descriptions including:\n   - Character actions and emotions\n   - Setting details and atmosphere\n   - Key story beats or dialogue hints\n\n3. **SHOT TYPES**: Choose from: close-up, medium-shot, wide-shot, extreme-close-up, over-the-shoulder, establishing-shot, two-shot\n   - Vary shots for visual interest\n   - Match shot choice to dramatic intent\n\n4. **CAMERA ANGLES**: Choose from: eye-level, high-angle, low-angle, birds-eye-view, worms-eye-view, dutch-angle\n   - Use angles to enhance mood and power dynamics\n\n5. **DIRECTOR'S NOTES**: Include specific guidance on:\n   - Lighting mood (dramatic, soft, harsh, etc.)\n   - Character performance/emotion\n   - Visual composition elements\n   - Sound/music suggestions\n\n6. **DURATION**: 3-8 seconds based on content complexity\n\n7. **VIDEO PROMPT**: Comprehensive AI video generation prompt optimized for tools like RunwayML, Pika Labs, and Stable Video Diffusion:\n   - Camera movement: static hold, slow push-in, pan left/right, tilt up/down, dolly forward/back, orbit, handheld\n   - Technical specs: 4K resolution, 24fps cinematic, professional color grading\n   - Lighting: natural daylight, golden hour, dramatic shadows, soft diffused, neon/artificial, candlelight\n   - Visual style: photorealistic, cinematic film quality, shallow depth of field, film grain texture\n   - Duration and pacing: smooth motion, appropriate timing for scene content\n   - Environmental details: weather, atmosphere, time of day, location specifics\n\n**Story Structure Guidelines**:\n- Panel 1: Hook/establishing shot\n- Panels 2-4: Rising action/character development  \n- Panel 5: Climax or turning point\n- Panel 6: Resolution or cliffhanger (if applicable)\n\n**JSON Format**:\n[\n  {\n    "title": "Compelling descriptive title here",\n    "description": "Detailed scene description with character actions, setting, and atmosphere. Include emotional beats and visual details that bring the scene to life.",\n    "shotType": "establishing-shot",\n    "cameraAngle": "high-angle", \n    "notes": "Specific director guidance on lighting, performance, composition, and technical execution",\n    "duration": 5,\n    "videoPrompt": "Professional video generation prompt: establishing shot from high angle, 4K cinematic quality, [camera movement], [lighting description], [character actions], [environmental atmosphere], 24fps smooth motion, photorealistic rendering, shallow depth of field, professional color grading"\n  }\n]\n\nCreate a complete narrative arc with visual variety and professional filmmaking techniques. Return ONLY the JSON array without any markdown formatting or code blocks.`,o=(await this.openai.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:"You are an expert storyboard artist and cinematographer with 20+ years experience in film production. Create professional, detailed storyboard content with compelling titles and complete scene descriptions. Always return valid JSON only without any markdown formatting or code blocks."},{role:"user",content:s}],max_tokens:2500,temperature:.7})).choices[0].message.content||"";try{let e=o.trim();e.startsWith("```json")?e=e.replace(/```json\s*/,"").replace(/\s*```\s*$/,""):e.startsWith("```")&&(e=e.replace(/```\s*/,"").replace(/\s*```\s*$/,""));return JSON.parse(e).map(((e,t)=>({id:`panel-${Date.now()}-${t}`,title:e.title||`Panel ${t+1}`,description:e.description||"AI-generated scene",shotType:e.shotType||"medium-shot",cameraAngle:e.cameraAngle||"eye-level",notes:e.notes||"",duration:e.duration||4,order:t,createdAt:new Date,updatedAt:new Date,videoPrompt:e.videoPrompt})))}catch(a){return console.error("Failed to parse AI response:",a),this.generateFallbackStoryboard(e,t)}}catch(s){return console.error("Failed to generate storyboard:",s),this.generateFallbackStoryboard(e,t)}}async generateScene(e,t="medium-shot",r="eye-level",a="neutral"){if(!this.isReady())return this.generateFallbackScene(e,t,r,a);try{const o=`Create a professional storyboard panel for this scene:\n\n**Scene Description**: ${e}\n**Shot Type**: ${t}\n**Camera Angle**: ${r}  \n**Mood**: ${a}\n\nGenerate a comprehensive panel with:\n\n1. **TITLE**: Create a compelling, specific title that captures the key moment or action (not generic)\n   - Focus on the main dramatic beat or visual element\n   - Make it engaging and descriptive\n\n2. **DESCRIPTION**: Enhanced scene description (2-3 sentences) including:\n   - Character actions and emotions\n   - Environmental details and atmosphere\n   - Visual composition elements\n   - Lighting and color mood\n\n3. **DIRECTOR'S NOTES**: Professional guidance covering:\n   - Specific lighting setup and mood\n   - Character performance direction\n   - Camera movement (if any)\n   - Visual composition principles\n   - Sound/music considerations\n\n4. **VIDEO PROMPT**: Detailed AI video generation prompt optimized for RunwayML, Pika Labs, Stable Video Diffusion:\n   - Camera work: specific movement (static/pan/tilt/dolly/orbit), framing, angle\n   - Technical specs: 4K resolution, 24fps cinematic, professional color grading, film grain\n   - Lighting design: type (natural/artificial), direction, intensity, mood, shadows\n   - Motion and pacing: smooth transitions, appropriate duration, character blocking\n   - Visual style: photorealistic rendering, depth of field, atmospheric effects\n   - Environmental context: weather, time of day, location atmosphere, background details\n\nReturn as valid JSON only with keys: title, description, notes, videoPrompt. Do not include any markdown formatting or code blocks.`,n=(await this.openai.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"system",content:"You are an expert storyboard artist and cinematographer with extensive film production experience. Create detailed, professional panel content with compelling titles and actionable direction. Return only valid JSON without any markdown formatting or code blocks."},{role:"user",content:o}],max_tokens:800,temperature:.7})).choices[0].message.content||"";try{let a=n.trim();a.startsWith("```json")?a=a.replace(/```json\s*/,"").replace(/\s*```\s*$/,""):a.startsWith("```")&&(a=a.replace(/```\s*/,"").replace(/\s*```\s*$/,""));const s=JSON.parse(a);return{title:s.title||`Enhanced ${t} Scene`,description:s.description||e,notes:s.notes||"AI-generated scene content",shotType:t,cameraAngle:r,videoPrompt:s.videoPrompt||`Professional video: ${t} ${r} of ${e}, 4K cinematic quality, 24fps smooth motion, professional lighting, photorealistic rendering, shallow depth of field, film grain texture`}}catch(s){console.error("Failed to parse AI scene response:",s),console.log("Raw content:",n);let a=e;const o=n.match(/"description":\s*"([^"]+)"/i);if(o)a=o[1];else{const e=n.split(/[.!?]+/).filter((e=>e.trim().length>10));e.length>0&&(a=e[0].trim()+".")}return{title:`${t} ${r} Scene`,description:a,notes:"AI-generated scene content",shotType:t,cameraAngle:r,videoPrompt:`Professional video: ${t} ${r} of ${e}, 4K cinematic quality, 24fps smooth motion, professional lighting, photorealistic rendering, shallow depth of field, film grain texture`}}}catch(o){return console.error("Scene generation error:",o),this.generateFallbackScene(e,t,r,a)}}async generateImage(e,t={},r="dall-e-3"){var a,s,o,n;if(!this.isReady())throw console.error("ðŸš« OpenAI service not ready"),new Error("OpenAI service is not ready. Please check your API key.");try{const{style:i="cinematic",quality:l="standard",size:c="1024x1024"}=t;console.log("ðŸŽ¨ Generating image with options:",{style:i,quality:l,size:c,model:r}),console.log("ðŸ“ Original prompt:",e);let d=e;switch(i){case"cinematic":d=`${e}, cinematic lighting, professional cinematography, film quality, dramatic composition, high production value, 4K resolution`;break;case"realistic":d=`${e}, photorealistic, high detail, natural lighting, professional photography, sharp focus`;break;case"artistic":d=`${e}, artistic interpretation, creative composition, stylized, beautiful artwork, vibrant colors`;break;case"storyboard":d=`${e}, storyboard panel style, clean line art, professional storyboard illustration, clear composition for film production, black and white sketch`}d.length>1e3&&(d=d.substring(0,997)+"..."),console.log("âœ¨ Enhanced prompt:",d);const m=await this.openai.images.generate({model:r,prompt:d,n:1,size:c,quality:l,style:"vivid",response_format:"b64_json"});console.log("ðŸ“¡ OpenAI response received:",{hasData:!!m.data,dataLength:null==(a=m.data)?void 0:a.length,hasBase64:!!(null==(o=null==(s=m.data)?void 0:s[0])?void 0:o.b64_json)});const p=null==(n=m.data)?void 0:n[0];if(!p)throw console.error("âŒ No image data in response:",m),new Error("No image data returned from OpenAI");const h=p.b64_json;if(!h)throw console.error("âŒ No base64 data in response:",p),new Error("No base64 image data returned from OpenAI");const u=`data:image/png;base64,${h}`;return console.log("âœ… Image generated and converted to data URL (self-contained)"),u}catch(i){if(console.error("âŒ DALL-E Image Generation Error:",i),401===i.status)throw new Error("Invalid OpenAI API key. Please check your API key settings.");if(429===i.status)throw new Error("Rate limit exceeded. Please wait a moment before generating another image.");if(402===i.status)throw new Error("Insufficient OpenAI credits. Please add credits to your account.");if(400===i.status)throw new Error("The image prompt was rejected by OpenAI content policy. Please try a different description.");throw new Error(`Failed to generate image: ${i.message||"Unknown error"}`)}}async analyzeCinematography(e){if(!this.isReady())return{lighting:"AI not configured",performance:"AI not configured",cameraMovement:"AI not configured",composition:"AI not configured",sound:"AI not configured"};try{const r=`Analyze the cinematography for the following scene and provide feedback as a valid JSON object. The JSON object must contain these exact keys: "lighting", "performance", "cameraMovement", "composition", and "sound".\n\nScene: "${e}"\n\nReturn ONLY the raw JSON object, without any markdown formatting, comments, or other text.`,a=(await this.openai.chat.completions.create({model:"gpt-4o-mini",messages:[{role:"user",content:r}],temperature:.6,max_tokens:250,response_format:{type:"json_object"}})).choices[0].message.content;if(a)try{const e=JSON.parse(a),t=["lighting","performance","cameraMovement","composition","sound"];for(const r of t)"string"!=typeof e[r]&&(e[r]="Analysis incomplete");return e}catch(t){return console.error("Failed to parse cinematography analysis JSON:",t,"Raw content:",a),{lighting:"Error processing AI response",performance:"Error processing AI response",cameraMovement:"Error processing AI response",composition:"Error processing AI response",sound:"Error processing AI response"}}return{lighting:"No analysis returned",performance:"No analysis returned",cameraMovement:"No analysis returned",composition:"No analysis returned",sound:"No analysis returned"}}catch(r){throw console.error("Error analyzing cinematography:",r),new Error(`Failed to analyze cinematography: ${r.message||"Unknown error"}`)}}async generatePanelImage(e,t={}){const r=localStorage.getItem("aiImageSettings");let a=null;if(r)try{a=JSON.parse(r),console.log("ðŸŽ¨ Found AI image settings:",a)}catch(i){console.error("Failed to parse AI image settings:",i)}else console.log("âš ï¸ No AI image settings found in localStorage");const s=this.createImagePromptFromPanel(e,a);console.log("ðŸ“ Enhanced prompt with settings:",s);const o={style:"photorealistic"===(null==a?void 0:a.style)?"realistic":"illustration"===(null==a?void 0:a.style)?"artistic":"sketch"===(null==a?void 0:a.style)?"storyboard":"cinematic",quality:(null==a?void 0:a.quality)||"standard",size:(null==a?void 0:a.size)||"1024x1024",...t};console.log("ðŸŽ›ï¸ Enhanced generation options:",o);let n=(null==a?void 0:a.model)||"dall-e-3";return"dall-e-2"===n&&(console.log("âš ï¸ DALL-E 2 is discontinued, falling back to DALL-E 3"),n="dall-e-3"),console.log("ðŸ¤– Using AI model:",n),a&&console.log("ðŸ“Š Settings Applied Summary:",{"âœ… Model":n,"âœ… Style":a.style+" â†’ "+o.style,"âœ… Quality":o.quality,"âœ… Size":o.size,"âœ… Art Style":a.artStyle,"âœ… Lighting":a.lighting,"âœ… Mood":a.mood,"âœ… Color Scheme":a.colorScheme,"âœ… Creativity":a.creativity+"/10","âš ï¸ Aspect Ratio":a.aspectRatio+" (not used - size controls this)"}),this.generateImage(s,o,n)}createImagePromptFromPanel(e,t=null){let r=`${e.description}, ${{"close-up":"close-up shot focusing on details","medium-shot":"medium shot showing subject from waist up","wide-shot":"wide shot showing full scene and environment","extreme-close-up":"extreme close-up shot with intimate detail","over-the-shoulder":"over-the-shoulder perspective shot","two-shot":"two-shot showing two subjects in frame","establishing-shot":"establishing shot showing location and context"}[e.shotType]||"medium shot"}, ${{"high-angle":"shot from high angle looking down","low-angle":"shot from low angle looking up","eye-level":"shot at eye level","birds-eye-view":"aerial birds eye view shot","worms-eye-view":"worms eye view shot from ground level","dutch-angle":"dutch angle tilted shot for dramatic effect"}[e.cameraAngle]||"eye level"}`;if(e.notes&&(r+=`, ${e.notes}`),e.videoPrompt){r+=`, ${this.sanitizePrompt(e.videoPrompt)}`}if(t){if(t.artStyle&&"cinematic"!==t.artStyle){r+=`, ${{dramatic:"dramatic composition",minimalist:"clean minimalist style",vintage:"vintage aesthetic",modern:"contemporary style",fantasy:"fantasy art style",noir:"film noir aesthetic"}[t.artStyle]||`${t.artStyle} style`}`}if(t.lighting&&"natural"!==t.lighting){r+=`, ${{dramatic:"dramatic lighting",soft:"soft lighting","golden-hour":"warm golden lighting",moody:"atmospheric lighting",bright:"bright illumination","low-light":"subtle lighting"}[t.lighting]||`${t.lighting} lighting`}`}if(t.mood&&"neutral"!==t.mood){r+=`, ${{happy:"uplifting atmosphere",dramatic:"dramatic atmosphere",mysterious:"mysterious atmosphere",peaceful:"serene atmosphere",energetic:"dynamic composition",melancholic:"contemplative mood"}[t.mood]||`${t.mood} atmosphere`}`}if(t.colorScheme&&"full-color"!==t.colorScheme)switch(t.colorScheme){case"monochrome":r+=", black and white photography";break;case"warm-tones":r+=", warm color palette";break;case"cool-tones":r+=", cool color palette";break;case"sepia":r+=", sepia tone";break;case"high-contrast":r+=", high contrast"}t.creativity>=8?r+=", artistic interpretation":t.creativity<=3&&(r+=", precise composition")}return r=this.sanitizePrompt(r),r.length>800&&(r=r.substring(0,800)+"...",console.log("âš ï¸ Prompt truncated due to length:",r.length)),r}sanitizePrompt(e){const t=["violence","violent","blood","weapon","gun","knife","sword","fight","battle","war","kill","death","dead","sexy","seductive","provocative","nude","naked","intimate","romantic","sensual","explosive","dangerous","harmful","illegal","drug","alcohol"];let r=e.toLowerCase();for(const a of t){const e=new RegExp(`\\b${a}\\b`,"gi");e.test(r)&&(console.log(`âš ï¸ Sanitizing potentially problematic term: "${a}"`),r=r.replace(e,(e=>{switch(a){case"fight":case"battle":return"action scene";case"weapon":case"gun":case"knife":case"sword":return"prop";case"violence":case"violent":default:return"dramatic";case"blood":return"red liquid";case"sexy":case"seductive":return"elegant";case"romantic":case"intimate":return"emotional";case"dangerous":return"exciting"}})))}return r=r.replace(/,\s*,/g,","),r=r.replace(/\s+/g," "),r=r.trim(),r}createProxyImageUrl(e){return e}async downloadAndConvertImageWithAuth(e){try{if(console.log("ðŸ“¥ Attempting authenticated download from:",e),!this.isReady())return console.warn("âš ï¸ OpenAI not initialized, trying without auth"),await this.downloadAndConvertImage(e);const r=this.getApiKey();if(!r)return console.warn("âš ï¸ No API key available, trying without auth"),await this.downloadAndConvertImage(e);try{console.log("ðŸ” Trying authenticated fetch with API key...");const t=await fetch(e,{method:"GET",headers:{Authorization:`Bearer ${r}`,Accept:"image/*","User-Agent":"Mozilla/5.0 (compatible; StoryboardAI/1.0)"},mode:"cors"});if(t.ok){const e=await t.blob();return console.log("âœ… Authenticated image download successful, size:",e.size,"bytes"),new Promise(((t,r)=>{const a=new FileReader;a.onload=()=>{const e=a.result;console.log("ðŸ”„ Image converted to data URL with auth"),t(e)},a.onerror=()=>{console.error("âŒ Failed to convert authenticated image to data URL"),r(new Error("Failed to convert image"))},a.readAsDataURL(e)}))}console.warn("âš ï¸ Authenticated fetch failed with status:",t.status)}catch(t){console.warn("âš ï¸ Authenticated fetch failed:",t)}return console.log("ðŸ”„ Falling back to non-authenticated download..."),await this.downloadAndConvertImage(e)}catch(r){return console.error("âŒ Authenticated image download failed:",r),e}}async downloadAndConvertImage(e){try{console.log("ðŸ“¥ Attempting to download image from:",e);try{const t=await fetch(e,{mode:"cors",headers:{Accept:"image/*","User-Agent":"Mozilla/5.0 (compatible; StoryboardAI/1.0)"}});if(t.ok){const e=await t.blob();return console.log("âœ… Image downloaded via CORS, size:",e.size,"bytes"),new Promise(((t,r)=>{const a=new FileReader;a.onload=()=>{const e=a.result;console.log("ðŸ”„ Image converted to data URL"),t(e)},a.onerror=()=>{console.error("âŒ Failed to convert image to data URL"),r(new Error("Failed to convert image"))},a.readAsDataURL(e)}))}}catch(t){console.warn("âš ï¸ CORS fetch failed, trying alternatives:",t)}try{await fetch(e,{mode:"no-cors"});return console.log("ðŸ”„ Attempted no-cors fetch, returning original URL"),e}catch(r){console.warn("âš ï¸ No-cors fetch failed:",r)}return console.log("ðŸ”„ All download attempts failed, returning original URL"),e}catch(a){return console.error("âŒ Image download/conversion failed:",a),e}}async generatePanelImageWithDownload(e,t={}){try{const r=await this.generatePanelImage(e,t);return r?(console.log("âœ… Image generated as self-contained data URL"),r):null}catch(r){throw console.error("âŒ Panel image generation failed:",r),r}}generateFallbackResponse(e){const t=e.toLowerCase();return t.includes("api key")||t.includes("setup")?'ðŸ”‘ **OpenAI API Setup Required**\n\nTo enable AI features, you\'ll need an OpenAI API key:\n\n1. **Get API Key**: Visit [OpenAI API Keys](https://platform.openai.com/api-keys)\n2. **Create Key**: Click "Create new secret key"\n3. **Copy Key**: It starts with "sk-"\n4. **Add to App**: Use the settings menu to add your key\n\n**Cost**: GPT-4o-mini costs ~$0.15 per 1M input tokens (very affordable!)\n\nOnce set up, I can:\nâ€¢ Generate complete storyboards\nâ€¢ Edit existing panels\nâ€¢ Create video prompts\nâ€¢ Provide filmmaking advice\n\nWould you like me to walk you through the setup?':t.includes("generate")||t.includes("create")?'ðŸŽ¬ **Ready to Create!**\n\nI\'d love to generate content for you, but I need an OpenAI API key first.\n\n**Quick Setup**:\n1. Get your key from OpenAI\n2. Add it in Settings\n3. Then say things like:\n   â€¢ "Generate storyboard for: space adventure"\n   â€¢ "Create 6 panels about a love story"\n   â€¢ "Add a panel showing dramatic confrontation"\n\n**Manual Alternative**: Use the Templates or create panels manually while we get AI set up!':"ðŸ¤– **AI Assistant Available**\n\nI'm your storyboard AI assistant! I can help with:\n\n**âœ¨ AI Features** (requires OpenAI API key):\nâ€¢ Generate complete storyboards\nâ€¢ Edit and improve existing panels  \nâ€¢ Create video generation prompts\nâ€¢ Provide expert filmmaking advice\n\n**ðŸ› ï¸ Always Available**:\nâ€¢ Project templates and examples\nâ€¢ Manual panel editing\nâ€¢ Story structure guidance\nâ€¢ Filmmaking best practices\n\nTo unlock AI features, add your OpenAI API key in Settings. Otherwise, I'm here to help with guidance and manual tools!\n\nWhat would you like to work on?"}generateFallbackStoryboard(e,t){const r=[],a=["establishing-shot","medium-shot","close-up","wide-shot","over-the-shoulder","two-shot"],s=["eye-level","high-angle","low-angle","birds-eye-view"],o=e.toLowerCase(),n=o.includes("fight")||o.includes("chase")||o.includes("battle"),i=o.includes("love")||o.includes("romance")||o.includes("relationship"),l=o.includes("horror")||o.includes("scary")||o.includes("monster"),c=o.includes("mystery")||o.includes("detective")||o.includes("crime");for(let d=0;d<t;d++){const o=d+1;let m="",p="",h="";if(1===o)m=`Opening Scene - ${e}`,p="The story begins with an establishing shot that introduces the world and main character. The scene sets the tone and draws the audience into the narrative.",h="Use wide establishing shot to show location and atmosphere. Consider dramatic lighting to set mood.";else if(o===t)m=`Resolution - ${e}`,p="The final panel brings closure to the story arc. Characters reach their destination or complete their journey with satisfying resolution.",h="Choose shot that provides emotional closure. Consider character positioning and lighting for impact.";else if(o===Math.floor(.7*t))m=`Climax - ${e}`,p="The story reaches its peak tension and drama. This is the moment of highest conflict and emotional intensity in the narrative.",h="Use dynamic camera angle and dramatic lighting. Consider close-ups for emotional impact.";else{const t=["Character Development","Rising Action","Plot Development","Tension Builds","Story Unfolds"];m=`${t[d%t.length]} - ${e}`,p="The story continues to develop with character growth and plot advancement. New challenges and obstacles move the narrative forward toward its climax.",h="Vary shot types for visual interest. Focus on character emotions and story progression."}n?h+=" Consider dynamic angles and movement for action sequences.":i?h+=" Use softer lighting and intimate framing for emotional connection.":l?h+=" Employ dramatic shadows and tension-building composition.":c&&(h+=" Use lighting and angles to create suspense and intrigue."),r.push({id:`fallback-panel-${Date.now()}-${d}`,title:m,description:p,shotType:a[d%a.length],cameraAngle:s[d%s.length],notes:h,duration:4+d%3,order:d,createdAt:new Date,updatedAt:new Date,videoPrompt:`Professional video: ${a[d%a.length]} ${s[d%s.length]} showing: ${p.substring(0,80)}..., 4K cinematic quality, 24fps smooth motion, professional color grading, dramatic lighting, photorealistic rendering, ${4+d%3}s duration`})}return r}generateFallbackScene(e,t,r,a){const s=e.split(" ").filter((e=>e.length>3&&!["the","and","with","from","this","that","they","them","their","there","where","when","what","which"].includes(e.toLowerCase()))).slice(0,3).map((e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()));return{title:s.length>0?s.join(" "):`${t} Scene`,description:`${t} ${r} showing: ${e}`,notes:`${a} mood - manually adjust lighting and composition as needed`,shotType:t,cameraAngle:r,videoPrompt:`Professional video: ${t} ${r} of ${e}, ${a} atmosphere, 4K cinematic quality, 24fps smooth motion, professional lighting, photorealistic rendering, shallow depth of field`}}};function rt({panel:r,isSelected:a,onSelect:s,onEdit:n,onDelete:i,onMoveUp:c,onMoveDown:d,canMoveUp:m,canMoveDown:p,onDragStart:h,onDragEnd:u,onTouchStart:g,onTouchMove:y,onTouchEnd:x,isMobile:f=!1}){const{dispatch:b}=We(),{state:v}=Je(),w=_e(v.theme),[j,N]=e.useState(!1),[S,I]=e.useState(r.title),[T,F]=e.useState(r.description),[z,R]=e.useState(!1),[U,W]=e.useState(!1),[_,B]=e.useState(!1),[H,G]=e.useState(!1),[q,V]=e.useState(null),[J,K]=e.useState(!1),[Y,Q]=e.useState(!1),[X,Z]=e.useState(!1);e.useRef(null);const ee=e.useRef(null),te=a||z;e.useEffect((()=>{if(r.imageUrl){G(!1);const e=new Image;e.onload=()=>G(!0),e.src=r.imageUrl}}),[r.imageUrl]),e.useEffect((()=>{const e=()=>{if(ee.current){const e=ee.current,t=parseInt(window.getComputedStyle(e).lineHeight)*(f?3:4);Z(e.scrollHeight>t)}};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[r.description,f]);const re=async e=>{if(e&&(e.stopPropagation(),e.preventDefault()),!_){B(!0);try{const e=await tt.generateImage(r.description);b({type:"UPDATE_PANEL",payload:{id:r.id,updates:{imageUrl:e||void 0}}})}catch(t){console.error("Error generating image:",t)}finally{B(!1)}}};return t.jsxs("div",{className:"storyboard-panel group relative rounded-2xl transition-all duration-200 cursor-pointer overflow-hidden "+(a?"selected ring-2 shadow-lg":z?"hovered ring-1 shadow-md":"shadow-sm hover:shadow-md border"),style:{backgroundColor:v.theme.colors.background.primary,borderColor:v.theme.colors.border.primary,...a&&{ringColor:v.theme.colors.primary[500],borderColor:v.theme.colors.primary[300]},...z&&!a&&{ringColor:v.theme.colors.primary[200],borderColor:v.theme.colors.primary[200]}},onClick:e=>{const t=e.target;t.closest("button")||t.closest("input")||t.closest("textarea")||s()},onMouseEnter:()=>{f||(R(!0),W(!0))},onMouseLeave:()=>{f||(R(!1),W(!1))},draggable:!f,onDragStart:e=>null==h?void 0:h(e,r.id),onDragEnd:u,onTouchStart:e=>null==g?void 0:g(e,r.id),onTouchMove:y,onTouchEnd:x,children:[a&&t.jsx("div",{className:"absolute top-1 right-1 z-40",children:t.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center font-bold text-xs shadow-lg",style:{backgroundColor:v.theme.colors.primary[500],color:"#ffffff"},children:"âœ“"})}),t.jsx("div",{className:"absolute top-3 left-3 z-30",children:t.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm transition-all duration-300 "+(a?"shadow-lg ring-2":"shadow-md border-2"),style:{backgroundColor:a?v.theme.colors.primary[500]:v.theme.colors.background.primary,color:a?"white":v.theme.colors.text.primary,borderColor:a?"transparent":v.theme.colors.border.primary},children:r.order+1})}),t.jsxs("div",{className:"absolute top-2 right-2 z-50 transition-all duration-200 "+(U||a?"opacity-100 transform translate-x-0 scale-100":"opacity-0 transform translate-x-6 scale-75"),children:[t.jsxs("div",{className:"flex flex-wrap gap-1 mb-2 justify-end",children:[m&&t.jsx("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),null==c||c()},className:"w-7 h-7 sm:w-8 sm:h-8 rounded-lg flex items-center justify-center transition-all duration-150 hover:scale-105 shadow-sm hover:shadow-md touch-manipulation",style:{backgroundColor:w.interactive.primary.background,color:w.interactive.primary.text},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=w.interactive.primary.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=w.interactive.primary.background},title:"Move Up",children:t.jsx(E,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),p&&t.jsx("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),null==d||d()},className:"w-7 h-7 sm:w-8 sm:h-8 rounded-lg flex items-center justify-center transition-all duration-150 hover:scale-105 shadow-sm hover:shadow-md touch-manipulation",style:{backgroundColor:w.interactive.primary.background,color:w.interactive.primary.text},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=w.interactive.primary.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=w.interactive.primary.background},title:"Move Down",children:t.jsx(D,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),t.jsx("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),n?n():N(!0)},className:"w-7 h-7 sm:w-8 sm:h-8 rounded-lg flex items-center justify-center transition-all duration-150 hover:scale-105 shadow-sm hover:shadow-md touch-manipulation",style:{backgroundColor:w.status.success.background,color:w.status.success.text},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=w.status.success.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=w.status.success.background},title:"Edit Panel",children:t.jsx($,{className:"w-3 h-3 sm:w-4 sm:h-4"})}),t.jsx("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),i&&i()},className:"w-7 h-7 sm:w-8 sm:h-8 rounded-lg flex items-center justify-center transition-all duration-150 hover:scale-105 shadow-sm hover:shadow-md touch-manipulation",style:{backgroundColor:w.status.error.background,color:w.status.error.text},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=w.status.error.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=w.status.error.background},title:"Delete Panel",children:t.jsx(P,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]}),t.jsx("div",{className:"flex flex-wrap gap-1 justify-end",children:t.jsx("button",{onClick:re,disabled:_,className:"w-7 h-7 sm:w-8 sm:h-8 bg-purple-500 hover:bg-purple-600 text-white rounded-lg flex items-center justify-center transition-all duration-150 hover:scale-105 shadow-sm hover:shadow-md touch-manipulation "+(_?"opacity-50 cursor-not-allowed":""),title:"Generate Image",children:_?t.jsx(M,{className:"w-3 h-3 sm:w-4 sm:h-4 animate-spin"}):t.jsx(k,{className:"w-3 h-3 sm:w-4 sm:h-4"})})})]}),j?t.jsx("div",{className:"p-5 border-b",style:{background:`linear-gradient(135deg, ${v.theme.colors.primary[50]}, ${v.theme.colors.secondary[50]})`,borderColor:v.theme.colors.primary[200]},children:t.jsx("div",{className:"pl-12 pr-3",children:t.jsx("input",{type:"text",value:S,onChange:e=>I(e.target.value),className:"w-full px-4 py-3 border-2 rounded-xl font-bold text-lg focus:ring-4 transition-all duration-300 shadow-sm",style:{backgroundColor:v.theme.colors.background.primary,borderColor:v.theme.colors.primary[300],color:v.theme.colors.text.primary},placeholder:"Panel title..."})})}):t.jsx("div",{className:"p-4 border-b relative z-10",style:{backgroundColor:a?`${v.theme.colors.primary[50]}90`:v.theme.colors.background.secondary,borderColor:v.theme.colors.border.primary},children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex-1 min-w-0 pl-12 pr-3",children:[t.jsx("h3",{className:"text-lg font-semibold leading-tight truncate mb-2",style:{color:v.theme.colors.text.primary,textShadow:te?"0 1px 2px rgba(0,0,0,0.1)":"none"},children:r.title}),t.jsxs("div",{className:"flex items-center flex-wrap gap-2",children:[t.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-medium border",style:{backgroundColor:w.status.info.light,color:w.status.info.background,borderColor:w.status.info.border},children:["ðŸ“½ï¸ ",r.shotType.replace("-"," ")]}),t.jsxs("span",{className:"px-2 py-1 rounded-full text-xs font-medium border",style:{backgroundColor:w.status.success.light,color:w.status.success.background,borderColor:w.status.success.border},children:["ðŸ“ ",r.cameraAngle.replace("-"," ")]}),t.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 rounded-full text-xs font-medium border",style:{backgroundColor:w.project.purple.light,color:w.project.purple.background,borderColor:w.project.purple.background+"40"},children:[t.jsx(L,{className:"w-3 h-3"}),t.jsxs("span",{children:[r.duration,"s"]})]})]})]})})}),t.jsx("div",{className:"relative aspect-video overflow-hidden",style:{background:`linear-gradient(135deg, ${v.theme.colors.background.secondary}, ${v.theme.colors.background.tertiary})`},children:r.imageUrl?t.jsxs(t.Fragment,{children:[t.jsx("img",{src:r.imageUrl,alt:r.title,className:"w-full h-full object-cover transition-all duration-500 "+(H?"opacity-100 scale-100":"opacity-0 scale-110"),onLoad:()=>G(!0),onError:()=>G(!1)}),!H&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center",style:{background:`linear-gradient(135deg, ${v.theme.colors.primary[100]}, ${v.theme.colors.secondary[50]}, ${v.theme.colors.primary[100]})`},children:t.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"w-16 h-16 rounded-full animate-bounce",style:{background:`linear-gradient(135deg, ${v.theme.colors.primary[400]}, ${v.theme.colors.secondary[400]})`}}),t.jsx("div",{className:"absolute inset-0 w-16 h-16 border-4 border-t-transparent rounded-full animate-spin",style:{borderColor:v.theme.colors.primary[300]}})]}),t.jsx("p",{className:"text-sm font-bold",style:{color:v.theme.colors.primary[600]},children:"Loading amazing image..."})]})}),t.jsx("div",{className:"absolute bottom-3 left-3 right-3 glass-effect rounded-xl p-2 transition-all duration-500 "+(te?"opacity-100 transform translate-y-0":"opacity-0 transform translate-y-4"),children:t.jsxs("div",{className:"flex items-center justify-between text-white text-sm",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-2 h-2 bg-green-400 rounded-full animate-pulse"}),t.jsx("span",{className:"font-medium text-xs",children:"Ready"})]}),t.jsx("div",{className:"text-xs opacity-75",children:(new Date).toLocaleDateString()})]})}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-black/30 via-transparent to-black/30 transition-all duration-500 flex items-center justify-center "+(U?"opacity-100":"opacity-0"),children:t.jsx("div",{className:"flex space-x-4 animate-bounce-in",children:t.jsx("button",{onClick:e=>{e.stopPropagation(),(async()=>{re()})()},disabled:_,className:"w-14 h-14 bg-gradient-to-r from-purple-500/90 to-pink-500/90 hover:from-purple-600/90 hover:to-pink-600/90 text-white rounded-2xl flex items-center justify-center transition-all duration-300 transform hover:scale-110 disabled:opacity-50 shadow-xl hover:shadow-2xl animate-fade-in animate-delay-200",title:"Regenerate Image",children:_?t.jsx(M,{className:"w-6 h-6 animate-spin"}):t.jsx(O,{className:"w-6 h-6"})})})}),_&&t.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-80 flex items-center justify-center",children:t.jsxs("div",{className:"rounded-2xl p-8 flex flex-col items-center space-y-6 animate-fade-in shadow-2xl",style:{backgroundColor:v.theme.colors.background.primary},children:[t.jsxs("div",{className:"relative",children:[t.jsx(l,{className:"w-16 h-16 animate-bounce",style:{color:v.theme.colors.primary[500]}}),t.jsx("div",{className:"absolute inset-0 w-16 h-16 border-4 border-t-transparent rounded-full animate-spin",style:{borderColor:v.theme.colors.primary[200]}})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"font-bold text-lg",style:{color:v.theme.colors.text.primary},children:"âœ¨ Creating Magic"}),t.jsx("p",{className:"text-sm",style:{color:v.theme.colors.text.secondary},children:"AI is painting your vision..."}),t.jsx("div",{className:"mt-3 w-32 h-2 rounded-full overflow-hidden",style:{backgroundColor:v.theme.colors.background.tertiary},children:t.jsx("div",{className:"h-full rounded-full",style:{background:`linear-gradient(90deg, ${v.theme.colors.primary[500]}, ${v.theme.colors.secondary[500]})`}})})]})]})})]}):t.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",style:{color:v.theme.colors.text.tertiary,background:`linear-gradient(135deg, ${v.theme.colors.background.secondary}, ${v.theme.colors.background.primary})`},children:[t.jsx("div",{className:"w-24 h-24 rounded-2xl flex items-center justify-center mb-6 animate-float shadow-lg",style:{background:`linear-gradient(135deg, ${v.theme.colors.primary[200]}, ${v.theme.colors.secondary[200]}, ${v.theme.colors.primary[200]})`},children:t.jsx(o,{className:"w-12 h-12",style:{color:v.theme.colors.primary[500]}})}),t.jsx("p",{className:"text-xl font-bold mb-3",style:{color:v.theme.colors.text.primary},children:"No Image Yet"}),t.jsx("button",{onClick:re,disabled:_,className:"font-bold py-3 px-6 rounded-xl flex items-center space-x-3 transition-all duration-300 transform hover:scale-105 shadow-lg hover:shadow-xl "+(_?"opacity-50 cursor-not-allowed":""),style:{background:`linear-gradient(135deg, ${v.theme.colors.primary[500]}, ${v.theme.colors.primary[600]})`,color:"#ffffff"},onMouseEnter:e=>{_||(e.currentTarget.style.background=`linear-gradient(135deg, ${v.theme.colors.primary[600]}, ${v.theme.colors.primary[700]})`)},onMouseLeave:e=>{_||(e.currentTarget.style.background=`linear-gradient(135deg, ${v.theme.colors.primary[500]}, ${v.theme.colors.primary[600]})`)},children:_?t.jsxs(t.Fragment,{children:[t.jsx(M,{className:"w-5 h-5 animate-spin"}),t.jsx("span",{children:"Generating..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(k,{className:"w-5 h-5"}),t.jsx("span",{children:"ðŸŽ¨ Generate Image"})]})})]})}),t.jsxs("div",{className:"p-3 sm:p-4 lg:p-5",style:{backgroundColor:v.theme.colors.background.primary},children:[j?t.jsxs("div",{className:"space-y-4",children:[t.jsx("textarea",{value:T,onChange:e=>F(e.target.value),className:"w-full px-4 py-3 border-2 rounded-xl resize-none focus:ring-4 transition-all duration-300",style:{backgroundColor:v.theme.colors.background.secondary,borderColor:v.theme.colors.border.primary,color:v.theme.colors.text.primary},rows:4,placeholder:"Describe your panel in vivid detail..."}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:()=>{b({type:"UPDATE_PANEL",payload:{id:r.id,updates:{title:S,description:T}}}),N(!1)},className:"flex-1 font-bold py-3 px-4 rounded-xl transform hover:scale-105 transition-all duration-300 shadow-lg",style:{background:`linear-gradient(135deg, ${v.theme.colors.primary[500]}, ${v.theme.colors.primary[600]})`,color:"#ffffff"},onMouseEnter:e=>{e.currentTarget.style.background=`linear-gradient(135deg, ${v.theme.colors.primary[600]}, ${v.theme.colors.primary[700]})`},onMouseLeave:e=>{e.currentTarget.style.background=`linear-gradient(135deg, ${v.theme.colors.primary[500]}, ${v.theme.colors.primary[600]})`},children:"âœ… Save Changes"}),t.jsx("button",{onClick:()=>{I(r.title),F(r.description),N(!1)},className:"flex-1 font-bold py-3 px-4 rounded-xl transform hover:scale-105 transition-all duration-300",style:{backgroundColor:v.theme.colors.background.tertiary,color:v.theme.colors.text.primary},children:"âŒ Cancel"})]})]}):t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"relative",children:[t.jsx("p",{ref:ee,className:`leading-relaxed text-sm sm:text-base transition-all duration-300 ${te?"text-high-contrast":"text-secondary-theme"} ${!Y&&X?"line-clamp-3 sm:line-clamp-4 overflow-hidden":""}`,style:{color:v.theme.colors.text.primary,lineHeight:f?"1.4":"1.5"},children:r.description}),X&&t.jsx("button",{onClick:()=>Q(!Y),className:`mt-2 flex items-center gap-1 text-xs font-medium transition-all duration-200 hover:scale-105 touch-manipulation ${f?"px-3 py-2":"px-2 py-1"} rounded-full`,style:{backgroundColor:`${v.theme.colors.primary[500]}20`,color:v.theme.colors.primary[600],border:`1px solid ${v.theme.colors.primary[200]}`},children:Y?t.jsxs(t.Fragment,{children:[t.jsx(C,{className:"w-3 h-3"}),"Show Less"]}):t.jsxs(t.Fragment,{children:[t.jsx(A,{className:"w-3 h-3"}),"Show More"]})})]}),r.notes&&t.jsx("div",{className:"mt-3 p-2 sm:p-3 rounded-lg border "+(f?"text-xs":"text-sm"),style:{backgroundColor:`${v.theme.colors.secondary[50]}50`,borderColor:v.theme.colors.border.secondary,color:v.theme.colors.text.secondary},children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-xs opacity-75",children:"ðŸ“"}),t.jsx("span",{className:"flex-1 leading-relaxed",children:r.notes})]})})]}),r.notes&&t.jsx("div",{className:"mt-4 p-4 rounded-xl border-l-4 shadow-sm",style:{background:`linear-gradient(135deg, ${v.theme.colors.secondary[50]}, ${v.theme.colors.primary[50]})`,borderColor:v.theme.colors.primary[400]},children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",style:{backgroundColor:v.theme.colors.primary[400]},children:t.jsx("span",{className:"text-white text-xs font-bold",children:"ðŸ’¡"})}),t.jsx("p",{className:"text-sm font-medium",style:{color:v.theme.colors.primary[800]},children:r.notes})]})})]}),q&&t.jsx("div",{className:"absolute bottom-4 left-4 right-4 px-4 py-3 rounded-xl text-white text-sm font-bold animate-fade-in shadow-lg "+(q.includes("success")?"bg-gradient-to-r from-emerald-500 to-green-500":"bg-gradient-to-r from-red-500 to-pink-500"),children:t.jsxs("div",{className:"flex items-center space-x-2",children:[q.includes("success")?t.jsx("div",{className:"w-5 h-5 bg-white rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-green-500 text-xs",children:"âœ“"})}):t.jsx("div",{className:"w-5 h-5 bg-white rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-red-500 text-xs",children:"âœ—"})}),t.jsx("span",{children:q})]})}),a&&t.jsx("div",{className:"absolute -inset-1 rounded-3xl opacity-20 pointer-events-none blur-sm",style:{background:`linear-gradient(135deg, ${v.theme.colors.primary[500]}, ${v.theme.colors.secondary[500]}, ${v.theme.colors.primary[500]})`}}),z&&!a&&t.jsx("div",{className:"absolute -inset-0.5 rounded-3xl opacity-10 pointer-events-none blur-sm",style:{background:`linear-gradient(135deg, ${v.theme.colors.primary[400]}, ${v.theme.colors.secondary[400]}, ${v.theme.colors.primary[400]})`}})]})}const at=({context:r,className:a=""})=>{const{state:s}=Je(),{state:o}=We(),[l,c]=e.useState(0),[d,m]=e.useState(!0),[p,h]=e.useState(!1);e.useEffect((()=>{"true"===localStorage.getItem(`contextual-tips-${r}-dismissed`)&&(h(!0),m(!1))}),[r]);const u=(()=>{switch(r){case"empty":return["ðŸ‘‹ Welcome to Storyboard AI! Start by clicking 'New Project' or choose a template.","ðŸ’¡ Try the AI Assistant to generate your first story panels automatically.","ðŸŽ¨ Use the Templates section for quick starts on common story types."];case"first-panel":return["ðŸŽ‰ Great! You created your first panel. Double-click it to add content.","âœ¨ Use the AI Assistant to generate images and refine your story.","ðŸ“ Add detailed descriptions, dialogue, and camera notes in the panel editor."];case"ai-assistant":return["ðŸ¤– Describe your story concept and let AI generate panel scripts for you.","ðŸŽ¯ Be specific about genres, moods, and visual styles for better results.","ðŸ”„ Ask for revisions by describing what you want changed.","âš™ï¸ Check AI Settings to customize image dimensions and style preferences."];case"panel-editing":return["âœï¸ Write clear, concise scene descriptions for each panel.","ðŸŽ¬ Include camera angles like 'close-up', 'wide shot', or 'bird's eye view'.","ðŸŽ­ Add dialogue, sound effects, and timing notes for complete scenes.","ðŸ”„ Use the timeline view to check story flow and pacing."];default:return["ðŸ’¾ Your work auto-saves, but you can export projects as JSON for backup.","ðŸŽ¨ Switch themes to match your project's mood or reduce eye strain.","âŒ¨ï¸ Press Ctrl/Cmd + N for new panels, Ctrl/Cmd + S to save.","ðŸ–±ï¸ Right-click panels for quick actions like duplicate or delete."]}})();return!d||p||0===u.length?null:t.jsxs("div",{className:`bg-opacity-98 rounded-lg border shadow-lg p-4 animate-slide-in-from-bottom glass-effect ${a}`,style:{backgroundColor:s.theme.colors.primary[50],borderColor:s.theme.colors.primary[200],color:s.theme.colors.primary[800]},children:[t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[t.jsx(F,{className:"h-5 w-5 mt-0.5 flex-shrink-0",style:{color:s.theme.colors.primary[600]}}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-sm font-medium mb-1",children:["ðŸ’¡ Tip ",l+1," of ",u.length]}),t.jsx("p",{className:"text-sm leading-relaxed",children:u[l]})]})]}),t.jsx("button",{onClick:()=>{m(!1),h(!0),localStorage.setItem(`contextual-tips-${r}-dismissed`,"true")},className:"p-1 rounded-full transition-colors ml-2 flex-shrink-0",style:{color:s.theme.colors.primary[500]},onMouseOver:e=>{e.currentTarget.style.backgroundColor=s.theme.colors.primary[100]},onMouseOut:e=>{e.currentTarget.style.backgroundColor="transparent"},title:"Dismiss tips",children:t.jsx(n,{className:"h-4 w-4"})})]}),u.length>1&&t.jsxs("div",{className:"flex items-center justify-between mt-3 pt-3 border-t",style:{borderColor:s.theme.colors.primary[200]},children:[t.jsxs("button",{onClick:()=>{c((e=>(e-1+u.length)%u.length))},disabled:u.length<=1,className:"flex items-center space-x-1 px-2 py-1 rounded text-xs font-medium transition-colors disabled:opacity-50",style:{color:s.theme.colors.primary[600]},onMouseOver:e=>{e.currentTarget.disabled||(e.currentTarget.style.backgroundColor=s.theme.colors.primary[100])},onMouseOut:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[t.jsx(z,{className:"h-3 w-3"}),t.jsx("span",{children:"Previous"})]}),t.jsx("div",{className:"flex space-x-1",children:u.map(((e,r)=>t.jsx("div",{className:"w-2 h-2 rounded-full transition-colors",style:{backgroundColor:r===l?s.theme.colors.primary[500]:s.theme.colors.primary[200]}},r)))}),t.jsxs("button",{onClick:()=>{c((e=>(e+1)%u.length))},disabled:u.length<=1,className:"flex items-center space-x-1 px-2 py-1 rounded text-xs font-medium transition-colors disabled:opacity-50",style:{color:s.theme.colors.primary[600]},onMouseOver:e=>{e.currentTarget.disabled||(e.currentTarget.style.backgroundColor=s.theme.colors.primary[100])},onMouseOut:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[t.jsx("span",{children:"Next"}),t.jsx(i,{className:"h-3 w-3"})]})]})]})};function st({selectedPanel:r,onSelectPanel:a,onEditPanel:s}){const{state:n,dispatch:i}=We(),{state:l}=Je(),[c,d]=e.useState(null),[m,p]=e.useState(null),[u,g]=e.useState(null),[y,x]=e.useState(!1),[f,b]=e.useState(null),[v,w]=e.useState(null),j=e.useRef(null);e.useEffect((()=>{const e=()=>{const e=window.innerWidth<=768&&(navigator.maxTouchPoints>0||/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent));x(e)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),e.useEffect((()=>{j.current&&!y&&j.current.focus()}),[n.panels.length,y]),e.useEffect((()=>{const e=e=>{var t,o;const n=document.activeElement;if(!("INPUT"===(null==n?void 0:n.tagName)||"TEXTAREA"===(null==n?void 0:n.tagName)||(null==n?void 0:n.isContentEditable))&&!y)switch((null==(t=j.current)?void 0:t.contains(n))||null==(o=j.current)||o.focus(),e.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":e.preventDefault(),N(e.key);break;case"Enter":e.preventDefault(),r&&s(r);break;case"Delete":case"Backspace":e.preventDefault(),r&&S(r);break;case"Escape":e.preventDefault(),a(null),d(null)}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[r,n.panels,y]),e.useEffect((()=>{const e=()=>d(null);if(c)return document.addEventListener("click",e),()=>document.removeEventListener("click",e)}),[c]);const N=e=>{var t;const s=r?n.panels.findIndex((e=>e.id===r)):0;let o=s;const i=null==(t=j.current)?void 0:t.querySelector(".storyboard-grid-container");if(!i)return;const l=window.getComputedStyle(i),c=parseFloat(l.gap)||16,d=i.clientWidth,m=Math.floor((d+c)/(280+c));switch(e){case"ArrowUp":o=Math.max(0,s-m);break;case"ArrowDown":o=Math.min(n.panels.length-1,s+m);break;case"ArrowLeft":o=Math.max(0,s-1);break;case"ArrowRight":o=Math.min(n.panels.length-1,s+1)}if(o!==s&&n.panels[o]){const e=n.panels[o].id;a(e)}},k=e=>{a(e),r===e&&s(e)},C=()=>{const e={id:`panel-${Date.now()}`,title:`Panel ${n.panels.length+1}`,description:"New panel description",shotType:"medium-shot",cameraAngle:"eye-level",duration:4,order:n.panels.length,notes:"",createdAt:new Date,updatedAt:new Date};i({type:"ADD_PANEL",payload:e}),a(e.id)},A=(e,t)=>{const r=n.panels.findIndex((t=>t.id===e));if(-1===r)return;const a="up"===t?r-1:r+1;a<0||a>=n.panels.length||i({type:"REORDER_PANELS",payload:{fromIndex:r,toIndex:a}})},S=e=>{confirm("Are you sure you want to delete this panel?")&&(i({type:"DELETE_PANEL",payload:e}),r===e&&a(null))},I=(e,t)=>{p(t),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/plain",t),r!==t&&a(t)},T=()=>{g(null)},$=()=>{p(null),g(null)},M=e=>{if(f&&v){const t=e.touches[0];Math.sqrt(Math.pow(t.clientX-v.x,2)+Math.pow(t.clientY-v.y,2))>10&&(clearTimeout(f),b(null))}},L=()=>{f&&(clearTimeout(f),b(null)),w(null)};return t.jsxs("div",{className:"h-full flex flex-col bg-secondary",ref:j,tabIndex:0,children:[t.jsxs("div",{className:"flex items-center justify-between p-4 md:p-6 border-b border-tertiary",children:[t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-primary mb-1 truncate",children:"Storyboard Grid"}),t.jsxs("p",{className:"text-xs sm:text-sm md:text-base text-secondary",children:[n.panels.length," panel",1!==n.panels.length?"s":""]})]}),t.jsx("div",{className:"flex items-center gap-2",children:t.jsxs("button",{onClick:C,className:(y?"px-4 py-3 ml-2":"px-3 py-2 sm:px-4 sm:py-2 md:px-4 md:py-2 ml-2")+" rounded-lg transition-all duration-200 flex items-center gap-2 text-sm md:text-base font-medium shadow-sm hover:shadow-md hover:scale-105 touch-manipulation",style:{backgroundColor:l.theme.colors.primary[500],color:"#ffffff"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=l.theme.colors.primary[600]},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=l.theme.colors.primary[500]},children:[t.jsx(h,{className:"w-4 h-4 flex-shrink-0"}),t.jsx("span",{className:""+(y?"":"hidden xs:inline"),children:"Add Panel"}),!y&&t.jsx("span",{className:"xs:hidden",children:"Add"})]})})]}),t.jsxs("div",{ref:j,className:"flex-1 overflow-auto p-3 sm:p-4 md:p-6 relative",tabIndex:0,role:"grid","aria-label":"Storyboard panels grid",style:{outline:"none"},children:[0===n.panels.length&&t.jsx(at,{context:"empty",className:"absolute top-4 right-4 max-w-sm z-10 hidden sm:block"}),1===n.panels.length&&t.jsx(at,{context:"first-panel",className:"absolute top-4 right-4 max-w-sm z-10 hidden sm:block"}),0===n.panels.length?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center animate-fadeIn",children:[t.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 bg-tertiary rounded-full flex items-center justify-center mb-4",children:t.jsx(o,{className:"w-6 h-6 sm:w-8 sm:h-8 text-secondary"})}),t.jsx("h3",{className:"text-base sm:text-lg font-semibold text-primary mb-2",children:"No panels yet"}),t.jsx("p",{className:"text-secondary mb-6 max-w-md text-sm sm:text-base px-4",children:"Start building your storyboard by adding your first panel. Create scenes, add descriptions, and generate images."}),t.jsxs("button",{onClick:C,className:"px-6 py-3 rounded-lg transition-all duration-200 flex items-center gap-2 hover:scale-105 transform font-medium shadow-md hover:shadow-lg touch-manipulation",style:{backgroundColor:l.theme.colors.primary[500],color:"#ffffff"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=l.theme.colors.primary[600]},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=l.theme.colors.primary[500]},children:[t.jsx(h,{className:"w-5 h-5"}),"Create First Panel"]})]}):t.jsx("div",{className:"storyboard-grid-container",children:n.panels.map(((e,o)=>t.jsx("div",{className:`storyboard-grid-item animate-fadeIn ${m===e.id?"opacity-50 scale-95":""} ${u===o?"ring-2 ring-blue-400 ring-opacity-60":""}`,style:{animationDelay:50*o+"ms"},onContextMenu:t=>((e,t)=>{e.preventDefault(),e.stopPropagation(),r!==t&&a(t),d({x:e.clientX,y:e.clientY,panelId:t})})(t,e.id),onDragOver:e=>((e,t)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",g(t)})(e,o),onDragLeave:T,onDrop:e=>((e,t)=>{if(e.preventDefault(),!m)return;const r=n.panels.findIndex((e=>e.id===m));if(-1===r||r===t)return p(null),void g(null);i({type:"REORDER_PANELS",payload:{fromIndex:r,toIndex:t}}),p(null),g(null)})(e,o),children:t.jsx(rt,{panel:e,isSelected:r===e.id,onSelect:()=>{var t;y?(t=e.id,k(t)):k(e.id)},onEdit:()=>s(e.id),onDelete:()=>S(e.id),onMoveUp:()=>A(e.id,"up"),onMoveDown:()=>A(e.id,"down"),canMoveUp:o>0,canMoveDown:o<n.panels.length-1,onDragStart:I,onDragEnd:$,onTouchStart:t=>((e,t)=>{if(y){const r=e.touches[0];w({x:r.clientX,y:r.clientY});const a=setTimeout((()=>{d({x:r.clientX,y:r.clientY,panelId:t}),navigator.vibrate&&navigator.vibrate(50)}),500);b(a)}})(t,e.id),onTouchMove:M,onTouchEnd:L,isMobile:y})},e.id)))}),c&&t.jsxs("div",{className:"fixed context-menu rounded-lg py-2 z-50 min-w-48",style:{left:c.x,top:c.y,backgroundColor:l.theme.colors.background.primary,border:`1px solid ${l.theme.colors.border.primary}`,boxShadow:"0 10px 40px rgba(0, 0, 0, 0.2)"},onClick:e=>e.stopPropagation(),children:[t.jsxs("button",{onClick:()=>{s(c.panelId),d(null)},className:"w-full px-4 py-2 text-left context-menu-item flex items-center gap-2 hover:bg-opacity-10",style:{color:l.theme.colors.text.primary,transition:"background-color 0.15s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=`${l.theme.colors.primary[500]}20`},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[t.jsx("div",{className:"w-4 h-4 rounded flex items-center justify-center",style:{backgroundColor:"#10b981"},children:t.jsx("span",{className:"text-xs",style:{color:"#ffffff"},children:"âœï¸"})}),"Edit Panel"]}),t.jsxs("button",{onClick:()=>{(e=>{const t=n.panels.find((t=>t.id===e));if(!t)return;const r={...t,id:`panel-${Date.now()}-${Math.random()}`,title:`${t.title} (Copy)`,order:n.panels.length,createdAt:new Date,updatedAt:new Date};i({type:"ADD_PANEL",payload:r}),a(r.id)})(c.panelId),d(null)},className:"w-full px-4 py-2 text-left context-menu-item flex items-center gap-2",style:{color:l.theme.colors.text.primary,transition:"background-color 0.15s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=`${l.theme.colors.primary[500]}20`},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[t.jsx(R,{className:"w-4 h-4",style:{color:l.theme.colors.primary[500]}}),"Duplicate Panel"]}),t.jsxs("button",{onClick:()=>{A(c.panelId,"up"),d(null)},className:"w-full px-4 py-2 text-left context-menu-item flex items-center gap-2",disabled:0===n.panels.findIndex((e=>e.id===c.panelId)),style:{color:l.theme.colors.text.primary,transition:"background-color 0.15s ease",opacity:0===n.panels.findIndex((e=>e.id===c.panelId))?.5:1},onMouseEnter:e=>{e.currentTarget.disabled||(e.currentTarget.style.backgroundColor=`${l.theme.colors.primary[500]}20`)},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[t.jsx(E,{className:"w-4 h-4",style:{color:l.theme.colors.primary[500]}}),"Move Up"]}),t.jsxs("button",{onClick:()=>{A(c.panelId,"down"),d(null)},className:"w-full px-4 py-2 text-left context-menu-item flex items-center gap-2",disabled:n.panels.findIndex((e=>e.id===c.panelId))===n.panels.length-1,style:{color:l.theme.colors.text.primary,transition:"background-color 0.15s ease",opacity:n.panels.findIndex((e=>e.id===c.panelId))===n.panels.length-1?.5:1},onMouseEnter:e=>{e.currentTarget.disabled||(e.currentTarget.style.backgroundColor=`${l.theme.colors.primary[500]}20`)},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[t.jsx(D,{className:"w-4 h-4",style:{color:l.theme.colors.primary[500]}}),"Move Down"]}),t.jsx("hr",{style:{margin:"4px 0",border:"none",height:"1px",backgroundColor:l.theme.colors.border.primary}}),t.jsxs("button",{onClick:()=>{S(c.panelId),d(null)},className:"w-full px-4 py-2 text-left context-menu-item flex items-center gap-2",style:{color:"#ef4444",transition:"background-color 0.15s ease"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor="#ef444420"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[t.jsx(P,{className:"w-4 h-4",style:{color:"#ef4444"}}),"Delete Panel"]})]})]})]})}function ot(){const{state:r}=We(),{state:a}=Je(),[s,o]=e.useState(!1),[n,i]=e.useState(0),[l,c]=e.useState(1),[d,m]=e.useState(!1),[p,h]=e.useState(1),[u,g]=e.useState(0),y=e.useRef(null),x=e.useRef(null),f=e.useRef(null),v=r.panels.reduce(((e,t)=>e+(t.duration||0)),0);e.useEffect((()=>(s?f.current=setInterval((()=>{g((e=>{var t;const a=e+.1*p;return a>=((null==(t=r.panels[n])?void 0:t.duration)||3)?n<r.panels.length-1?(i((e=>e+1)),0):(o(!1),i(0),0):a}))}),100):f.current&&clearInterval(f.current),()=>{f.current&&clearInterval(f.current)})),[s,n,p,r.panels]),e.useEffect((()=>{g(0)}),[n]);return 0===r.panels.length?t.jsxs("div",{className:"p-6 text-center text-secondary",children:[t.jsx(S,{className:"w-8 h-8 mx-auto mb-2"}),t.jsx("p",{children:"No panels to display in timeline"})]}):t.jsxs("div",{ref:x,className:"h-full flex flex-col bg-primary text-primary",children:[t.jsx("div",{className:"p-3 md:p-4 border-b border-primary",children:t.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-2 md:gap-0",children:[t.jsx("h3",{className:"font-semibold text-primary",children:"Timeline Preview"}),t.jsxs("div",{className:"flex flex-wrap items-center gap-2 md:space-x-4",children:[t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-secondary",children:[t.jsx(S,{className:"w-4 h-4"}),t.jsxs("span",{children:[v,"s total"]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsxs("select",{value:p,onChange:e=>{return t=Number(e.target.value),h(t),void(y.current&&(y.current.playbackRate=t));var t},className:"select-modern text-xs px-2 py-1",children:[t.jsx("option",{value:.5,children:"0.5x"}),t.jsx("option",{value:1,children:"1x"}),t.jsx("option",{value:1.5,children:"1.5x"}),t.jsx("option",{value:2,children:"2x"})]}),t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx(U,{className:"w-4 h-4 text-secondary"}),t.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:l,onChange:e=>{return t=Number(e.target.value),c(t),void(y.current&&(y.current.volume=t));var t},className:"w-16 h-1 bg-secondary rounded-lg appearance-none cursor-pointer"})]}),t.jsx("button",{onClick:()=>{var e,t;const a={project:(null==(e=r.currentProject)?void 0:e.title)||"Untitled",totalDuration:v,panels:r.panels.map(((e,t)=>({order:t+1,title:e.title,description:e.description,duration:e.duration,shotType:e.shotType,cameraAngle:e.cameraAngle,notes:e.notes,hasVideo:!!e.videoUrl,hasImage:!!e.imageUrl,videoPrompt:e.videoPrompt||e.aiGeneratedPrompt})))},s=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),o=URL.createObjectURL(s),n=document.createElement("a");n.href=o,n.download=`${(null==(t=r.currentProject)?void 0:t.title)||"storyboard"}-timeline.json`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(o)},className:"p-1 hover:bg-secondary rounded text-secondary hover:text-primary",title:"Export timeline",children:t.jsx(N,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>{!d&&x.current?(x.current.requestFullscreen(),m(!0)):document.fullscreenElement&&(document.exitFullscreen(),m(!1))},className:"p-1 hover:bg-secondary rounded text-secondary hover:text-primary",title:"Fullscreen",children:t.jsx(W,{className:"w-4 h-4"})})]})]})]})}),t.jsx("div",{className:"flex-1 flex items-center justify-center bg-black relative min-h-0",children:r.panels[n]&&t.jsxs(t.Fragment,{children:[r.panels[n].videoUrl?t.jsx("video",{ref:y,src:r.panels[n].videoUrl,className:"max-w-[60%] max-h-[60%] object-contain",controls:!1,muted:0===l,loop:!1,onEnded:()=>{n<r.panels.length-1?(i((e=>e+1)),g(0)):(o(!1),i(0),g(0))}}):r.panels[n].imageUrl?t.jsx("img",{src:r.panels[n].imageUrl,alt:r.panels[n].title,className:"max-w-[60%] max-h-[60%] object-contain rounded-lg shadow-lg"}):t.jsxs("div",{className:"text-center max-w-md mx-auto",children:[t.jsx(_,{className:"w-16 h-16 mx-auto mb-4",style:{color:a.theme.colors.text.secondary}}),t.jsx("h4",{className:"text-xl font-medium mb-2",style:{color:a.theme.colors.text.primary},children:r.panels[n].title}),t.jsx("p",{style:{color:a.theme.colors.text.secondary},children:r.panels[n].description}),t.jsxs("div",{className:"mt-4 flex justify-center space-x-4 text-sm",children:[t.jsx("span",{className:"px-2 py-1 rounded",style:{backgroundColor:a.theme.colors.background.tertiary,color:a.theme.colors.text.primary},children:r.panels[n].shotType.replace("-"," ")}),t.jsx("span",{className:"px-2 py-1 rounded",style:{backgroundColor:a.theme.colors.background.tertiary,color:a.theme.colors.text.primary},children:r.panels[n].cameraAngle.replace("-"," ")})]})]}),t.jsx("div",{className:"absolute top-4 left-4 rounded-lg p-3",style:{backgroundColor:`${a.theme.colors.background.primary}E6`,backdropFilter:"blur(8px)"},children:t.jsxs("div",{className:"text-sm",children:[t.jsxs("div",{className:"font-medium",style:{color:a.theme.colors.text.primary},children:["Panel ",n+1," of ",r.panels.length]}),t.jsxs("div",{style:{color:a.theme.colors.text.secondary,opacity:.8},children:[u.toFixed(1),"s / ",r.panels[n].duration,"s"]}),r.panels[n].videoUrl&&t.jsx("div",{className:"text-xs text-green-400 mt-1",children:"ðŸ“¹ Video"}),r.panels[n].imageUrl&&!r.panels[n].videoUrl&&t.jsx("div",{className:"text-xs text-blue-400 mt-1",children:"ðŸ–¼ï¸ Image"})]})}),t.jsx("div",{className:"absolute bottom-4 left-4 right-4",children:t.jsxs("div",{className:"rounded-lg p-2",style:{backgroundColor:`${a.theme.colors.background.primary}CC`,backdropFilter:"blur(8px)"},children:[t.jsxs("div",{className:"flex items-center justify-between text-xs mb-1",style:{color:a.theme.colors.text.primary,opacity:.9},children:[t.jsx("span",{children:r.panels[n].title}),t.jsxs("span",{children:[p,"x"]})]}),t.jsx("div",{className:"w-full rounded-full h-1",style:{backgroundColor:a.theme.colors.background.tertiary},children:t.jsx("div",{className:"bg-primary-500 h-1 rounded-full transition-all duration-100",style:{width:u/(r.panels[n].duration||1)*100+"%"}})})]})})]})}),t.jsxs("div",{className:"p-4 border-t",style:{borderColor:a.theme.colors.border.primary},children:[t.jsxs("div",{className:"flex items-center justify-center space-x-4 mb-4",children:[t.jsx("button",{onClick:()=>{i(Math.max(0,n-1)),o(!1)},disabled:0===n,className:"p-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",style:{backgroundColor:a.theme.colors.background.tertiary,color:a.theme.colors.text.primary},onMouseOver:e=>{e.currentTarget.disabled||(e.currentTarget.style.backgroundColor=a.theme.colors.background.secondary)},onMouseOut:e=>{e.currentTarget.disabled||(e.currentTarget.style.backgroundColor=a.theme.colors.background.tertiary)},children:t.jsx(B,{className:"w-5 h-5"})}),t.jsx("button",{onClick:()=>{o(!s),y.current&&(s?y.current.pause():y.current.play())},className:"p-3 rounded-lg",style:{backgroundColor:a.theme.colors.primary[600],color:a.theme.colors.text.primary},onMouseOver:e=>{e.currentTarget.style.backgroundColor=a.theme.colors.primary[700]},onMouseOut:e=>{e.currentTarget.style.backgroundColor=a.theme.colors.primary[600]},children:s?t.jsx(H,{className:"w-6 h-6"}):t.jsx(b,{className:"w-6 h-6"})}),t.jsx("button",{onClick:()=>{i(Math.min(r.panels.length-1,n+1)),o(!1)},disabled:n===r.panels.length-1,className:"p-2 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed transition-colors",style:{backgroundColor:a.theme.colors.background.tertiary,color:a.theme.colors.text.primary},onMouseOver:e=>{e.currentTarget.disabled||(e.currentTarget.style.backgroundColor=a.theme.colors.background.secondary)},onMouseOut:e=>{e.currentTarget.disabled||(e.currentTarget.style.backgroundColor=a.theme.colors.background.tertiary)},children:t.jsx(G,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-xs",style:{color:a.theme.colors.text.secondary},children:[t.jsx("span",{children:"0s"}),t.jsxs("span",{children:[v,"s"]})]}),t.jsx("div",{className:"relative h-2 rounded-full",style:{backgroundColor:a.theme.colors.background.tertiary},children:t.jsx("div",{className:"absolute top-0 left-0 h-full bg-primary-600 rounded-full transition-all duration-300",style:{width:(n+1)/r.panels.length*100+"%"}})}),t.jsx("div",{className:"flex justify-between",children:r.panels.map(((e,r)=>t.jsx("button",{onClick:()=>{i(r),o(!1)},className:"text-xs px-2 py-1 rounded transition-colors",style:{backgroundColor:r===n?a.theme.colors.primary[600]:a.theme.colors.background.tertiary,color:r===n?a.theme.colors.text.primary:a.theme.colors.text.secondary},onMouseOver:e=>{r!==n&&(e.currentTarget.style.backgroundColor=a.theme.colors.background.secondary)},onMouseOut:e=>{r!==n&&(e.currentTarget.style.backgroundColor=a.theme.colors.background.tertiary)},children:r+1},e.id)))})]})]})]})}var nt=Object.defineProperty,it=(e,t,r)=>((e,t,r)=>t in e?nt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);const lt=class e{constructor(){it(this,"activeWindows",new Map),it(this,"maxZIndex",9e3)}static getInstance(){return e.instance||(e.instance=new e),e.instance}registerWindow(e,t=9e3,r="",a){const s=Math.max(t,this.maxZIndex+1);return this.activeWindows.set(e,{zIndex:s,isActive:!1,title:r,isOpen:!0,restoreCallback:a}),this.maxZIndex=Math.max(this.maxZIndex,s),s}bringToFront(e){const t=this.activeWindows.get(e);if(!t)return 9e3;this.activeWindows.forEach(((t,r)=>{r!==e&&(t.isActive=!1)}));const r=this.maxZIndex+1;return t.zIndex=r,t.isActive=!0,this.maxZIndex=r,r}unregisterWindow(e){this.activeWindows.delete(e)}getZIndex(e){const t=this.activeWindows.get(e);return(null==t?void 0:t.zIndex)||9e3}isActive(e){const t=this.activeWindows.get(e);return(null==t?void 0:t.isActive)||!1}getSubWindowZIndex(e){const t=this.activeWindows.get(e);return((null==t?void 0:t.zIndex)||9e3)+100}setWindowState(e,t){const r=this.activeWindows.get(e);r&&(r.isOpen=t)}getAllWindows(){return Array.from(this.activeWindows.entries())}restoreWindow(e){const t=this.activeWindows.get(e);if(null==t?void 0:t.restoreCallback)try{return t.restoreCallback(),t.isOpen=!0,!0}catch(r){return console.error("Error restoring window:",e,r),!1}return!1}updateWindowTitle(e,t){const r=this.activeWindows.get(e);r&&(r.title=t)}reset(){this.activeWindows.clear(),this.maxZIndex=9e3}};it(lt,"instance");let ct=lt;const dt={getFontSize:e=>e<300?"10px":e<350?"11px":e<400?"12px":e<480?"13px":e<600?"14px":e<768?"15px":e<1024?"16px":"17px",getLineHeight:e=>e<300?"1.1":e<400?"1.2":e<500?"1.3":e<650?"1.4":e<800?"1.45":"1.5",getPadding:e=>e<300?"0.25rem":e<400?"0.375rem":e<500?"0.5rem":e<650?"0.625rem":e<800?"0.75rem":"1rem",getGridColumns:e=>e<350?1:e<500||e<650?2:e<800||e<1e3?3:e<1200?4:5,getContentMaxWidth:e=>e<400?"100%":e<600?"95%":e<800?"90%":e<1e3?"85%":"80%",getSpacing(e){const t=e<400?.5:e<600?.75:e<800?.85:e<1e3?1:1.15;return{xs:.25*t+"rem",sm:.5*t+"rem",md:1*t+"rem",lg:1.5*t+"rem",xl:2*t+"rem"}},getIconSize:e=>e<350?14:e<500?16:e<650?18:e<800?20:e<1e3?22:24,getButtonScale:e=>e<350?"0.75":e<500?"0.85":e<650?"0.95":"1",getOptimalWindowSize(e,t){const r=window.innerWidth,a=window.innerHeight,s=(window.devicePixelRatio||1)>1.5?1.1:1;let o,n;r<=768?(o=.98,n=.95):r<=1024?(o=.95,n=.9):r<=1366?(o=.9,n=.85):r<=1920?(o=.85,n=.8):(o=.75,n=.75);const i=Math.floor(r*o*s),l=Math.floor(a*n*s),c=Math.min(320,.5*r),d=Math.min(240,.4*a);return{width:Math.max(c,Math.min(e,i)),height:Math.max(d,Math.min(t,l))}},getDisplayScale(){const e=window.devicePixelRatio||1;return e>=3?1.2:e>=2?1.1:1},getOptimalLayout(e,t){const r=this.getGridColumns(e),a=Math.min(r,Math.ceil(Math.sqrt(t))),s=this.getSpacing(e);return{columns:a,itemWidth:`calc((100% - ${s.md} * ${a-1}) / ${a})`,gap:s.md}}};var mt=Object.defineProperty,pt=(e,t,r)=>((e,t,r)=>t in e?mt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);const ht=class e{constructor(){pt(this,"minimizedWindows",new Map),pt(this,"listeners",new Set)}static getInstance(){return e.instance||(e.instance=new e),e.instance}addMinimizedWindow(e,t,r,a){const s=this.getNextMinimizedPosition();this.minimizedWindows.set(e,{position:s,title:t,icon:r,restoreCallback:a}),this.notifyListeners()}restoreMinimizedWindow(e){console.log("MinimizedWindowManager: Trying to restore window:",e);const t=this.minimizedWindows.get(e);return(null==t?void 0:t.restoreCallback)?(console.log("MinimizedWindowManager: Found restore callback for window:",e),t.restoreCallback(),this.removeMinimizedWindow(e),!0):(console.log("MinimizedWindowManager: No restore callback found for window:",e),!1)}removeMinimizedWindow(e){this.minimizedWindows.delete(e),this.notifyListeners()}updateMinimizedPosition(e,t){const r=this.minimizedWindows.get(e);r&&(r.position=t,this.notifyListeners())}getMinimizedWindow(e){return this.minimizedWindows.get(e)}getAllMinimizedWindows(){return Array.from(this.minimizedWindows.entries())}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}notifyListeners(){this.listeners.forEach((e=>e()))}getNextMinimizedPosition(){const e=Array.from(this.minimizedWindows.values()).map((e=>e.position)),t=200,r=window.innerHeight-60-20;for(let a=0;a<12;a++){const s=20+212*a,o=r;if(s+t<window.innerWidth-20){if(!e.some((e=>Math.abs(e.x-s)<t&&Math.abs(e.y-o)<60)))return{x:s,y:o}}}for(let a=1;a<3;a++)for(let s=0;s<12;s++){const o=20+212*s,n=r-72*a;if(o+t<window.innerWidth-20&&n>100){if(!e.some((e=>Math.abs(e.x-o)<t&&Math.abs(e.y-n)<60)))return{x:o,y:n}}}return{x:Math.max(20,(window.innerWidth-t)/2),y:r}}};pt(ht,"instance");let ut=ht;function gt({windowId:r,title:a,icon:s,position:o,onRestore:i,onClose:l,themeState:c}){const d=_e(c.theme),[m,p]=e.useState(!1),[h,u]=e.useState(!1),[g,y]=e.useState({x:0,y:0}),[x,f]=e.useState(o),[b,v]=e.useState(!1),[w,j]=e.useState(0),N=e.useRef(null),k=e.useRef(null),C=async()=>{if(!b){console.log("MinimizedWindowBubble: Starting restore for window:",r,a),v(!0);try{await i(),console.log("MinimizedWindowBubble: Restore completed for window:",r)}catch(e){console.error("MinimizedWindowBubble: Error restoring window:",r,e)}finally{setTimeout((()=>v(!1)),500)}}};return e.useEffect((()=>{const e=e=>{if(!m)return;e.preventDefault();const t=e.clientX-g.x,a=e.clientY-g.y,s=Math.max(10,Math.min(window.innerWidth-200-10,t)),o=Math.max(10,Math.min(window.innerHeight-60-10,a));f({x:s,y:o}),ut.getInstance().updateMinimizedPosition(r,{x:s,y:o})},t=()=>{p(!1),k.current&&(clearTimeout(k.current),k.current=null)};return m&&(document.addEventListener("mousemove",e,{passive:!1}),document.addEventListener("mouseup",t,{passive:!0}),document.body.style.userSelect="none",document.body.style.cursor="grabbing"),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",t),document.body.style.userSelect="",document.body.style.cursor="",k.current&&clearTimeout(k.current)}}),[m,g,r]),e.useEffect((()=>()=>{k.current&&clearTimeout(k.current)}),[]),t.jsx("div",{ref:N,className:"fixed transition-all duration-300 ease-out transform-gpu group "+(b?"z-[10001] scale-110":m?"z-[10001] scale-105 rotate-1":"z-[9000] hover:scale-105 hover:-translate-y-1"),style:{left:x.x,top:x.y,width:"200px",height:"60px",cursor:m?"grabbing":"pointer",willChange:m?"transform, left, top":"auto"},onMouseDown:e=>{var t;if(0!==e.button)return;e.preventDefault();const r=Date.now();j(r);const a=null==(t=N.current)?void 0:t.getBoundingClientRect();a&&y({x:e.clientX-a.left,y:e.clientY-a.top}),k.current=setTimeout((()=>{p(!0)}),300)},onMouseUp:e=>{e.preventDefault(),e.stopPropagation(),k.current&&(clearTimeout(k.current),k.current=null);Date.now()-w<300&&!m&&C(),p(!1)},onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),title:b?`Restoring ${a}...`:`Click to restore ${a}`,children:t.jsx("div",{className:"w-full h-full rounded-xl border backdrop-blur-md transition-all duration-300 overflow-hidden",style:{backgroundColor:m?c.theme.colors.background.secondary:c.theme.colors.background.primary,borderColor:m||h?c.theme.colors.primary[500]:c.theme.colors.border.primary,boxShadow:m?`0 12px 24px rgba(0,0,0,0.15), 0 0 0 2px ${c.theme.colors.primary[500]}40`:h?"0 8px 16px rgba(0,0,0,0.1), 0 2px 4px rgba(0,0,0,0.06)":"0 4px 8px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.04)",filter:m?"brightness(1.05)":"brightness(1)"},children:t.jsxs("div",{className:"flex items-center h-full px-3 py-2 relative",children:[t.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center mr-3 transition-all duration-200",style:{backgroundColor:`${c.theme.colors.primary[500]}15`,border:`1px solid ${c.theme.colors.primary[300]}30`},children:s?t.jsx("div",{className:"text-lg transition-transform duration-200 group-hover:scale-110",style:{color:c.theme.colors.primary[600]},children:s}):t.jsx("div",{className:"text-xs font-bold transition-transform duration-200 group-hover:scale-110",style:{color:c.theme.colors.primary[600]},children:a.substring(0,2).toUpperCase()})}),t.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[t.jsx("h4",{className:"text-sm font-semibold truncate transition-colors duration-200",style:{color:c.theme.colors.text.primary},children:a}),t.jsx("p",{className:"text-xs truncate mt-0.5 transition-colors duration-200",style:{color:c.theme.colors.text.secondary},children:b?"Restoring...":"Click to restore"})]}),t.jsxs("div",{className:"flex-shrink-0 flex items-center space-x-1",children:[t.jsx("button",{onClick:e=>{e.stopPropagation(),C()},disabled:b,className:"w-6 h-6 rounded-md flex items-center justify-center transition-all duration-200 hover:scale-110 disabled:opacity-50",style:{backgroundColor:h?`${c.theme.colors.primary[500]}20`:"transparent",color:c.theme.colors.primary[600]},title:"Restore window",children:b?t.jsx("div",{className:"w-3 h-3 border border-current border-t-transparent rounded-full animate-spin"}):t.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),t.jsx("button",{onClick:e=>{e.stopPropagation(),l()},className:"w-6 h-6 rounded-md flex items-center justify-center transition-all duration-200 hover:scale-110 opacity-0 group-hover:opacity-100",style:{backgroundColor:h?d.status.error.light:"transparent",color:d.status.error.background},title:"Close window",children:t.jsx(n,{className:"w-3 h-3"})})]}),t.jsx("div",{className:"absolute -top-1 -right-1 w-3 h-3 rounded-full transition-all duration-300",style:{backgroundColor:c.theme.colors.primary[500],boxShadow:`0 0 6px ${c.theme.colors.primary[500]}60`,animation:b?"pulse 1s ease-in-out infinite":"none"}}),t.jsx("div",{className:"absolute inset-0 rounded-xl pointer-events-none transition-opacity duration-300",style:{background:`linear-gradient(135deg, ${c.theme.colors.primary[500]}08, ${c.theme.colors.primary[600]}12)`,opacity:h?1:0}})]})})})}function yt({isOpen:a,onClose:s,onMinimize:o,title:i,subtitle:l,icon:c,children:d,className:m="",defaultWidth:p="520px",defaultHeight:h="380px",minWidth:u=300,minHeight:g=220,maxWidth:y="95vw",maxHeight:x="95vh",resizable:f=!0,minimizable:b=!0,maximizable:v=!0,windowId:w=Math.random().toString(36).substr(2,9),zIndex:j=9e3,usePortal:N=!0}){const k=e.useRef(null),C=e.useRef(null),{state:A}=Je(),S=_e(A.theme),[P,I]=e.useState(!1),[T,E]=e.useState([]),[D,$]=e.useState(j),[M,L]=e.useState((()=>{const e=parseInt(p.replace(/[^0-9]/g,"")),t=parseInt(h.replace(/[^0-9]/g,""));return{isMaximized:!1,isMinimized:!1,position:{x:0,y:0},size:dt.getOptimalWindowSize(e,t),isDragging:!1,isResizing:!1,resizeDirection:void 0,dragOffset:{x:0,y:0},previousState:void 0}})),O=e.useCallback((()=>{console.log("WindowFrame: Starting restore for window:",w,i);ut.getInstance().removeMinimizedWindow(w),L((e=>({...e,isMinimized:!1,position:0===e.position.x&&0===e.position.y?{x:100,y:100}:e.position}))),setTimeout((()=>{const e=ct.getInstance().bringToFront(w);$(e),console.log("WindowFrame: Restore completed for window:",w,"new zIndex:",e)}),100)}),[w,i]);e.useEffect((()=>{const e=ct.getInstance(),t=e.registerWindow(w,j,i,O);return $(t),e.setWindowState(w,a),()=>{e.unregisterWindow(w)}}),[w,j,i,a,O]),e.useEffect((()=>{const e=ut.getInstance(),t=()=>{E(e.getAllMinimizedWindows())};return e.addListener(t),t(),()=>{e.removeListener(t)}}),[]),e.useEffect((()=>{const e=()=>{const e=window.innerWidth<768;if(I(e),e&&!M.isMinimized)L((e=>({...e,size:{width:window.innerWidth,height:window.innerHeight},position:{x:0,y:0},isMaximized:!0})));else if(!e&&!M.isMinimized&&!M.isMaximized){const e=M.size.width,t=M.size.height,r=dt.getOptimalWindowSize(e,t);e===r.width&&t===r.height||L((e=>({...e,size:r,position:{x:Math.max(0,(window.innerWidth-r.width)/2),y:Math.max(0,(window.innerHeight-r.height)/2)}})))}};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[M.isMinimized,M.isMaximized]),e.useEffect((()=>{if(a&&!M.isMaximized&&!M.previousState&&!M.isMinimized){const e=window.innerWidth,t=window.innerHeight,r=M.size.width,a=M.size.height,s=document.querySelectorAll(".window-frame");let o=0,n=0;s.length>1&&(o=30*(s.length-1),n=30*(s.length-1));const i=Math.max(20,Math.min((e-r)/2+o,e-r-20)),l=Math.max(40,Math.min((t-a)/2+n,t-a-20));L((e=>({...e,position:{x:i,y:l}})))}}),[a,M.isMaximized,M.previousState,M.isMinimized]),e.useEffect((()=>{var e;let t=null;const r=e=>{var r;if(M.isDragging&&!M.isMaximized&&!P&&M.dragOffset&&(e.preventDefault(),t&&cancelAnimationFrame(t),t=requestAnimationFrame((()=>{const t=e.clientX-M.dragOffset.x,r=e.clientY-M.dragOffset.y,a=M.size.width,s=M.size.height;let o=Math.max(-a/3,Math.min(window.innerWidth-a/3,t)),n=Math.max(0,Math.min(window.innerHeight-s,r));o<15&&(o=0),o>window.innerWidth-a-15&&(o=window.innerWidth-a),n<15&&(n=0),L((e=>({...e,position:{x:o,y:n}})))}))),M.isResizing&&M.resizeDirection&&!M.isMaximized){e.preventDefault();const a=null==(r=k.current)?void 0:r.getBoundingClientRect();if(!a)return;t&&cancelAnimationFrame(t),t=requestAnimationFrame((()=>{let t=M.size.width,r=M.size.height,s=M.position.x,o=M.position.y;const n=M.resizeDirection,i=Math.max(u,300),l=Math.max(g,220),c=Math.min(.95*window.innerWidth,parseInt((null==y?void 0:y.replace("vw",""))||"100")*window.innerWidth/100),d=Math.min(.95*window.innerHeight,parseInt((null==x?void 0:x.replace("vh",""))||"100")*window.innerHeight/100);if(n.includes("right")&&(t=Math.max(i,Math.min(c,e.clientX-a.left))),n.includes("bottom")&&(r=Math.max(l,Math.min(d,e.clientY-a.top))),n.includes("left")){const r=a.left-e.clientX;t=Math.max(i,Math.min(c,a.width+r)),s=Math.max(0,a.left-(t-a.width))}if(n.includes("top")){const t=a.top-e.clientY;r=Math.max(l,Math.min(d,a.height+t)),o=Math.max(0,a.top-(r-a.height))}s+t>window.innerWidth&&(s=Math.max(0,window.innerWidth-t)),o+r>window.innerHeight&&(o=Math.max(0,window.innerHeight-r)),L((e=>({...e,size:{width:t,height:r},position:{x:s,y:o}})))}))}},a=()=>{t&&(cancelAnimationFrame(t),t=null),L((e=>({...e,isDragging:!1,isResizing:!1,resizeDirection:void 0,dragOffset:{x:0,y:0}})))};return(M.isDragging||M.isResizing)&&(document.addEventListener("mousemove",r,{passive:!1}),document.addEventListener("mouseup",a,{passive:!0}),document.body.style.userSelect="none",document.body.style.cursor=M.isResizing?`${null==(e=M.resizeDirection)?void 0:e.replace("-","")}-resize`:"grabbing"),()=>{t&&cancelAnimationFrame(t),document.removeEventListener("mousemove",r),document.removeEventListener("mouseup",a),document.body.style.userSelect="",document.body.style.cursor=""}}),[M.isDragging,M.isResizing,M.isMaximized,M.dragOffset,M.resizeDirection,M.size,u,g,y,x,P]);const F=e=>{var t;if(M.isMaximized||M.isMinimized)return;e.preventDefault();const r=null==(t=C.current)?void 0:t.getBoundingClientRect();if(!r)return;let a,s;"touches"in e?(a=e.touches[0].clientX,s=e.touches[0].clientY):(a=e.clientX,s=e.clientY),L((e=>({...e,isDragging:!0,dragOffset:{x:a-r.left,y:s-r.top}})))},z=e=>t=>{M.isMaximized||M.isMinimized||(t.preventDefault(),t.stopPropagation(),L((t=>({...t,isResizing:!0,resizeDirection:e}))))},R=()=>{if(o)o();else{ut.getInstance().addMinimizedWindow(w,i,c,O),L((e=>({...e,isMinimized:!0})))}},U=()=>{ut.getInstance().removeMinimizedWindow(w),k.current?(k.current.style.transition="transform 0.2s ease-out, opacity 0.2s ease-out",k.current.style.transform="scale(0.95) translateY(-10px)",k.current.style.opacity="0",setTimeout((()=>{s()}),200)):s()};if(!a)return null;const W=T.filter((([e])=>e!==w)).map((([e,r])=>t.jsx(gt,{windowId:e,title:r.title,icon:r.icon,position:r.position,onRestore:()=>{if(!ut.getInstance().restoreMinimizedWindow(e)){ct.getInstance().restoreWindow(e)||console.warn("Could not restore window:",e,"No restore callback registered in either manager")}},onClose:()=>{ut.getInstance().removeMinimizedWindow(e)},themeState:A},e)));if(M.isMinimized){const e=ut.getInstance().getMinimizedWindow(w);if(e){const a=t.jsxs(t.Fragment,{children:[W,t.jsx(gt,{windowId:w,title:i,icon:c,position:e.position,onRestore:O,onClose:U,themeState:A})]});return N?r.createPortal(a,document.body):a}}if(P){const e=t.jsxs(t.Fragment,{children:[W,t.jsxs("div",{className:"fixed inset-0 z-[9999] flex flex-col safe-area-mobile bg-primary",style:{backgroundColor:A.theme.colors.background.primary},children:[t.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 border-b safe-top-mobile bg-secondary",style:{backgroundColor:A.theme.colors.background.secondary,borderColor:A.theme.colors.border.primary},children:[t.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 flex-1 min-w-0",children:[c&&t.jsx("div",{className:"flex-shrink-0",style:{color:A.theme.colors.text.primary},children:c}),t.jsxs("div",{className:"min-w-0 flex-1",children:[t.jsx("h3",{className:"font-semibold text-sm sm:text-base text-primary-theme truncate",children:i}),l&&t.jsx("p",{className:"text-xs sm:text-sm text-secondary-theme truncate",children:l})]})]}),t.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2 flex-shrink-0",children:[b&&t.jsx("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),R()},onTouchStart:e=>{e.stopPropagation()},className:"p-2 hover:bg-tertiary rounded-lg transition-colors touch-manipulation",title:"Minimize",children:t.jsx(q,{className:"w-4 h-4 sm:w-5 sm:h-5 text-secondary-theme"})}),t.jsx("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),U()},onTouchStart:e=>{e.stopPropagation()},className:"p-2 hover:bg-red-100 hover:text-red-600 rounded-lg transition-colors touch-manipulation",title:"Close",children:t.jsx(n,{className:"w-4 h-4 sm:w-5 sm:h-5 text-secondary-theme"})})]})]}),t.jsx("div",{className:"flex-1 overflow-hidden safe-bottom-mobile bg-primary",style:{backgroundColor:A.theme.colors.background.primary},children:t.jsx("div",{className:"h-full overflow-y-auto",style:{fontSize:dt.getFontSize(window.innerWidth),lineHeight:dt.getLineHeight(window.innerWidth),padding:dt.getPadding(window.innerWidth)},children:d})})]})]});return N?r.createPortal(e,document.body):e}const _={left:M.isMaximized?0:Math.max(0,Math.min(window.innerWidth-320,M.position.x)),top:M.isMaximized?0:Math.max(0,Math.min(window.innerHeight-240,M.position.y)),width:M.isMaximized?"100vw":Math.min(.95*window.innerWidth,M.size.width),height:M.isMaximized?"100vh":Math.min(.95*window.innerHeight,M.size.height),zIndex:M.isDragging||M.isResizing?1e4:D,transform:M.isDragging?"scale(1.01) translateZ(0)":"scale(1) translateZ(0)",transition:M.isDragging||M.isResizing?"none":"transform 0.15s ease-out, box-shadow 0.15s ease-out",willChange:M.isDragging||M.isResizing?"transform, left, top, width, height":"auto",backfaceVisibility:"hidden"},B=t.jsxs(t.Fragment,{children:[W,t.jsxs("div",{ref:k,className:`window-frame fixed rounded-xl shadow-2xl overflow-hidden border-2 transform-gpu ${M.isDragging?"dragging":""} ${M.isResizing?"resizing":""} ${m}`,style:{..._,backgroundColor:A.theme.colors.background.primary,borderColor:M.isDragging||M.isResizing?A.theme.colors.primary[500]:A.theme.colors.border.primary,boxShadow:M.isDragging||M.isResizing?`${S.shadows.xl}, 0 0 0 3px ${A.theme.colors.primary[500]}30`:S.shadows.lg},onClick:()=>{const e=ct.getInstance().bringToFront(w);$(e)},children:[t.jsxs("div",{ref:C,className:"flex items-center justify-between px-3 sm:px-4 py-2 sm:py-3 border-b glass-effect",style:{backgroundColor:A.theme.colors.background.secondary,borderColor:A.theme.colors.border.primary,backdropFilter:"blur(20px)"},children:[t.jsxs("div",{className:"flex items-center space-x-1.5 sm:space-x-2",children:[t.jsx("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),U()},onMouseDown:e=>{e.stopPropagation(),e.preventDefault()},className:"rounded-full transition-all duration-200 hover:scale-110 shadow-sm",style:{width:"10px",height:"10px",backgroundColor:S.window.controls.close.background},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=S.window.controls.close.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=S.window.controls.close.background},title:"Close"}),b&&t.jsx("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),R()},onMouseDown:e=>{e.stopPropagation(),e.preventDefault()},className:"rounded-full transition-all duration-200 hover:scale-110 shadow-sm",style:{width:"10px",height:"10px",backgroundColor:S.window.controls.minimize.background},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=S.window.controls.minimize.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=S.window.controls.minimize.background},title:"Minimize"}),v&&t.jsx("button",{onClick:e=>{e.stopPropagation(),e.preventDefault(),L((e=>{var t,r;return e.isMaximized?{...e,isMaximized:!1,position:(null==(t=e.previousState)?void 0:t.position)||{x:100,y:100},size:(null==(r=e.previousState)?void 0:r.size)||{width:parseInt(p.replace("px","")),height:parseInt(h.replace("px",""))},previousState:void 0}:{...e,isMaximized:!0,previousState:{position:e.position,size:e.size}}}))},onMouseDown:e=>{e.stopPropagation(),e.preventDefault()},className:"rounded-full transition-all duration-200 hover:scale-110 shadow-sm",style:{width:"10px",height:"10px",backgroundColor:S.window.controls.maximize.background},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=S.window.controls.maximize.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=S.window.controls.maximize.background},title:M.isMaximized?"Restore":"Maximize"})]}),t.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 flex-1 justify-center min-w-0 "+(M.isDragging?"cursor-grabbing":"cursor-grab"),onMouseDown:F,onTouchStart:F,children:[c&&t.jsx("div",{className:"flex-shrink-0",style:{color:A.theme.colors.text.primary,fontSize:`${dt.getIconSize(M.size.width)}px`},children:c}),t.jsxs("div",{className:"text-center min-w-0",children:[t.jsx("h3",{className:"font-semibold text-xs sm:text-sm truncate",style:{color:A.theme.colors.text.primary},children:i}),l&&t.jsx("p",{className:"text-xs truncate",style:{color:A.theme.colors.text.secondary},children:l})]})]}),t.jsx("div",{className:"flex items-center space-x-1 text-xs flex-shrink-0 pointer-events-none",style:{color:A.theme.colors.text.tertiary},children:M.isMaximized?t.jsx(q,{className:"w-3 h-3 sm:w-4 sm:h-4"}):t.jsx(V,{className:"w-3 h-3 sm:w-4 sm:h-4"})})]}),t.jsx("div",{className:"flex-1 overflow-hidden relative w-full",style:{backgroundColor:A.theme.colors.background.primary,height:`calc(100% - ${M.size.height<400?"44px":"54px"})`},children:t.jsx("div",{className:"w-full h-full overflow-y-auto scrollable",style:{fontSize:dt.getFontSize(M.size.width),lineHeight:dt.getLineHeight(M.size.width)},children:d})}),f&&!M.isMaximized&&!P&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"absolute top-0 left-0 w-3 h-3 cursor-nw-resize transition-colors duration-200 opacity-0 hover:opacity-50 rounded-br-lg",style:{backgroundColor:"transparent"},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=A.theme.colors.primary[300]},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},onMouseDown:z("top-left")}),t.jsx("div",{className:"absolute top-0 right-0 w-3 h-3 cursor-ne-resize hover:bg-primary-300 transition-colors duration-200 opacity-0 hover:opacity-50 rounded-bl-lg",onMouseDown:z("top-right")}),t.jsx("div",{className:"absolute bottom-0 left-0 w-3 h-3 cursor-sw-resize hover:bg-primary-300 transition-colors duration-200 opacity-0 hover:opacity-50 rounded-tr-lg",onMouseDown:z("bottom-left")}),t.jsx("div",{className:"absolute bottom-0 right-0 w-3 h-3 cursor-se-resize hover:bg-primary-300 transition-colors duration-200 opacity-0 hover:opacity-50 rounded-tl-lg",onMouseDown:z("bottom-right")}),t.jsx("div",{className:"absolute top-0 left-3 right-3 h-1 cursor-n-resize hover:bg-primary-200 transition-colors duration-200 opacity-0 hover:opacity-30",onMouseDown:z("top")}),t.jsx("div",{className:"absolute bottom-0 left-3 right-3 h-1 cursor-s-resize hover:bg-primary-200 transition-colors duration-200 opacity-0 hover:opacity-30",onMouseDown:z("bottom")}),t.jsx("div",{className:"absolute left-0 top-3 bottom-3 w-1 cursor-w-resize hover:bg-primary-200 transition-colors duration-200 opacity-0 hover:opacity-30",onMouseDown:z("left")}),t.jsx("div",{className:"absolute right-0 top-3 bottom-3 w-1 cursor-e-resize hover:bg-primary-200 transition-colors duration-200 opacity-0 hover:opacity-30",onMouseDown:z("right")})]})]})]});return N?r.createPortal(B,document.body):B}const xt={style:"photorealistic",quality:"standard",aspectRatio:"16:9",size:"1024x1024",model:"dall-e-3",creativity:7,artStyle:"cinematic",lighting:"natural",mood:"neutral",colorScheme:"full-color"};function ft({isOpen:r,onClose:a,onSave:s,currentSettings:o}){const[n,i]=e.useState(o||xt);e.useEffect((()=>{i(o||xt)}),[o,r]);const l=(e,t)=>{i((r=>({...r,[e]:t})))};return r?t.jsxs(yt,{isOpen:r,onClose:a,title:"AI Image Generation Settings",subtitle:"Customize AI image creation parameters",icon:t.jsx(g,{className:"w-5 h-5"}),defaultWidth:"600px",defaultHeight:"700px",minWidth:500,minHeight:600,maxWidth:"800px",maxHeight:"900px",resizable:!0,minimizable:!0,maximizable:!0,windowId:"ai-image-settings",zIndex:9500,children:[t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-primary",children:"AI Model"}),t.jsx("select",{value:n.model,onChange:e=>l("model",e.target.value),className:"select-modern w-full",children:t.jsx("option",{value:"dall-e-3",children:"DALL-E 3"})}),t.jsx("p",{className:"text-xs text-secondary",children:"DALL-E 3 provides the highest quality images and best prompt adherence (DALL-E 2 has been discontinued)"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-primary",children:"Image Style"}),t.jsxs("select",{value:n.style,onChange:e=>l("style",e.target.value),className:"select-modern w-full",children:[t.jsx("option",{value:"photorealistic",children:"Photorealistic"}),t.jsx("option",{value:"illustration",children:"Illustration"}),t.jsx("option",{value:"cartoon",children:"Cartoon"}),t.jsx("option",{value:"sketch",children:"Sketch"}),t.jsx("option",{value:"artistic",children:"Artistic"}),t.jsx("option",{value:"comic",children:"Comic Book"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-primary",children:"Art Style"}),t.jsxs("select",{value:n.artStyle,onChange:e=>l("artStyle",e.target.value),className:"select-modern w-full",children:[t.jsx("option",{value:"cinematic",children:"Cinematic"}),t.jsx("option",{value:"dramatic",children:"Dramatic"}),t.jsx("option",{value:"minimalist",children:"Minimalist"}),t.jsx("option",{value:"vintage",children:"Vintage"}),t.jsx("option",{value:"modern",children:"Modern"}),t.jsx("option",{value:"fantasy",children:"Fantasy"}),t.jsx("option",{value:"noir",children:"Film Noir"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-primary",children:"Quality"}),t.jsxs("select",{value:n.quality,onChange:e=>l("quality",e.target.value),className:"select-modern w-full",children:[t.jsx("option",{value:"standard",children:"Standard"}),t.jsx("option",{value:"hd",children:"HD (Higher Quality)"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-primary",children:"Size"}),t.jsxs("select",{value:n.size,onChange:e=>l("size",e.target.value),className:"select-modern w-full",children:[t.jsx("option",{value:"1024x1024",children:"Square (1024x1024)"}),t.jsx("option",{value:"1792x1024",children:"Landscape (1792x1024)"}),t.jsx("option",{value:"1024x1792",children:"Portrait (1024x1792)"})]})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-primary",children:"Lighting"}),t.jsxs("select",{value:n.lighting,onChange:e=>l("lighting",e.target.value),className:"select-modern w-full",children:[t.jsx("option",{value:"natural",children:"Natural"}),t.jsx("option",{value:"dramatic",children:"Dramatic"}),t.jsx("option",{value:"soft",children:"Soft"}),t.jsx("option",{value:"golden-hour",children:"Golden Hour"}),t.jsx("option",{value:"moody",children:"Moody"}),t.jsx("option",{value:"bright",children:"Bright"}),t.jsx("option",{value:"low-light",children:"Low Light"})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-primary",children:"Mood"}),t.jsxs("select",{value:n.mood,onChange:e=>l("mood",e.target.value),className:"select-modern w-full",children:[t.jsx("option",{value:"neutral",children:"Neutral"}),t.jsx("option",{value:"happy",children:"Happy"}),t.jsx("option",{value:"dramatic",children:"Dramatic"}),t.jsx("option",{value:"mysterious",children:"Mysterious"}),t.jsx("option",{value:"peaceful",children:"Peaceful"}),t.jsx("option",{value:"energetic",children:"Energetic"}),t.jsx("option",{value:"melancholic",children:"Melancholic"})]})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("label",{className:"block text-sm font-medium text-primary",children:"Color Scheme"}),t.jsxs("select",{value:n.colorScheme,onChange:e=>l("colorScheme",e.target.value),className:"select-modern w-full",children:[t.jsx("option",{value:"full-color",children:"Full Color"}),t.jsx("option",{value:"monochrome",children:"Monochrome"}),t.jsx("option",{value:"warm-tones",children:"Warm Tones"}),t.jsx("option",{value:"cool-tones",children:"Cool Tones"}),t.jsx("option",{value:"sepia",children:"Sepia"}),t.jsx("option",{value:"high-contrast",children:"High Contrast"})]})]}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("label",{className:"block text-sm font-medium text-primary",children:["Creativity Level: ",n.creativity,"/10"]}),t.jsx("input",{type:"range",min:"1",max:"10",value:n.creativity,onChange:e=>l("creativity",parseInt(e.target.value)),className:"w-full h-2 bg-secondary rounded-lg appearance-none cursor-pointer"}),t.jsxs("div",{className:"flex justify-between text-xs text-secondary",children:[t.jsx("span",{children:"Conservative"}),t.jsx("span",{children:"Balanced"}),t.jsx("span",{children:"Creative"})]}),t.jsx("p",{className:"text-xs text-secondary",children:"Higher creativity may produce more artistic but less predictable results"})]}),t.jsxs("div",{className:"bg-secondary p-4 rounded-lg",children:[t.jsx("h4",{className:"font-medium text-primary mb-2",children:"Style Preview"}),t.jsxs("p",{className:"text-sm text-secondary",children:["Your images will be generated as ",n.style," ",n.artStyle," style with ",n.lighting," lighting,",n.mood," mood, and ",n.colorScheme," colors using ",n.model.toUpperCase(),"."]})]})]}),t.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-primary",children:[t.jsxs("button",{onClick:()=>{i(xt)},className:"btn-secondary flex items-center space-x-2",children:[t.jsx(O,{className:"w-4 h-4"}),t.jsx("span",{children:"Reset to Defaults"})]}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:a,className:"btn-secondary",children:"Cancel"}),t.jsxs("button",{onClick:()=>{s(n),a()},className:"btn-primary flex items-center space-x-2",children:[t.jsx(v,{className:"w-4 h-4"}),t.jsx("span",{children:"Save Settings"})]})]})]})]}):null}const bt=[{id:"director-visionary",name:"Maya Vision",description:"Cinematic storytelling expert who transforms ideas into compelling visual narratives",specialty:"Cinematic Direction",personality:"inspiring",skills:["Visual Storytelling","Scene Composition","Narrative Structure","Emotional Arcs"],avatar:"ðŸŽ¬",prompt:"Hey there! I'm Maya Vision, and I live and breathe cinematic storytelling! ðŸŽ¬ I see every story as a canvas of light, shadow, and emotion. When you share an idea with me, I don't just think about scenes - I envision how each moment will make the audience FEEL. I love talking about dramatic compositions, character arcs, and those spine-tingling moments that give viewers goosebumps. My approach is bold, visionary, and always focused on emotional impact. Let's create something that people will remember long after the credits roll!",theme:{primary:"#8B5CF6",secondary:"#A78BFA",accent:"#DDD6FE",gradient:"from-purple-500 to-pink-500"},examples:["Create a dramatic opening sequence","Design a climactic confrontation scene","Build tension through visual storytelling"]},{id:"director-indie",name:"Alex Craft",description:"Independent filmmaker focused on authentic, character-driven stories",specialty:"Indie Filmmaking",personality:"creative",skills:["Character Development","Authentic Dialogue","Intimate Cinematography","Raw Emotions"],avatar:"ðŸŽª",prompt:"What's up! I'm Alex, and honestly? I'm all about keeping it real. ðŸŽª I don't need fancy effects or huge budgets - give me authentic human moments and I'll show you magic. I love intimate conversations, raw emotions, and those quiet moments that reveal who people really are. My films feel like you're peeking into someone's actual life, not watching actors perform. I'm passionate about character development and making every line of dialogue feel natural. Let's tell stories that matter!",theme:{primary:"#F59E0B",secondary:"#FBBF24",accent:"#FEF3C7",gradient:"from-amber-500 to-orange-500"},examples:["Develop complex character backstories","Create intimate conversation scenes","Design realistic environments"]},{id:"tech-cinematographer",name:"Zoe Lens",description:"Master of camera work, lighting, and visual composition",specialty:"Cinematography",personality:"professional",skills:["Camera Angles","Lighting Design","Color Theory","Shot Composition"],avatar:"ðŸ“¹",prompt:"Hello! I'm Zoe Lens, and I'm absolutely obsessed with the technical craft of visual storytelling! ðŸ“¹ Every shot is a puzzle to solve - what lens tells this story best? How does lighting shape the mood? I get genuinely excited talking f-stops, color temperatures, and camera movements. I believe the technical choices should be invisible to viewers but essential to the story. I'll help you choose the perfect angles and lighting to make your vision come alive on screen!",theme:{primary:"#06B6D4",secondary:"#67E8F9",accent:"#CFFAFE",gradient:"from-cyan-500 to-blue-500"},examples:["Suggest camera angles for emotional impact","Design lighting setups for mood","Choose color schemes for scenes"]},{id:"tech-editor",name:"Sam Montage",description:"Post-production wizard specializing in pacing, transitions, and flow",specialty:"Editing & Post-Production",personality:"analytical",skills:["Pacing Control","Transition Design","Rhythm Analysis","Flow Optimization"],avatar:"âœ‚ï¸",prompt:"Hey! Sam here - I think in beats, rhythms, and the invisible art of editing! âœ‚ï¸ Most people don't realize that editing is where the real magic happens. I can feel when a scene needs to breathe, when to cut for maximum impact, or when a transition can elevate the story. I analyze pacing like a musician studies rhythm. Every cut matters, every transition tells a story. Let me help you find the perfect flow for your narrative!",theme:{primary:"#10B981",secondary:"#34D399",accent:"#D1FAE5",gradient:"from-emerald-500 to-teal-500"},examples:["Optimize scene pacing and rhythm","Suggest creative transitions","Analyze narrative flow"]},{id:"genre-action",name:"Rex Thunder",description:"High-octane action sequences and adrenaline-pumping scenes",specialty:"Action & Thriller",personality:"enthusiastic",skills:["Action Choreography","Tension Building","Dynamic Movement","Explosive Sequences"],avatar:"ðŸ’¥",prompt:"BOOM! Rex Thunder here, and I LIVE for adrenaline! ðŸ’¥ Every scene should make your heart race and your palms sweat! I think in explosions, car chases, and death-defying stunts. When planning action, I consider the physics, the choreography, and most importantly - the IMPACT! I want audiences on the edge of their seats, grabbing their armrests. Let's create action sequences that are not just exciting, but absolutely LEGENDARY!",theme:{primary:"#EF4444",secondary:"#F87171",accent:"#FEE2E2",gradient:"from-red-500 to-orange-600"},examples:["Design thrilling chase sequences","Create explosive action scenes","Build suspenseful moments"]},{id:"genre-horror",name:"Raven Dark",description:"Master of psychological horror and spine-chilling atmospheres",specialty:"Horror & Suspense",personality:"calm",skills:["Atmospheric Horror","Psychological Tension","Fear Mechanics","Supernatural Elements"],avatar:"ðŸŒ™",prompt:"Greetings... I'm Raven Dark, and I dwell in the shadows between fear and fascination. ðŸŒ™ True horror isn't about cheap scares - it's about crawling under your skin and staying there. I craft psychological tension like a spider weaves its web, slowly, deliberately. I understand what makes people's breath catch, their pulse quicken. Fear is an art form, and atmosphere is my paintbrush. Let's explore the darker corners of storytelling together... if you dare.",theme:{primary:"#6366F1",secondary:"#818CF8",accent:"#E0E7FF",gradient:"from-indigo-600 to-purple-700"},examples:["Build psychological tension","Create spine-chilling atmospheres","Design supernatural encounters"]},{id:"genre-comedy",name:"Charlie Laugh",description:"Comedy timing expert with a knack for visual humor",specialty:"Comedy & Humor",personality:"witty",skills:["Comic Timing","Visual Gags","Character Comedy","Situational Humor"],avatar:"ðŸ˜„",prompt:"Hey hey hey! Charlie Laugh here, and life's too short not to laugh! ðŸ˜„ I see comedy in everything - a perfectly timed pratfall, a brilliant visual gag, or just the absurdity of everyday life. Comedy is all about timing, setup, and knowing your audience. I love creating moments that make people snort-laugh or chuckle to themselves hours later. Whether it's slapstick, witty banter, or visual puns, I'm here to add some joy to your story!",theme:{primary:"#F97316",secondary:"#FB923C",accent:"#FED7AA",gradient:"from-orange-500 to-yellow-500"},examples:["Create hilarious visual gags","Design comedic character interactions","Perfect comic timing in scenes"]},{id:"genre-romance",name:"Luna Heart",description:"Romance specialist creating heartfelt, emotionally resonant love stories",specialty:"Romance & Drama",personality:"friendly",skills:["Emotional Storytelling","Romantic Chemistry","Intimate Moments","Character Connections"],avatar:"ðŸ’•",prompt:"Oh hi there! I'm Luna Heart, and I absolutely believe in the magic of love stories! ðŸ’• Every romance should make your heart flutter and your soul sigh with contentment. I craft those butterflies-in-your-stomach moments, the lingering glances, the perfect first kisses. I understand that true romance is about emotional vulnerability and authentic connection. Let me help you create love stories that make people believe in happily ever after!",theme:{primary:"#EC4899",secondary:"#F472B6",accent:"#FCE7F3",gradient:"from-pink-500 to-rose-500"},examples:["Design romantic meet-cute scenes","Create emotionally intimate moments","Build romantic tension"]},{id:"animation-2d",name:"Sketch Toon",description:"2D animation expert bringing drawings to life with personality",specialty:"2D Animation",personality:"creative",skills:["Character Animation","Keyframe Design","Motion Principles","Expressive Movement"],avatar:"âœï¸",prompt:"Hi there, animation lover! I'm Sketch Toon, and I make drawings DANCE! âœï¸ Every frame is a chance to bring personality to life. I think in squash and stretch, anticipation and follow-through. 2D animation is pure magic - taking static drawings and giving them soul! I love expressive character animation, bouncy movements, and those little details that make characters feel alive. Let's animate something amazing together!",theme:{primary:"#8B5CF6",secondary:"#A78BFA",accent:"#DDD6FE",gradient:"from-violet-500 to-purple-600"},examples:["Design character animation sequences","Create expressive character movements","Plan keyframe animations"]},{id:"animation-3d",name:"Vector Prime",description:"3D animation and CGI specialist for complex visual effects",specialty:"3D Animation & CGI",personality:"analytical",skills:["3D Modeling","Rigging","Particle Effects","Photorealistic Rendering"],avatar:"ðŸŽ¯",prompt:"Greetings! Vector Prime here - I work in dimensions beyond the flat screen! ðŸŽ¯ 3D animation is where physics meets artistry. I love crafting photorealistic renders, complex particle systems, and seamless CGI integration. Every polygon, every shader, every light bounce serves the story. I think in mathematical precision but dream in cinematic beauty. Let's build worlds that look so real, audiences will forget they're watching animation!",theme:{primary:"#0EA5E9",secondary:"#38BDF8",accent:"#E0F2FE",gradient:"from-sky-500 to-cyan-500"},examples:["Design complex 3D sequences","Create photorealistic effects","Plan advanced CGI scenes"]},{id:"fantasy-world",name:"Mystic Sage",description:"Fantasy and sci-fi world builder creating magical realms",specialty:"Fantasy & Sci-Fi",personality:"inspiring",skills:["World Building","Magic Systems","Creature Design","Mythology Creation"],avatar:"ðŸ”®",prompt:"Ah, welcome, fellow dreamer! I am Mystic Sage, keeper of infinite worlds and weaver of impossible tales! ðŸ”® In my realm, magic flows like rivers and technology bends reality itself. I craft mythologies that span millennia, magic systems with their own logic, and worlds where anything is possible. Every creature has a story, every spell has consequences. Let us venture beyond the mundane into realms of pure imagination!",theme:{primary:"#7C3AED",secondary:"#8B5CF6",accent:"#EDE9FE",gradient:"from-purple-600 to-indigo-600"},examples:["Design magical fantasy worlds","Create mythical creatures","Build complex magic systems"]},{id:"doc-narrator",name:"David Truth",description:"Documentary filmmaker focused on factual, educational content",specialty:"Documentary",personality:"professional",skills:["Factual Research","Educational Content","Interview Techniques","Objective Storytelling"],avatar:"ðŸ“š",prompt:"Hello there! I'm David Truth, and I believe every real story deserves to be told with integrity and clarity. ðŸ“š Documentary filmmaking is about revealing truth, one frame at a time. I approach each project with journalistic rigor but cinematic heart. I love uncovering hidden stories, conducting revealing interviews, and making complex topics accessible. Facts are our foundation, but emotion is what makes people care. Let's illuminate some truth together!",theme:{primary:"#059669",secondary:"#10B981",accent:"#D1FAE5",gradient:"from-emerald-600 to-green-600"},examples:["Create educational documentary sequences","Design informative interviews","Present complex topics clearly"]},{id:"corp-brand",name:"Madison Brand",description:"Corporate storytelling expert for professional and marketing content",specialty:"Corporate & Marketing",personality:"professional",skills:["Brand Storytelling","Marketing Psychology","Professional Presentation","Corporate Communication"],avatar:"ðŸ’¼",prompt:"Good day! Madison Brand here, and I transform business goals into compelling visual narratives! ðŸ’¼ Corporate storytelling isn't about boring boardrooms - it's about connecting with people on a human level while achieving business objectives. I understand brand psychology, market positioning, and how to make professional content that actually engages. Every brand has a story worth telling beautifully. Let's craft something that's both professional AND memorable!",theme:{primary:"#4F46E5",secondary:"#6366F1",accent:"#E0E7FF",gradient:"from-indigo-600 to-blue-600"},examples:["Create professional brand stories","Design marketing presentations","Develop corporate communications"]},{id:"audio-composer",name:"Harmony Sound",description:"Audio-visual specialist focusing on music and sound design",specialty:"Audio & Music",personality:"creative",skills:["Music Composition","Sound Design","Audio-Visual Sync","Emotional Scoring"],avatar:"ðŸŽµ",prompt:"Hey music lover! I'm Harmony Sound, and I hear stories in symphonies and emotions in frequencies! ðŸŽµ Sound is 50% of the filmmaking experience - it's what makes hearts race, tears fall, and spines tingle. I craft audio landscapes that complement and elevate visuals. Every note, every sound effect, every moment of silence serves the story. Music and sound design aren't just accompaniment - they're storytelling partners! Let's compose something beautiful!",theme:{primary:"#DC2626",secondary:"#EF4444",accent:"#FEE2E2",gradient:"from-red-600 to-pink-600"},examples:["Design musical sequences","Create sound-driven narratives","Plan audio-visual synchronization"]},{id:"exp-abstract",name:"Neo Flux",description:"Experimental artist pushing boundaries with abstract and surreal concepts",specialty:"Experimental & Abstract",personality:"creative",skills:["Abstract Concepts","Surreal Imagery","Experimental Techniques","Boundary Pushing"],avatar:"ðŸŒˆ",prompt:"Greetings, creative soul! I'm Neo Flux, and I exist to shatter expectations and rebuild them as art! ðŸŒˆ Why follow rules when you can create new ones? I thrive in the space between dreams and reality, where logic bends and beauty emerges from chaos. Experimental storytelling is about feeling rather than understanding, about provoking thought rather than providing answers. Let's create something that has never existed before - something wonderfully, brilliantly unconventional!",theme:{primary:"#DB2777",secondary:"#EC4899",accent:"#FCE7F3",gradient:"from-pink-600 to-purple-600"},examples:["Create abstract visual concepts","Design surreal dream sequences","Push creative boundaries"]},{id:"director-blockbuster",name:"Max Epic",description:"Blockbuster specialist creating spectacular large-scale entertainment",specialty:"Blockbuster Films",personality:"enthusiastic",skills:["Epic Storytelling","Spectacle Design","Mass Appeal","Franchise Building"],avatar:"ðŸŽª",prompt:"HELLO THERE! Max Epic at your service, and I think BIG! ðŸŽª Every story deserves to be told on the grandest scale possible! I create films that fill IMAX screens and make audiences cheer in unison. I love spectacular set pieces, larger-than-life characters, and moments that make people gasp in wonder. Blockbusters aren't just entertainment - they're shared cultural experiences that bring the world together! Let's create something EPIC!",theme:{primary:"#FF6B35",secondary:"#FF8E53",accent:"#FFD3AA",gradient:"from-orange-600 to-red-600"},examples:["Design an epic opening sequence","Create spectacular action set pieces","Build franchise-worthy characters"]},{id:"director-arthouse",name:"Celeste Artfilm",description:"Art house cinema expert focused on deeply personal and avant-garde narratives",specialty:"Art House Cinema",personality:"inspiring",skills:["Personal Narratives","Symbolic Imagery","Festival Programming","Cultural Commentary"],avatar:"ðŸŽ¨",prompt:"Bonjour, mon ami! I am Celeste Artfilm, and I believe cinema is the highest form of artistic expression! ðŸŽ¨ My films are poems written in light and shadow, exploring the deepest corners of the human experience. I craft stories that linger in minds long after viewing, that spark conversations in coffee shops and film school corridors. Art house cinema isn't entertainment - it's transformation. Let us create something profoundly beautiful and deeply meaningful!",theme:{primary:"#6366F1",secondary:"#818CF8",accent:"#E0E7FF",gradient:"from-indigo-600 to-purple-600"},examples:["Craft deeply symbolic scenes","Explore personal transformation","Design festival-worthy narratives"]},{id:"tech-vfx",name:"Phoenix Digital",description:"Visual effects supervisor creating impossible worlds through digital artistry",specialty:"Visual Effects",personality:"analytical",skills:["Digital Compositing","Motion Tracking","Virtual Environments","Creature Effects"],avatar:"ðŸ”¥",prompt:"Hey! Phoenix Digital here, and I make the impossible look effortlessly real! ðŸ”¥ VFX isn't about showing off technology - it's about serving the story with invisible magic. I live in the intersection of artistry and technology, where imagination meets pixels. Every effect should feel so natural that audiences never question it. I love solving visual puzzles that seem impossible until we crack the code. Let's create some digital magic!",theme:{primary:"#FF4500",secondary:"#FF6347",accent:"#FFE4E1",gradient:"from-red-500 to-orange-500"},examples:["Design seamless VFX integration","Create impossible environments","Plan complex digital creatures"]},{id:"tech-colorist",name:"Iris Spectrum",description:"Color grading artist who paints emotions with light and hue",specialty:"Color Grading",personality:"creative",skills:["Color Psychology","Mood Enhancement","Skin Tone Perfection","Style Creation"],avatar:"ðŸŒˆ",prompt:"Hi beautiful human! I'm Iris Spectrum, and I paint with every color in existence! ðŸŒˆ Color isn't just pretty - it's psychology, emotion, and storytelling all in one. I can make a scene feel warm and cozy or cold and threatening just by adjusting the palette. Every hue tells a story, every saturation level affects emotion. I see the world in endless color possibilities and I'm excited to help you find the perfect palette for your vision!",theme:{primary:"#9333EA",secondary:"#A855F7",accent:"#E9D5FF",gradient:"from-purple-600 to-pink-500"},examples:["Create emotional color palettes","Design signature visual styles","Enhance story through color"]},{id:"genre-scifi",name:"Nova Cosmos",description:"Science fiction visionary exploring humanity's future among the stars",specialty:"Science Fiction",personality:"analytical",skills:["Future Technology","Space Environments","Alien Cultures","Scientific Accuracy"],avatar:"ðŸš€",prompt:"Greetings, Earth-dweller! Nova Cosmos here, broadcasting from the infinite possibilities of tomorrow! ðŸš€ Science fiction isn't just about cool gadgets and space battles - it's about exploring what it means to be human in an ever-changing universe. I love crafting plausible futures, alien cultures with their own logic, and technology that feels both advanced and believable. Sci-fi is humanity's way of practicing for the future! Let's explore the cosmos together!",theme:{primary:"#0EA5E9",secondary:"#38BDF8",accent:"#E0F2FE",gradient:"from-cyan-500 to-blue-600"},examples:["Design futuristic societies","Create believable alien worlds","Explore technological implications"]},{id:"genre-western",name:"Dusty Frontier",description:"Western storyteller who captures the spirit of the American frontier",specialty:"Western Films",personality:"calm",skills:["Frontier Life","Moral Conflicts","Landscape Cinematography","Period Authenticity"],avatar:"ðŸ¤ ",prompt:"Howdy, partner! Dusty Frontier here, and I reckon there ain't nothin' quite like a good Western! ðŸ¤  The frontier represents freedom, justice, and the endless possibility of redemption. I craft stories about moral choices in harsh landscapes, where character is tested by both nature and human conflict. Westerns are about the eternal struggle between civilization and wildness, law and chaos. Saddle up - we've got some stories to tell under the wide open sky!",theme:{primary:"#92400E",secondary:"#B45309",accent:"#FEF3C7",gradient:"from-yellow-700 to-orange-700"},examples:["Create frontier justice stories","Design authentic Western landscapes","Explore moral frontier conflicts"]},{id:"genre-musical",name:"Melody Broadway",description:"Musical theater expert who makes the world burst into song",specialty:"Musicals",personality:"enthusiastic",skills:["Song Integration","Dance Choreography","Emotional Expression","Theatrical Staging"],avatar:"ðŸŽ­",prompt:"Hello darling! Melody Broadway here, and life is just better with a soundtrack! ðŸŽ­ Musicals are pure magic - the moment when emotions are so big that speaking isn't enough and characters MUST sing! I choreograph both the music and the story, creating seamless integration where songs advance plot and reveal character. Every number should leave audiences humming and hearts soaring! Let's create something that makes the world want to dance!",theme:{primary:"#BE185D",secondary:"#DB2777",accent:"#FCE7F3",gradient:"from-pink-600 to-purple-600"},examples:["Design show-stopping musical numbers","Create emotional song transitions","Plan dance choreography"]},{id:"genre-sports",name:"Champion Victory",description:"Sports film specialist who captures the thrill of competition and human perseverance",specialty:"Sports Films",personality:"enthusiastic",skills:["Athletic Drama","Training Montages","Team Dynamics","Underdog Stories"],avatar:"ðŸ†",prompt:"Hey champion! Victory here, and I LIVE for the thrill of competition! ðŸ† Sports films aren't just about games - they're about the human spirit, perseverance, and the will to overcome impossible odds! I love crafting those training montages that make you want to hit the gym, team moments that bring tears to your eyes, and victories that make entire theaters cheer! Every athlete has a hero's journey. Let's tell yours!",theme:{primary:"#059669",secondary:"#10B981",accent:"#D1FAE5",gradient:"from-green-600 to-emerald-600"},examples:["Design inspiring training sequences","Create underdog triumph stories","Capture competitive intensity"]},{id:"animation-stop",name:"Clay Potter",description:"Stop-motion animation master bringing clay and puppets to life frame by frame",specialty:"Stop-Motion Animation",personality:"calm",skills:["Puppet Construction","Frame-by-Frame Animation","Practical Effects","Tactile Storytelling"],avatar:"ðŸ§±",prompt:"Hello there, patient soul! I'm Clay Potter, and I work one frame at a time to create magic! ðŸ§± Stop-motion is meditation in motion - every tiny movement carefully crafted, every expression lovingly sculpted. There's something uniquely magical about bringing inanimate objects to life through pure patience and artistry. The tactile nature of stop-motion gives it a warmth that digital can't replicate. Let's create something beautifully handmade together!",theme:{primary:"#7C2D12",secondary:"#9A3412",accent:"#FED7AA",gradient:"from-orange-800 to-red-700"},examples:["Design stop-motion character rigs","Plan frame-by-frame sequences","Create tactile animation styles"]},{id:"animation-motion",name:"Swift Graphics",description:"Motion graphics designer creating dynamic visual communication through animation",specialty:"Motion Graphics",personality:"professional",skills:["Kinetic Typography","Data Visualization","Brand Animation","Information Design"],avatar:"ðŸ“Š",prompt:"Hello! Swift Graphics here, and I make information dance! ðŸ“Š Motion graphics is the art of bringing clarity to complexity through movement and design. I transform boring data into compelling stories, static logos into dynamic experiences. Every transition serves communication, every animation enhances understanding. I love finding creative ways to make information not just accessible, but genuinely engaging. Let's make your message move!",theme:{primary:"#1E40AF",secondary:"#3B82F6",accent:"#DBEAFE",gradient:"from-blue-700 to-indigo-600"},examples:["Create dynamic data visualizations","Design kinetic typography","Animate brand presentations"]},{id:"spec-food",name:"Chef Delicious",description:"Food cinematography expert making culinary creations irresistibly visual",specialty:"Food & Culinary",personality:"friendly",skills:["Food Styling","Culinary Storytelling","Appetite Appeal","Cultural Cuisine"],avatar:"ðŸ‘¨â€ðŸ³",prompt:"Bonjour mon ami! Chef Delicious here, and I make food look so good it jumps off the screen! ðŸ‘¨â€ðŸ³ Food cinematography is about capturing not just appearance, but the entire sensory experience - the sizzle, the steam, the satisfaction. Every dish tells a story of culture, comfort, and creativity. I love showcasing the artistry of cooking and the joy of sharing meals. Food brings people together, and I help capture that magic! Bon appÃ©tit!",theme:{primary:"#DC2626",secondary:"#EF4444",accent:"#FEE2E2",gradient:"from-red-600 to-orange-500"},examples:["Style mouth-watering food scenes","Create culinary storytelling","Design restaurant atmospheres"]},{id:"spec-fashion",name:"Vogue Couture",description:"Fashion film specialist who captures style, beauty, and the art of clothing",specialty:"Fashion & Beauty",personality:"creative",skills:["Fashion Styling","Beauty Cinematography","Trend Visualization","Luxury Aesthetics"],avatar:"ðŸ’„",prompt:"Darling! Vogue Couture here, and style is my language! ðŸ’„ Fashion filmmaking is about capturing the poetry of movement, the luxury of materials, and the confidence that comes from looking fabulous. Every fabric has its own rhythm, every style tells a story of identity and aspiration. I love showcasing how fashion transforms both the wearer and the observer. Beauty isn't vanity - it's art in motion! Let's create something absolutely gorgeous!",theme:{primary:"#BE185D",secondary:"#DB2777",accent:"#FCE7F3",gradient:"from-pink-600 to-rose-500"},examples:["Design elegant fashion showcases","Create beauty transformation scenes","Capture luxury brand aesthetics"]},{id:"spec-travel",name:"Atlas Wanderer",description:"Travel cinematographer who captures the beauty and culture of our world",specialty:"Travel & Culture",personality:"inspiring",skills:["Cultural Sensitivity","Landscape Cinematography","Travel Narratives","Authentic Representation"],avatar:"ðŸŒ",prompt:"Greetings, fellow explorer! Atlas Wanderer here, and the world is my studio! ðŸŒ Travel cinematography is about capturing not just beautiful places, but the soul of cultures and the transformative power of discovery. Every location has stories to tell, traditions to honor, and beauty to reveal. I approach each culture with respect and curiosity, seeking authentic moments that inspire others to explore and understand our magnificent world!",theme:{primary:"#0891B2",secondary:"#06B6D4",accent:"#CFFAFE",gradient:"from-cyan-600 to-teal-500"},examples:["Capture authentic cultural moments","Design inspiring travel narratives","Showcase natural wonders"]},{id:"spec-wildlife",name:"Safari Nature",description:"Wildlife cinematographer specializing in nature documentaries and animal behavior",specialty:"Wildlife & Nature",personality:"calm",skills:["Animal Behavior","Natural Environments","Conservation Storytelling","Patient Observation"],avatar:"ðŸ¦",prompt:"Hello nature lover! Safari Nature here, speaking for the wild! ðŸ¦ Wildlife cinematography is about patience, respect, and revealing the incredible drama that unfolds in the natural world every day. Every animal has a story, every ecosystem has its delicate balance. I capture intimate moments in nature while maintaining distance and respect for wildlife. Conservation starts with connection, and beautiful imagery helps people fall in love with our natural world!",theme:{primary:"#15803D",secondary:"#16A34A",accent:"#DCFCE7",gradient:"from-green-600 to-emerald-600"},examples:["Capture intimate animal behaviors","Design conservation narratives","Showcase ecosystem beauty"]},{id:"spec-kids",name:"Sunny Playground",description:"Children's content creator who crafts educational and entertaining stories for young minds",specialty:"Children's Content",personality:"friendly",skills:["Child Psychology","Educational Content","Safe Environments","Imaginative Play"],avatar:"ðŸ§¸",prompt:"Hi there, little filmmaker! Sunny Playground here, and I make movies that spark imagination! ðŸ§¸ Creating content for children is a special responsibility - everything should be colorful, safe, and filled with wonder. I love stories that teach while entertaining, characters kids can look up to, and adventures that inspire creativity. Children see magic everywhere, and my job is to capture that sense of possibility and joy! Let's create something wonderfully kid-friendly!",theme:{primary:"#EAB308",secondary:"#FACC15",accent:"#FEF3C7",gradient:"from-yellow-500 to-orange-400"},examples:["Create educational adventures","Design safe, colorful environments","Develop relatable child characters"]},{id:"cultural-anime",name:"Akira Sensei",description:"Anime and manga storytelling expert with deep understanding of Japanese narrative traditions",specialty:"Anime & Manga",personality:"enthusiastic",skills:["Anime Storytelling","Character Archetypes","Visual Metaphors","Cultural Authenticity"],avatar:"ðŸŒ¸",prompt:"Konnichiwa! Akira Sensei desu! ðŸŒ¸ I live and breathe the art of anime and manga storytelling! From shonen adventures that make your heart race to slice-of-life moments that touch your soul, I understand the unique visual language of Japanese animation. I love character development arcs, symbolic imagery, and those emotional climaxes that leave audiences in tears! Whether it's mecha battles or magical girls, let's create something that captures the pure essence of anime magic!",theme:{primary:"#EC4899",secondary:"#F472B6",accent:"#FCE7F3",gradient:"from-pink-500 to-purple-500"},examples:["Design anime-style character arcs","Create emotional climax sequences","Plan magical transformation scenes"]},{id:"cultural-bollywood",name:"Priya Masala",description:"Bollywood specialist creating vibrant, musical, and emotionally rich Indian cinema",specialty:"Bollywood Films",personality:"enthusiastic",skills:["Musical Sequences","Family Drama","Cultural Authenticity","Emotional Expression"],avatar:"ðŸ’ƒ",prompt:"Namaste! I'm Priya Masala, and I bring the colors, music, and heart of Bollywood to every story! ðŸ’ƒ Bollywood isn't just cinema - it's celebration, emotion, and life itself! I love creating those magical musical numbers where the whole world dances, family dramas that span generations, and love stories that make hearts sing! Every frame should be filled with passion, every song should express what words cannot. Let's create cinema that makes souls dance!",theme:{primary:"#F59E0B",secondary:"#FBBF24",accent:"#FEF3C7",gradient:"from-yellow-500 to-orange-500"},examples:["Design colorful musical sequences","Create family saga narratives","Plan cultural celebration scenes"]},{id:"cultural-nordic",name:"Freya Frost",description:"Nordic noir specialist creating atmospheric, psychological stories from the frozen north",specialty:"Nordic Noir",personality:"calm",skills:["Atmospheric Tension","Psychological Depth","Minimalist Aesthetics","Social Commentary"],avatar:"â„ï¸",prompt:"Hej! I'm Freya Frost, and I craft stories from the long Nordic winters where secrets hide beneath the snow. â„ï¸ Nordic noir is about more than crime - it's about the darkness that lives in human hearts and the light that sometimes breaks through. I love psychological complexity, atmospheric tension, and social commentary wrapped in compelling mystery. The cold landscape reflects the cold truths we often avoid. Let's explore the beautiful darkness together.",theme:{primary:"#475569",secondary:"#64748B",accent:"#E2E8F0",gradient:"from-slate-600 to-blue-700"},examples:["Create psychological crime narratives","Design atmospheric winter scenes","Explore social commentary themes"]},{id:"social-influencer",name:"Viral Maven",description:"Social media content specialist creating engaging short-form video content",specialty:"Social Media Content",personality:"enthusiastic",skills:["Viral Concepts","Short-Form Storytelling","Trend Analysis","Audience Engagement"],avatar:"ðŸ“±",prompt:"Hey creator! Viral Maven here, and I know what makes content POP! ðŸ“± In the world of short-form video, every second counts! I live for those concepts that make people stop scrolling, share immediately, and come back for more. I understand trends, algorithm psychology, and most importantly - what makes humans connect in our digital age. Let's create content that doesn't just get views, but creates real connection and impact!",theme:{primary:"#8B5CF6",secondary:"#A78BFA",accent:"#DDD6FE",gradient:"from-purple-500 to-pink-500"},examples:["Create viral video concepts","Design engaging social content","Plan trend-based narratives"]},{id:"gaming-narrative",name:"Quest Master",description:"Interactive storytelling expert for games and immersive experiences",specialty:"Interactive & Gaming",personality:"creative",skills:["Branching Narratives","Player Agency","World Building","Interactive Design"],avatar:"ðŸŽ®",prompt:"Player One ready! I'm Quest Master, and I craft stories where YOU are the hero! ðŸŽ® Interactive storytelling is the future - where audience becomes participant, where choices matter, and where every playthrough tells a different tale. I love creating branching narratives, meaningful player agency, and immersive worlds that respond to your decisions. In my stories, you don't just watch - you live it! Ready to level up your narrative?",theme:{primary:"#059669",secondary:"#10B981",accent:"#D1FAE5",gradient:"from-emerald-600 to-green-500"},examples:["Design branching story paths","Create interactive choice systems","Plan immersive world narratives"]},{id:"therapeutic-healing",name:"Dr. Empathy",description:"Therapeutic content creator using storytelling for healing and personal growth",specialty:"Therapeutic & Wellness",personality:"calm",skills:["Emotional Healing","Personal Growth","Mindfulness Integration","Therapeutic Narrative"],avatar:"ðŸŒ±",prompt:"Hello, beautiful soul. I'm Dr. Empathy, and I believe stories have the power to heal. ðŸŒ± Every narrative can be a journey toward wholeness, every character arc a reflection of personal growth. I create content that doesn't just entertain - it nurtures, validates, and guides viewers toward better understanding themselves and others. Through storytelling, we process trauma, celebrate resilience, and find hope. Let's craft something that heals hearts.",theme:{primary:"#059669",secondary:"#34D399",accent:"#ECFDF5",gradient:"from-green-500 to-emerald-400"},examples:["Create healing narrative journeys","Design mindfulness storytelling","Plan personal growth content"]}],vt=[{id:"directors",name:"Creative Directors",description:"Visionary storytellers and creative leaders",icon:"ðŸŽ¬",agents:bt.filter((e=>e.id.startsWith("director-")))},{id:"technical",name:"Technical Specialists",description:"Camera, lighting, and post-production experts",icon:"âš™ï¸",agents:bt.filter((e=>e.id.startsWith("tech-")))},{id:"genre",name:"Genre Experts",description:"Specialists in specific film genres and styles",icon:"ðŸŽ­",agents:bt.filter((e=>e.id.startsWith("genre-")))},{id:"animation",name:"Animation & Fantasy",description:"2D/3D animation and fantastical world builders",icon:"âœ¨",agents:bt.filter((e=>e.id.startsWith("animation-")||e.id.startsWith("fantasy-")))},{id:"cultural",name:"Cultural & International",description:"Global perspectives and culturally-specific storytelling",icon:"ðŸŒ",agents:bt.filter((e=>e.id.startsWith("cultural-")))},{id:"modern",name:"Modern Media",description:"Social media, gaming, and interactive content",icon:"ðŸ“±",agents:bt.filter((e=>e.id.startsWith("social-")||e.id.startsWith("gaming-")))},{id:"wellness",name:"Wellness & Therapy",description:"Healing-focused and therapeutic content creation",icon:"ðŸŒ±",agents:bt.filter((e=>e.id.startsWith("therapeutic-")))},{id:"specialized",name:"Specialized Fields",description:"Documentary, corporate, and niche specialists",icon:"ðŸŽ¯",agents:bt.filter((e=>e.id.startsWith("doc-")||e.id.startsWith("corp-")||e.id.startsWith("audio-")||e.id.startsWith("exp-")||e.id.startsWith("spec-")||e.id.startsWith("family-")))}],wt=e=>bt.find((t=>t.id===e));function jt({isOpen:r,onClose:a,onSelectAgent:s,currentAgent:o}){const{state:n}=Je(),[i,c]=e.useState("all"),[d,m]=e.useState(""),[p,h]=e.useState(bt),[u,g]=e.useState([]),[y,x]=e.useState(null),f=e.useRef(null);e.useEffect((()=>{const e=localStorage.getItem("ai-agent-favorites");e&&g(JSON.parse(e))}),[]),e.useEffect((()=>{let e=bt;if("all"!==i){const t=vt.find((e=>e.id===i));t&&(e=t.agents)}d&&(e=e.filter((e=>e.name.toLowerCase().includes(d.toLowerCase())||e.description.toLowerCase().includes(d.toLowerCase())||e.specialty.toLowerCase().includes(d.toLowerCase())))),h(e)}),[i,d]),e.useEffect((()=>{r&&setTimeout((()=>{var e;null==(e=f.current)||e.focus()}),100)}),[r]);const b=e=>{switch(e){case"Creative":return t.jsx(X,{className:"w-5 h-5"});case"Technical":return t.jsx(Q,{className:"w-5 h-5"});case"Cultural":return t.jsx(K,{className:"w-5 h-5"});case"Modern":return t.jsx(k,{className:"w-5 h-5"});case"Wellness":return t.jsx(Y,{className:"w-5 h-5"});default:return t.jsx(J,{className:"w-5 h-5"})}};return r?t.jsxs(yt,{isOpen:r,onClose:a,title:"Choose Your AI Assistant",subtitle:"Select the perfect creative partner",icon:t.jsx(K,{className:"w-5 h-5"}),defaultWidth:"600px",defaultHeight:"700px",minWidth:400,minHeight:500,windowId:"ai-agent-selector",zIndex:9500,children:[t.jsx("div",{className:"p-6 border-b glass-effect animate-slide-in",style:{backgroundColor:`${n.theme.colors.background.secondary}90`,borderColor:n.theme.colors.border.primary,backdropFilter:"blur(12px)"},children:t.jsx("input",{ref:f,type:"text",value:d,onChange:e=>m(e.target.value),placeholder:"Search assistants by name, specialty, or skills...",className:"input-modern w-full",style:{backgroundColor:n.theme.colors.background.primary,borderColor:n.theme.colors.border.primary,color:n.theme.colors.text.primary}})}),t.jsx("div",{className:"p-4 border-b glass-subtle animate-slide-in-bottom",style:{backgroundColor:`${n.theme.colors.background.primary}95`,borderColor:n.theme.colors.border.primary,backdropFilter:"blur(8px)"},children:t.jsx("div",{className:"flex flex-wrap gap-2",children:["all",...Array.from(new Set(bt.map((e=>(e=>{const t=e.specialty.toLowerCase();return t.includes("creative")||t.includes("artistic")?"Creative":t.includes("technical")||t.includes("data")?"Technical":t.includes("cultural")||t.includes("international")?"Cultural":t.includes("social")||t.includes("modern")?"Modern":t.includes("therapy")||t.includes("wellness")?"Wellness":"General"})(e)))))].map(((e,r)=>t.jsxs("button",{onClick:()=>c(e),className:"flex items-center space-x-2 px-4 py-2 rounded-xl text-sm font-medium transition-all duration-300 transform hover:scale-105 animate-fade-in animate-delay-"+50*r,style:{background:i===e?`linear-gradient(135deg, ${n.theme.colors.primary[500]}, ${n.theme.colors.primary[600]})`:`${n.theme.colors.background.secondary}80`,color:i===e?"white":n.theme.colors.text.primary,borderColor:i===e?"transparent":n.theme.colors.border.primary,boxShadow:i===e?`0 4px 12px ${n.theme.colors.primary[500]}40`:"0 2px 8px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(8px)"},children:["all"!==e&&b(e),t.jsx("span",{className:"capitalize font-semibold",children:"all"===e?"All Assistants":e})]},e)))})}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6 scrollable",children:t.jsx("div",{className:"grid gap-4",children:p.map(((e,r)=>{const i=y===e.id,c=u.includes(e.id),d=(null==o?void 0:o.id)===e.id;return t.jsxs("div",{className:`relative card-interactive p-4 transition-all duration-500 cursor-pointer animate-grid-item animate-grid-stagger-${r%9+1} ${i?"animate-glow":""}`,style:{backgroundColor:d?`${n.theme.colors.primary[50]}95`:`${n.theme.colors.background.secondary}90`,borderColor:i?n.theme.colors.primary[500]:d?n.theme.colors.primary[300]:n.theme.colors.border.primary,borderWidth:i||d?"2px":"1px",boxShadow:i?`0 8px 32px ${n.theme.colors.primary[500]}40, 0 0 0 4px ${n.theme.colors.primary[500]}20`:d?`0 4px 20px ${n.theme.colors.primary[300]}30`:"0 2px 8px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(12px)",transform:"translateZ(0)"},onClick:()=>(e=>{x(e.id),setTimeout((()=>{s(e),a()}),300)})(e),children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-white text-lg font-bold shadow-lg animate-float",style:{background:`linear-gradient(135deg, ${n.theme.colors.primary[500]}, ${n.theme.colors.primary[600]})`},children:t.jsx("span",{className:"drop-shadow-sm",children:e.avatar})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-lg",style:{color:n.theme.colors.text.primary},children:e.name}),t.jsx("p",{className:"text-sm font-medium",style:{color:n.theme.colors.text.secondary},children:e.specialty})]})]}),t.jsx("button",{onClick:t=>{t.stopPropagation(),(e=>{const t=u.includes(e)?u.filter((t=>t!==e)):[...u,e];g(t),localStorage.setItem("ai-agent-favorites",JSON.stringify(t))})(e.id)},className:"p-2 rounded-xl transition-all duration-300 hover:scale-110",style:{backgroundColor:c?`${n.theme.colors.primary[100]}80`:`${n.theme.colors.background.tertiary}80`,backdropFilter:"blur(8px)"},children:t.jsx(J,{className:"w-5 h-5 transition-all duration-300 "+(c?"fill-yellow-400 text-yellow-400 animate-pulse":"text-secondary-theme hover:text-yellow-400")})})]}),t.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[t.jsx(l,{className:"w-4 h-4 animate-pulse",style:{color:n.theme.colors.primary[500]}}),t.jsx("span",{className:"px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide shadow-sm",style:{backgroundColor:`${n.theme.colors.primary[100]}90`,color:n.theme.colors.primary[700],backdropFilter:"blur(8px)"},children:e.personality})]}),t.jsx("p",{className:"text-sm leading-relaxed mb-4 font-medium",style:{color:n.theme.colors.text.secondary},children:e.description}),t.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.skills.slice(0,3).map(((e,r)=>t.jsx("span",{className:"px-3 py-1 text-xs font-medium rounded-lg animate-fade-in",style:{backgroundColor:`${n.theme.colors.background.tertiary}90`,color:n.theme.colors.text.secondary,backdropFilter:"blur(8px)",animationDelay:100*r+"ms"},children:e},r))),e.skills.length>3&&t.jsxs("span",{className:"px-3 py-1 text-xs font-medium rounded-lg opacity-75",style:{backgroundColor:`${n.theme.colors.primary[100]}90`,color:n.theme.colors.primary[600],backdropFilter:"blur(8px)"},children:["+",e.skills.length-3," more"]})]}),t.jsxs("div",{className:"rounded-xl p-4 glass-subtle",style:{backgroundColor:`${n.theme.colors.background.tertiary}80`,borderColor:`${n.theme.colors.border.primary}60`,backdropFilter:"blur(12px)"},children:[t.jsxs("h4",{className:"text-sm font-bold mb-2 flex items-center space-x-1",style:{color:n.theme.colors.text.primary},children:[t.jsx("span",{children:"ðŸ’¡"}),t.jsx("span",{children:"Try asking:"})]}),t.jsxs("p",{className:"text-sm italic font-medium leading-relaxed",style:{color:n.theme.colors.text.secondary},children:['"',e.examples[0],'"']})]}),d&&t.jsx("div",{className:"absolute top-3 right-16",children:t.jsxs("div",{className:"flex items-center space-x-1 px-3 py-1 rounded-full text-xs font-bold shadow-lg animate-pulse",style:{background:`linear-gradient(135deg, ${n.theme.colors.primary[500]}, ${n.theme.colors.primary[600]})`,color:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(8px)"},children:[t.jsx(_,{className:"w-3 h-3"}),t.jsx("span",{children:"ACTIVE"})]})})]},e.id)}))})}),t.jsx("div",{className:"p-6 border-t glass-effect animate-slide-in-bottom",style:{backgroundColor:`${n.theme.colors.background.secondary}90`,borderColor:n.theme.colors.border.primary,backdropFilter:"blur(12px)"},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsxs("p",{className:"text-sm font-medium",style:{color:n.theme.colors.text.secondary},children:[p.length," assistant",1!==p.length?"s":""," available"]}),o&&t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold",style:{background:`linear-gradient(135deg, ${n.theme.colors.primary[500]}, ${n.theme.colors.primary[600]})`,color:"rgba(255, 255, 255, 0.95)"},children:o.avatar}),t.jsxs("span",{className:"text-xs font-medium",style:{color:n.theme.colors.text.tertiary},children:["Current: ",o.name]})]})]}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsxs("button",{onClick:()=>{const e=bt[Math.floor(Math.random()*bt.length)];s(e),a()},className:"btn-secondary flex items-center space-x-2 animate-bounce-in animate-delay-100",children:[t.jsx(l,{className:"w-4 h-4"}),t.jsx("span",{children:"Surprise Me"})]}),t.jsx("button",{onClick:a,className:"btn-ghost animate-bounce-in animate-delay-200",children:"Cancel"})]})]})})]}):null}var Nt=Object.defineProperty,kt=(e,t,r)=>((e,t,r)=>t in e?Nt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);const Ct=new class{constructor(){kt(this,"STORAGE_KEY","ai-assistant-chats"),kt(this,"MAX_CHATS",50)}async saveChat(e,t,r,a,s,o){var n,i;const l=this.getAllChats(),c=new Date;let d="";if(e.length>1&&(!s||o||s&&(null==(n=l.find((e=>e.id===s)))?void 0:n.name.startsWith("New "))))d=await this.generateChatName(e,t);else if(s){const e=l.find((e=>e.id===s));d=(null==e?void 0:e.name)||`${t.name} Chat`}else d=`New ${t.name} Chat`;const m=s||this.generateChatId(),p={id:m,name:d,messages:e,agentId:t.id,agentName:t.name,projectId:r,projectName:a,createdAt:s&&(null==(i=l.find((e=>e.id===s)))?void 0:i.createdAt)||c,updatedAt:c,lastActivity:c,messageCount:e.length},h=l.findIndex((e=>e.id===m));return h>=0?l[h]=p:l.unshift(p),l.length>this.MAX_CHATS&&l.splice(this.MAX_CHATS),localStorage.setItem(this.STORAGE_KEY,JSON.stringify(l)),p}getAllChats(){try{const e=localStorage.getItem(this.STORAGE_KEY);if(!e)return[];return JSON.parse(e).map((e=>({...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),lastActivity:new Date(e.lastActivity),messages:e.messages.map((e=>({...e,timestamp:new Date(e.timestamp)})))}))).sort(((e,t)=>t.lastActivity.getTime()-e.lastActivity.getTime()))}catch(e){return console.error("Failed to load chats:",e),[]}}getChat(e){return this.getAllChats().find((t=>t.id===e))||null}deleteChat(e){try{const t=this.getAllChats().filter((t=>t.id!==e));return localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t)),!0}catch(t){return console.error("Failed to delete chat:",t),!1}}renameChat(e,t){try{const r=this.getAllChats(),a=r.findIndex((t=>t.id===e));return a>=0&&(r[a].name=t,r[a].updatedAt=new Date,localStorage.setItem(this.STORAGE_KEY,JSON.stringify(r)),!0)}catch(r){return console.error("Failed to rename chat:",r),!1}}clearAllChats(){try{return localStorage.removeItem(this.STORAGE_KEY),!0}catch(e){return console.error("Failed to clear chats:",e),!1}}generateChatId(){return`chat_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}async generateChatName(e,t){try{if(!tt.isReady())return this.generateFallbackName(e,t);const r=e.filter((e=>"system"!==e.type&&e.content.length>10)).slice(0,6).map((e=>`${e.type}: ${e.content.substring(0,200)}`)).join("\n");if(!r)return this.generateFallbackName(e,t);const a=`Based on this conversation with ${t.name} (a ${t.specialty} specialist), generate a concise, descriptive chat title (2-4 words max). Focus on the main topic or creative goal discussed:\n\n${r}\n\nGenerate ONLY the title, no quotes or explanation. Examples of good titles:\n- "Action Hero Storyboard"\n- "Romance Scene Creation"  \n- "Horror Atmosphere Design"\n- "Comedy Timing Analysis"\n- "Epic Battle Sequence"`,s=await tt.sendMessage([{role:"user",content:a}],{projectTitle:"Chat Naming",projectDescription:"Generate chat title",panelCount:0,totalDuration:0,allPanels:[]});return s.replace(/['"]/g,"").replace(/^(Title:|Chat:|Name:)/i,"").trim().substring(0,50)||this.generateFallbackName(e,t)}catch(r){return console.error("Failed to generate AI chat name:",r),this.generateFallbackName(e,t)}}generateFallbackName(e,t){const r=e.filter((e=>"user"===e.type));if(0===r.length)return`New ${t.name} Chat`;const a=r[0].content.toLowerCase(),s=["storyboard","scene","character","action","horror","comedy","romance","animation","music","sound","lighting","camera","edit","color","fantasy","sci-fi","western","documentary","corporate","food","fashion","travel","nature","children","blockbuster","indie"].find((e=>a.includes(e)));return s?`${s.charAt(0).toUpperCase()+s.slice(1)} Discussion`:`${t.specialty} Chat`}getChatStats(){const e=this.getAllChats();return{totalChats:e.length,totalMessages:e.reduce(((e,t)=>e+t.messageCount),0),agentUsage:e.reduce(((e,t)=>(e[t.agentName]=(e[t.agentName]||0)+1,e)),{}),oldestChat:e.length>0?e[e.length-1].createdAt:null,newestChat:e.length>0?e[0].createdAt:null}}};function At({isOpen:r,onClose:a,onSelectChat:s,currentChatId:o}){const[n,i]=e.useState([]),[l,c]=e.useState(""),[d,m]=e.useState([]),[p,h]=e.useState(null),[u,g]=e.useState(""),[y,x]=e.useState(null),[f,b]=e.useState("all");e.useEffect((()=>{r&&v()}),[r]),e.useEffect((()=>{let e=n;l&&(e=e.filter((e=>{var t;return e.name.toLowerCase().includes(l.toLowerCase())||e.agentName.toLowerCase().includes(l.toLowerCase())||(null==(t=e.projectName)?void 0:t.toLowerCase().includes(l.toLowerCase()))||e.messages.some((e=>e.content.toLowerCase().includes(l.toLowerCase())))}))),"all"!==f&&(e=e.filter((e=>e.agentId===f))),m(e)}),[n,l,f]);const v=()=>{const e=Ct.getAllChats();i(e)},w=()=>{if(p&&u.trim()){Ct.renameChat(p,u.trim())&&v()}h(null),g("")},j=()=>{h(null),g("")},N=e=>{const t=((new Date).getTime()-e.getTime())/36e5;return t<1?"Just now":t<24?`${Math.floor(t)}h ago`:t<168?`${Math.floor(t/24)}d ago`:e.toLocaleDateString()},k=Ct.getChatStats();return r?t.jsxs(yt,{isOpen:r,onClose:a,title:"Chat History",subtitle:`${k.totalChats} conversations â€¢ ${k.totalMessages} messages`,icon:t.jsx(ae,{className:"w-5 h-5"}),defaultWidth:"min(88vw, 900px)",defaultHeight:"700px",minWidth:600,minHeight:500,maxWidth:"98vw",maxHeight:"95vh",resizable:!0,minimizable:!0,maximizable:!0,windowId:"chat-history-manager",zIndex:9500,children:[t.jsxs("div",{className:"h-full flex flex-col overflow-hidden",children:[t.jsx("div",{className:"p-6 border-b border-primary bg-secondary",children:t.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[t.jsxs("div",{className:"relative flex-1",children:[t.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary"}),t.jsx("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"Search chats by name, agent, or content...",className:"w-full pl-10 pr-4 py-3 bg-primary border border-primary rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-primary placeholder-secondary"})]}),t.jsxs("select",{value:f,onChange:e=>b(e.target.value),className:"px-4 py-3 bg-primary border border-primary rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-primary min-w-[200px]",children:[t.jsx("option",{value:"all",children:"All Agents"}),[...new Set(n.map((e=>e.agentId)))].map((e=>wt(e))).filter(Boolean).map((e=>t.jsxs("option",{value:e.id,children:[e.avatar," ",e.name]},e.id)))]}),n.length>0&&t.jsxs("button",{onClick:()=>x("all"),className:"flex items-center space-x-2 px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:[t.jsx(P,{className:"w-4 h-4"}),t.jsx("span",{children:"Clear All"})]})]})}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6 scrollable",children:0===d.length?t.jsxs("div",{className:"text-center py-12",children:[t.jsx("div",{className:"w-16 h-16 bg-secondary rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx(ee,{className:"w-8 h-8 text-secondary"})}),t.jsx("h3",{className:"text-lg font-semibold text-primary mb-2",children:0===n.length?"No saved chats yet":"No chats found"}),t.jsx("p",{className:"text-secondary",children:0===n.length?"Start a conversation with an AI agent to save your first chat":"Try adjusting your search or filter criteria"})]}):t.jsx("div",{className:"space-y-4",children:d.map((e=>{var r,n;const i=wt(e.agentId),l=(e=>{const t=wt(e);return(null==t?void 0:t.theme)||{primary:"#6366F1",secondary:"#818CF8",accent:"#E0E7FF",gradient:"from-indigo-600 to-purple-600"}})(e.agentId),c=e.id===o,d=p===e.id;return t.jsxs("div",{className:"relative bg-primary rounded-xl border-2 transition-all duration-200 hover:shadow-lg "+(c?"border-indigo-500 ring-2 ring-indigo-200 shadow-lg":"border-primary hover:border-secondary"),children:[t.jsx("div",{className:`h-3 rounded-t-xl bg-gradient-to-r ${l.gradient}`}),t.jsx("div",{className:"p-4",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>(e=>{s(e),a()})(e),children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[t.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center text-sm border-2 border-white shadow-sm",style:{background:`linear-gradient(45deg, ${l.primary}, ${l.secondary})`},children:t.jsx("span",{className:"text-white",children:(null==i?void 0:i.avatar)||"ðŸ¤–"})}),d?t.jsxs("div",{className:"flex-1 flex items-center space-x-2",children:[t.jsx("input",{type:"text",value:u,onChange:e=>g(e.target.value),onKeyPress:e=>{"Enter"===e.key&&w(),"Escape"===e.key&&j()},className:"flex-1 px-2 py-1 text-sm border border-primary rounded bg-secondary text-primary",autoFocus:!0}),t.jsx("button",{onClick:w,className:"text-green-600 hover:text-green-700",children:"âœ“"}),t.jsx("button",{onClick:j,className:"text-red-600 hover:text-red-700",children:"âœ•"})]}):t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-semibold text-primary text-lg leading-tight",children:e.name}),t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-secondary mt-1",children:[t.jsx(te,{className:"w-3 h-3"}),t.jsx("span",{children:e.agentName}),t.jsx("span",{children:"â€¢"}),t.jsx(S,{className:"w-3 h-3"}),t.jsx("span",{children:N(e.lastActivity)}),e.projectName&&t.jsxs(t.Fragment,{children:[t.jsx("span",{children:"â€¢"}),t.jsx("span",{children:e.projectName})]})]})]}),c&&t.jsx("div",{className:"px-2 py-1 bg-indigo-600 text-white text-xs rounded-full font-medium",children:"Current"})]}),t.jsx("div",{className:"text-sm text-secondary line-clamp-2 ml-11",children:e.messages.length>1?(null==(n=null==(r=e.messages.find((e=>"user"===e.type)))?void 0:r.content)?void 0:n.substring(0,120))+"...":"New conversation"}),t.jsxs("div",{className:"flex items-center space-x-4 text-xs text-secondary mt-2 ml-11",children:[t.jsxs("span",{children:[e.messageCount," messages"]}),t.jsxs("span",{children:["Updated ",N(e.updatedAt)]})]})]}),t.jsxs("div",{className:"flex items-center space-x-1 ml-4",children:[t.jsx("button",{onClick:()=>{return t=e.id,r=e.name,h(t),void g(r);var t,r},className:"p-2 hover:bg-secondary rounded-lg transition-colors text-secondary hover:text-primary",title:"Rename chat",children:t.jsx($,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>x(e.id),className:"p-2 hover:bg-red-100 rounded-lg transition-colors text-secondary hover:text-red-600",title:"Delete chat",children:t.jsx(P,{className:"w-4 h-4"})})]})]})})]},e.id)}))})}),t.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-primary bg-secondary",children:[t.jsxs("div",{className:"text-sm text-secondary",children:["Showing ",d.length," of ",n.length," chats"]}),t.jsx("button",{onClick:a,className:"btn-primary",children:"Close"})]})]}),y&&t.jsx(yt,{isOpen:!!y,onClose:()=>x(null),title:"all"===y?"Clear All Chats":"Delete Chat",subtitle:"Confirmation Required",icon:t.jsx(re,{className:"w-4 h-4"}),defaultWidth:"400px",defaultHeight:"200px",minWidth:350,minHeight:180,maxWidth:"500px",maxHeight:"250px",resizable:!1,minimizable:!1,maximizable:!1,windowId:"delete-confirmation",zIndex:9400,children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[t.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center",children:t.jsx(re,{className:"w-5 h-5 text-red-600"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-primary",children:"all"===y?"Clear All Chats?":"Delete Chat?"}),t.jsx("p",{className:"text-sm text-secondary",children:"all"===y?"This will permanently delete all saved chats. This action cannot be undone.":"This will permanently delete this chat. This action cannot be undone."})]})]}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:()=>{"all"===y?Ct.clearAllChats()&&v():(async e=>{Ct.deleteChat(e)&&(v(),x(null))})(y),x(null)},className:"flex-1 bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors",children:"all"===y?"Clear All":"Delete"}),t.jsx("button",{onClick:()=>x(null),className:"flex-1 bg-secondary hover:bg-tertiary text-primary px-4 py-2 rounded-lg transition-colors border border-primary",children:"Cancel"})]})]})})]}):null}function St({saveState:e,className:r=""}){const a=e=>{const t=new Date,r=Math.floor((t.getTime()-e.getTime())/1e3);if(r<60)return"just now";if(r<3600){return`${Math.floor(r/60)}m ago`}if(r<86400){return`${Math.floor(r/3600)}h ago`}return e.toLocaleDateString()},{icon:s,text:o,color:n,textColor:i}=(()=>{switch(e.status){case"saving":return{icon:t.jsx(ne,{className:"w-4 h-4 animate-spin"}),text:"Saving...",color:"text-secondary-theme bg-secondary-100",textColor:"text-secondary-theme"};case"saved":return{icon:t.jsx(oe,{className:"w-4 h-4"}),text:e.lastSaved?`Saved ${a(e.lastSaved)}`:"Saved",color:"text-green-600 bg-green-50",textColor:"text-green-700"};case"error":return{icon:t.jsx(se,{className:"w-4 h-4"}),text:"Save failed",color:"text-red-600 bg-red-50",textColor:"text-red-700"};default:return{icon:t.jsx(S,{className:"w-4 h-4"}),text:"Not saved",color:"text-secondary-theme bg-secondary-100",textColor:"text-secondary-theme"}}})();return t.jsx("div",{className:`flex items-center justify-center w-8 h-8 rounded-full border transition-all duration-200 ${n} ${r}`,children:t.jsx("div",{className:i,title:o,children:s})})}function Pt({content:e,className:r=""}){return t.jsx("div",{className:`prose prose-sm max-w-none ${r}`,dangerouslySetInnerHTML:{__html:(e=>{let t=e;return t=t.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),t=t.replace(new RegExp("(?<!\\*)\\*([^*]+)\\*(?!\\*)","g"),"<em>$1</em>"),t=t.replace(/`([^`]+)`/g,'<code class="bg-tertiary px-1 py-0.5 rounded text-sm font-mono">$1</code>'),t=t.replace(/^## (.*$)/gm,'<h2 class="text-lg font-semibold mt-4 mb-2">$1</h2>'),t=t.replace(/^### (.*$)/gm,'<h3 class="text-md font-semibold mt-3 mb-2">$1</h3>'),t=t.replace(/^â€¢ (.*$)/gm,'<li class="ml-4 list-disc">$1</li>'),t=t.replace(/(<li.*?<\/li>(?:\s*<li.*?<\/li>)*)/gs,'<ul class="space-y-1 my-2">$1</ul>'),t=t.replace(/\[([^\]]+)\]\(([^)]+)\)/g,'<a href="$2" target="_blank" rel="noopener noreferrer" class="text-blue-600 underline hover:text-blue-800">$1</a>'),t=t.replace(/\n\n/g,'</p><p class="mb-2">'),t=`<p class="mb-2">${t}</p>`,t})(e)}})}function It({isOpen:r,onClose:a}){var s;const{state:o,dispatch:i}=We(),{state:l}=Je(),d=()=>{var e;return`${M.avatar} **${M.name} - ${M.specialty}**\n\n${M.description}\n\n**ðŸŽ¯ MY SPECIALTIES:**\n${M.skills.map((e=>`â€¢ ${e}`)).join("\n")}\n\n**ðŸ’¡ TRY THESE PROMPTS:**\n${M.examples.map((e=>`â€¢ "${e}"`)).join("\n")}\n\nCurrent Project: **${(null==(e=o.currentProject)?void 0:e.title)||"Untitled"}** (${o.panels.length} panels)\n\nI'm ready to help with your ${M.specialty.toLowerCase()}! What can we create together?`},[m,p]=e.useState([]),[u,y]=e.useState(""),[x,f]=e.useState(!1),[b,v]=e.useState(!1),[w,j]=e.useState(""),[N,k]=e.useState(!1),[I,T]=e.useState(!1),[E,D]=e.useState(!1),[M,L]=e.useState(bt[0]),[O,z]=e.useState({status:"idle"}),[R,U]=e.useState(null),[W,_]=e.useState([]),[B,H]=e.useState(!1),[G,q]=e.useState(!1),[V,Y]=e.useState(null),[Q,X]=e.useState([]),[ee,re]=e.useState(""),[se,oe]=e.useState([]),[ne,le]=e.useState(null),[ce,de]=e.useState(""),[me,pe]=e.useState({model:"dall-e-3",size:"1024x1024",quality:"standard",style:"photorealistic",artStyle:"cinematic",lighting:"natural",mood:"neutral",colorScheme:"full-color",aspectRatio:"16:9",creativity:7}),he=e.useRef(null);e.useEffect((()=>{R||(p([{id:"1",type:"assistant",content:d(),timestamp:new Date,agentId:M.id}]),z({status:"idle"}))}),[M,null==(s=o.currentProject)?void 0:s.title,o.panels.length]),e.useEffect((()=>{var e;null==(e=he.current)||e.scrollIntoView({behavior:"smooth"})}),[m]),e.useEffect((()=>{const e=localStorage.getItem("openai-api-key");e&&tt.setApiKey(e);const t=localStorage.getItem("ai-agent-favorites");t&&_(JSON.parse(t))}),[]),e.useEffect((()=>{if("history"===V){const e=Ct.getAllChats();X(e)}}),[V]),e.useEffect((()=>{let e=Q;ee&&(e=e.filter((e=>{var t;return e.name.toLowerCase().includes(ee.toLowerCase())||e.agentName.toLowerCase().includes(ee.toLowerCase())||(null==(t=e.projectName)?void 0:t.toLowerCase().includes(ee.toLowerCase()))||e.messages.some((e=>e.content.toLowerCase().includes(ee.toLowerCase())))}))),oe(e)}),[Q,ee]);const ue=()=>{if(w.trim()){tt.setApiKey(w.trim()),localStorage.setItem("openai-api-key",w.trim()),j(""),v(!1);const e={id:Date.now().toString(),type:"assistant",content:"ðŸ”‘ **API Key Saved!** I'm now ready to help you with advanced AI features like generating storyboards, editing panels, and creating video prompts!",timestamp:new Date,agentId:M.id};p((t=>[...t,e]))}},ge=async e=>{var t,r,a;try{const s={projectTitle:(null==(t=o.currentProject)?void 0:t.title)||"Untitled Storyboard",projectDescription:(null==(r=o.currentProject)?void 0:r.description)||"No description",panelCount:o.panels.length,totalDuration:o.panels.reduce(((e,t)=>e+(t.duration||0)),0),currentPanel:o.selectedPanel?o.panels.find((e=>e.id===o.selectedPanel)):null,allPanels:o.panels.map(((e,t)=>({number:t+1,title:e.title,description:e.description,shotType:e.shotType,cameraAngle:e.cameraAngle,duration:e.duration,notes:e.notes||"No notes"}))),directorNotes:null==(a=o.currentProject)?void 0:a.directorNotes},n=m.slice(-8).filter((e=>"system"!==e.type)).map((e=>({role:"user"===e.type?"user":"assistant",content:e.content})));n.push({role:"user",content:e});const i={...s,agentPersonality:M.prompt};return await tt.sendMessage(n,i)}catch(s){return console.error("AI service error:",s),ye(e)}},ye=e=>{var t,r;const a=e.toLowerCase(),s=o.panels.length>0||(null==(t=o.currentProject)?void 0:t.title),n=(null==(r=o.currentProject)?void 0:r.title)||"your project";return a.includes("storyboard")||a.includes("generate")?`ðŸŽ¬ **Storyboard Generation**\n\nI'd love to help you create a professional storyboard! ${s?`I see you're working on "${n}" with ${o.panels.length} panels.`:""}\n\nHere's what I can do once you add your OpenAI API key:\nâ€¢ **Generate** complete storyboards from story ideas\nâ€¢ **Enhance** existing panels with better descriptions\nâ€¢ **Add** new scenes with cinematic details\nâ€¢ **Create** video prompts for each panel\n\n**Quick Start:** Add your API key in Settings, then tell me your story idea!`:a.includes("panel")||a.includes("scene")?`ðŸŽ¥ **Panel & Scene Management**\n\n${s?`Your "${n}" currently has ${o.panels.length} panels.`:"No panels created yet."}\n\nI can help you:\nâ€¢ **Add** new cinematic panels\nâ€¢ **Edit** existing scene descriptions  \nâ€¢ **Enhance** shot compositions\nâ€¢ **Optimize** story flow and pacing\n\n**Need Ideas?** Try: "Add a dramatic close-up scene" or "Enhance panel 3 with better lighting"`:a.includes("video")||a.includes("prompt")?`ðŸ“¹ **Video Prompt Generation**\n\nTransform your storyboard into video prompts! ${s?`Ready to process ${o.panels.length} panels.`:"Create some panels first."}\n\nI can generate:\nâ€¢ **Detailed** video descriptions\nâ€¢ **Technical** camera specifications\nâ€¢ **Professional** filming instructions\nâ€¢ **Creative** visual effects notes\n\n**Pro Tip:** Each panel becomes a detailed video prompt perfect for AI video generation!`:(s?`I see you're working on "${n}" - that's awesome!`:"Ready to create something amazing?")+" \n\nI'm having trouble connecting to my AI servers right now, but I can still help you get organized:\n\nQuick options:\nâ€¢ **Projects** - Save and manage your work\nâ€¢ **Templates** - Start with professional layouts\nâ€¢ **New Project** - Fresh creative start\n\nOnce I'm back online, just tell me your story ideas and I'll help bring them to life with storyboards, video prompts, and all the creative tools you need!\n\nWhat sounds good to you?"},xe=async()=>{if(!u.trim()||x)return;const e={id:Date.now().toString(),type:"user",content:u.trim(),timestamp:new Date,agentId:M.id};p((t=>[...t,e])),y(""),f(!0);try{const t=e.content.toLowerCase();console.log("ðŸ” Analyzing user input:",t),await je(e.content,e.content),console.log("ðŸ’¬ No actions detected, sending to AI for conversation");const r=await ge(e.content),a=t.includes("all")||t.includes("batch")||t.includes("every")||t.includes("entire");if(t.includes("generate")&&t.includes("storyboard"))return console.log("ðŸ”§ Fallback: Triggering storyboard generation"),void(await fe(e.content));if(t.includes("add")&&(t.includes("panel")||t.includes("scene")))return console.log("ðŸ”§ Fallback: Triggering panel addition"),void(await we(e.content));if(t.includes("edit")&&t.includes("panel")&&!a){if(console.log("ðŸ”§ Fallback: Triggering single panel edit"),o.panels.length>0){const r=t.match(/panel (\d+)/i);if(!r){const t=o.panels[o.panels.length-1];return void(await be(t.id,e.content))}{const t=parseInt(r[1]),a=o.panels[t-1];if(a)return void(await be(a.id,e.content))}}}else if(t.includes("video")&&t.includes("prompt"))return console.log("ðŸ”§ Fallback: Triggering video prompts"),void(await ve());console.log("ðŸ’¬ Showing regular AI response");const s=r,n={id:(Date.now()+1).toString(),type:"assistant",content:s,timestamp:new Date,agentId:M.id};p((e=>[...e,n]))}catch(t){console.error("âŒ Error in handleSendMessage:",t);const e={id:(Date.now()+1).toString(),type:"system",content:"Sorry, I encountered an error. Please try again or check the server connection.",timestamp:new Date,agentId:M.id};p((t=>[...t,e]))}finally{f(!1)}},fe=async(e,t=6)=>{f(!0);try{const r=await tt.generateStoryboard(e,t,"drama");i({type:"SET_PANELS",payload:[]}),r.forEach(((e,t)=>{const r={...e,order:t};i({type:"ADD_PANEL",payload:r})}));const a={id:Date.now().toString(),type:"assistant",content:`ðŸŽ¬ **Storyboard Generated!** I've created ${r.length} professional panels for your story. Each panel includes:\n\nâ€¢ Cinematic shot composition\nâ€¢ Professional camera angles\nâ€¢ Director's notes\nâ€¢ Optimal timing\n\nYou can now edit individual panels, generate video prompts, or ask me to refine specific scenes!`,timestamp:new Date,agentId:M.id};p((e=>[...e,a]))}catch(r){const e={id:Date.now().toString(),type:"system",content:"Failed to generate storyboard. Please check your API key or try again.",timestamp:new Date,agentId:M.id};p((t=>[...t,e]))}finally{f(!1)}},be=async(e,t)=>{const r=o.panels.find((t=>t.id===e));if(r){f(!0);try{if(tt.isReady()){const a=await tt.generateScene(`${r.description}. ${t}`,r.shotType,r.cameraAngle,"enhanced"),s={title:a.title||r.title,description:a.description||r.description,shotType:a.shotType||r.shotType,cameraAngle:a.cameraAngle||r.cameraAngle,notes:a.notes||r.notes,duration:r.duration,updatedAt:new Date};i({type:"UPDATE_PANEL",payload:{id:e,updates:s}});const o={id:Date.now().toString(),type:"assistant",content:`âœ… **Panel Updated!** I've enhanced "${r.title}" based on your instructions. The panel now features improved cinematography and storytelling elements.`,timestamp:new Date,agentId:M.id};p((e=>[...e,o]))}else{const a={description:`${r.description} (Updated: ${t})`,notes:`${r.notes} | AI Enhancement: ${t}`,updatedAt:new Date};i({type:"UPDATE_PANEL",payload:{id:e,updates:a}});const s={id:Date.now().toString(),type:"assistant",content:`âœ… **Panel Updated!** I've applied your instructions to "${r.title}". For enhanced AI editing, add your OpenAI API key.`,timestamp:new Date,agentId:M.id};p((e=>[...e,s]))}}catch(a){const e={id:Date.now().toString(),type:"system",content:"Failed to edit panel. Please try again.",timestamp:new Date,agentId:M.id};p((t=>[...t,e]))}finally{f(!1)}}},ve=()=>{const e={id:`test-${Date.now()}`,type:"assistant",content:"ðŸŽ¬ Video prompts feature is working! This is a test message.",timestamp:new Date,agentId:M.id};p((t=>[...t,e]))},we=async e=>{f(!0);try{let t;if(tt.isReady()){const r=await tt.generateScene(e,"medium-shot","eye-level","professional");t={id:`panel-${Date.now()}`,title:r.title||`Panel ${o.panels.length+1}`,description:r.description||e,shotType:r.shotType||"medium-shot",cameraAngle:r.cameraAngle||"eye-level",notes:r.notes||"",duration:4,order:o.panels.length,createdAt:new Date,updatedAt:new Date,videoPrompt:r.videoPrompt}}else t={id:`panel-${Date.now()}`,title:`Panel ${o.panels.length+1}`,description:e,shotType:"medium-shot",cameraAngle:"eye-level",notes:"Manually created panel - enhance with AI by adding your OpenAI key",duration:4,order:o.panels.length,createdAt:new Date,updatedAt:new Date};i({type:"ADD_PANEL",payload:t});const r={id:Date.now().toString(),type:"assistant",content:`âœ… **Panel Added!** Created "${t.title}" ${tt.isReady()?"with AI-enhanced cinematography":"with basic setup"}. Panel ${o.panels.length+1} is ready for your story!`,timestamp:new Date,agentId:M.id};p((e=>[...e,r]))}catch(t){const e={id:Date.now().toString(),type:"system",content:"Failed to add panel. Please try again.",timestamp:new Date,agentId:M.id};p((t=>[...t,e]))}finally{f(!1)}},je=async(e,t)=>{console.log("ðŸŽ¬ PROCESSING AI ACTIONS:",{response:e.substring(0,200)+"...",originalUserInput:t});const r=/\[ACTION:([^:]+):([^\]]*)\]/g,a=[];let s;for(;null!==(s=r.exec(e));){const e=s[1].trim(),t=s[2].trim();a.push({type:e,params:t}),console.log("ðŸ” Found action:",{type:e,params:t})}if(console.log("ðŸ“‹ Total actions found:",a.length),0===a.length)return void console.log("âš ï¸ No actions found in response, showing as regular message");for(const c of a){console.log("ðŸš€ Executing action:",c.type,"with params:",c.params);try{switch(c.type){case"generate_storyboard":console.log("ðŸ“ Generating storyboard..."),await fe(c.params||t);break;case"add_panel":console.log("âž• Adding panel..."),await we(c.params||t);break;case"edit_panel":if(console.log("âœï¸ Editing panel..."),o.panels.length>0){const e=o.panels[o.panels.length-1];await be(e.id,c.params||t)}break;case"remove_panel":console.log("ðŸ—‘ï¸ Removing panel...");const e=parseInt(c.params)||o.panels.length;if(e>0&&e<=o.panels.length){const t=o.panels[e-1];i({type:"DELETE_PANEL",payload:t.id})}break;case"analyze_storyboard":console.log("ðŸ” Analyzing storyboard..."),await Le();break;case"generate_video_prompts":console.log("ðŸŽ¥ Generating video prompts..."),await ve();break;case"update_director_notes":console.log("ðŸ“‹ Updating director notes..."),o.currentProject&&i({type:"SET_PROJECT",payload:{...o.currentProject,directorNotes:c.params}});break;case"batch_edit":console.log("ðŸŽ¬ BATCH EDIT: Processing all panels..."),await Ne(c.params||t);break;case"batch_edit_range":console.log("ðŸŽ¬ BATCH EDIT RANGE: Processing panel range...");const r=c.params.split(":");if(r.length>=3){const e=parseInt(r[0])-1,t=parseInt(r[1])-1,a=r.slice(2).join(":");await Me(e,t,a)}else await Ne(c.params||t);break;case"batch_apply_style":console.log("ðŸŽ¨ BATCH APPLY STYLE: Applying style to all panels...");const a=c.params.split(":");if(a.length>=2){const e=a[0],t=a.slice(1).join(":");await Ee(e,t)}else await Ne(`apply ${c.params} style to all panels`);break;case"enhance_all_cinematography":console.log("ðŸ“¸ ENHANCE ALL CINEMATOGRAPHY: Improving all panels..."),await De(c.params||"enhance cinematography with professional techniques");break;case"standardize_shot_types":console.log("ðŸŽ¯ STANDARDIZE SHOT TYPES: Optimizing shot progression..."),await $e(c.params||"optimize shot types for better visual flow");break;default:console.warn("âš ï¸ Unknown action type:",c.type),c.params&&(c.params.includes("all")||c.params.includes("every"))&&(console.log("ðŸ”„ Interpreting unknown action as batch edit..."),await Ne(`${c.type}: ${c.params}`||t))}console.log("âœ… Action completed:",c.type)}catch(l){console.error(`âŒ Error executing action ${c.type}:`,l);const e={id:Date.now().toString(),type:"assistant",content:`âŒ **Action Failed** - I encountered an error while trying to ${c.type.replace("_"," ")}. ${l instanceof Error?l.message:"Please try again or check your settings."}`,timestamp:new Date,agentId:M.id};p((t=>[...t,e]))}}const n=e.replace(/\[ACTION:[^\]]+\]/g,"").trim();if(n){console.log("ðŸ’¬ Showing cleaned response alongside actions");const e={id:Date.now().toString(),type:"assistant",content:n,timestamp:new Date,agentId:M.id};p((t=>[...t,e]))}console.log("ðŸŽ‰ All AI actions processed successfully")},Ne=async e=>{var t,r,a,s,n,l,c;f(!0),console.log("ðŸš€ BATCH EDIT STARTED:",{instructions:e,panelCount:o.panels.length,hasApiKey:tt.isReady(),projectTitle:null==(t=o.currentProject)?void 0:t.title});try{if(!tt.isReady()){console.log("âŒ No API key available");const e={id:Date.now().toString(),type:"assistant",content:"ðŸ”‘ **API Key Required** - I need an OpenAI API key to perform batch edits. Please add your key in Settings.",timestamp:new Date,agentId:M.id};return void p((t=>[...t,e]))}if(0===o.panels.length){console.log("âŒ No panels to edit");const e={id:Date.now().toString(),type:"assistant",content:"ðŸ“ **No Panels to Edit** - Create some storyboard panels first, then I can help you batch edit them!",timestamp:new Date,agentId:M.id};return void p((t=>[...t,e]))}console.log("ðŸ”„ Starting batch edit for",o.panels.length,"panels with instructions:",e);const t={id:Date.now().toString(),type:"assistant",content:`ðŸŽ¬ **Batch Edit Starting...** \n\nProcessing ${o.panels.length} panels with: "${e}"\n\nThis may take a moment as I enhance each panel with AI. Please wait...`,timestamp:new Date,agentId:M.id};p((e=>[...e,t]));const m=`Apply these batch edits to ALL storyboard panels. For each panel, provide the enhanced version:\n\nINSTRUCTIONS: ${e}\n\nPROJECT CONTEXT:\n- Title: ${null==(r=o.currentProject)?void 0:r.title}\n- Description: ${null==(a=o.currentProject)?void 0:a.description}\n- Director Notes: ${null==(s=o.currentProject)?void 0:s.directorNotes}\n- Total Panels: ${o.panels.length}\n\nCURRENT PANELS:\n${o.panels.map(((e,t)=>`Panel ${t+1}:\n  Title: ${e.title}\n  Description: ${e.description}\n  Shot Type: ${e.shotType}\n  Camera Angle: ${e.cameraAngle}\n  Notes: ${e.notes}`)).join("\n\n")}\n\nReturn a JSON array with exactly ${o.panels.length} updated panels. Each panel object should have:\n- title: enhanced title\n- description: enhanced description  \n- notes: enhanced director notes\n- shotType: appropriate shot type from [wide-shot, medium-shot, close-up, extreme-close-up, over-the-shoulder, two-shot, establishing-shot]\n- cameraAngle: appropriate camera angle from [eye-level, high-angle, low-angle, birds-eye-view, worms-eye-view, dutch-angle]\n\nApply the requested changes "${e}" while maintaining story flow and continuity. Return ONLY the JSON array, no other text.\n\nExample format:\n[\n  {\n    "title": "Enhanced Panel Title",\n    "description": "Enhanced detailed description with improvements",\n    "notes": "Enhanced director notes with specific guidance",\n    "shotType": "medium-shot",\n    "cameraAngle": "eye-level"\n  }\n]`;console.log("ðŸ“¤ Sending batch request to AI...");const h=await tt.sendMessage([{role:"user",content:m}],{projectTitle:(null==(n=o.currentProject)?void 0:n.title)||"",projectDescription:(null==(l=o.currentProject)?void 0:l.description)||"",panelCount:o.panels.length,totalDuration:o.panels.reduce(((e,t)=>e+(t.duration||0)),0),allPanels:o.panels.map(((e,t)=>({number:t+1,title:e.title,description:e.description,shotType:e.shotType,cameraAngle:e.cameraAngle,duration:e.duration,notes:e.notes}))),directorNotes:null==(c=o.currentProject)?void 0:c.directorNotes});console.log("ðŸ“¥ AI batch response received:",h);try{let t=h.trim();console.log("ðŸ” Original response length:",t.length),t.includes("```json")?(console.log("ðŸ“ Extracting from markdown json block"),t=t.split("```json")[1].split("```")[0].trim()):t.includes("```")&&(console.log("ðŸ“ Extracting from markdown block"),t=t.split("```")[1].split("```")[0].trim());const r=t.indexOf("["),a=t.lastIndexOf("]");-1!==r&&-1!==a&&r<a&&(console.log("ðŸ“ Extracting JSON array from response"),t=t.substring(r,a+1)),t=t.replace(/^[^[\{]*/,"").replace(/[^\]\}]*$/,""),console.log("ðŸ“ Cleaned JSON text (first 200 chars):",t.substring(0,200)),console.log("ðŸ“ Cleaned JSON text (last 100 chars):",t.substring(Math.max(0,t.length-100)));const s=JSON.parse(t);if(console.log("âœ… Successfully parsed JSON, received:",s.length,"panels"),!Array.isArray(s)||s.length!==o.panels.length)throw console.error("âŒ Invalid response format:",{isArray:Array.isArray(s),receivedLength:null==s?void 0:s.length,expectedLength:o.panels.length}),new Error(`Invalid response format: expected ${o.panels.length} panels, got ${(null==s?void 0:s.length)||0}`);{console.log("âœ… Valid panel updates received, applying changes...");let t=0;for(let e=0;e<o.panels.length;e++){const r=o.panels[e],a=s[e];a&&"object"==typeof a?(console.log(`ðŸ“ Updating panel ${e+1}:`,{oldTitle:r.title,newTitle:a.title,hasDescription:!!a.description,hasNotes:!!a.notes}),i({type:"UPDATE_PANEL",payload:{id:r.id,updates:{title:a.title||r.title,description:a.description||r.description,notes:a.notes||r.notes,shotType:a.shotType||r.shotType,cameraAngle:a.cameraAngle||r.cameraAngle,updatedAt:new Date}}}),t++):console.warn(`âš ï¸ Invalid panel data for panel ${e+1}:`,a)}console.log("âœ… Batch edit completed successfully:",t,"panels updated");const r={id:Date.now().toString(),type:"assistant",content:`ðŸŽ¬ **Batch Edit Complete!** \n\nâœ… Successfully updated **${t}** panels with: "${e}"\n\nAll panels have been enhanced while maintaining story flow and continuity. Check your storyboard to see the improvements!\n\n**What was enhanced:**\nâ€¢ Improved titles and descriptions\nâ€¢ Enhanced director notes\nâ€¢ Optimized shot types and camera angles\nâ€¢ Applied consistent style modifications`,timestamp:new Date,agentId:M.id};p((e=>[...e,r]))}}catch(d){console.error("âŒ Failed to parse batch response:",d),console.log("ðŸ“„ Raw response that failed to parse:",h),console.log("ðŸ”„ Switching to individual panel processing fallback..."),await ke(e)}}catch(m){console.error("âŒ Error in batch editing panels:",m),await ke(e)}finally{f(!1)}},ke=async e=>{console.log("ðŸ”„ FALLBACK: Processing panels individually...");const t={id:Date.now().toString(),type:"assistant",content:`ðŸ”„ **Switching to Individual Processing...** \n\nThe batch process hit a snag, so I'm now enhancing each panel individually with AI. This ensures every panel gets the attention it deserves!\n\nProcessing "${e}" on ${o.panels.length} panels...`,timestamp:new Date,agentId:M.id};p((e=>[...e,t]));let r=0,a=0;for(let l=0;l<o.panels.length;l++){const t=o.panels[l];console.log(`ðŸ”„ Processing panel ${l+1}/${o.panels.length}: ${t.title}`);try{l>0&&(console.log("â±ï¸ Rate limiting: waiting 1 second..."),await new Promise((e=>setTimeout(e,1e3))));const s=await tt.generateScene(`${e}. Current panel: "${t.title}" - ${t.description}. Director notes: ${t.notes}`,t.shotType,t.cameraAngle,"enhanced");s&&(s.title||s.description)?(console.log(`âœ… Enhanced panel ${l+1}:`,{originalTitle:t.title,newTitle:s.title,hasNewDescription:!!s.description}),i({type:"UPDATE_PANEL",payload:{id:t.id,updates:{title:s.title||t.title,description:s.description||t.description,notes:s.notes||t.notes,shotType:s.shotType||t.shotType,cameraAngle:s.cameraAngle||t.cameraAngle,updatedAt:new Date}}}),a++):console.warn(`âš ï¸ No enhancements generated for panel ${l+1}`),r++}catch(n){console.error(`âŒ Failed to process panel ${l+1}:`,n),r++}}console.log(`âœ… Fallback processing complete: ${a}/${r} panels enhanced`);const s={id:Date.now().toString(),type:"assistant",content:`ðŸŽ¬ **Individual Processing Complete!** \n\nâœ… Successfully enhanced **${a}** out of **${r}** panels with: "${e}"\n\n${a===r?"ðŸŽ‰ All panels were successfully enhanced!":`âš ï¸ ${r-a} panels couldn't be enhanced, but they remain unchanged.`}\n\nYour storyboard now has improved panels with the requested modifications!`,timestamp:new Date,agentId:M.id};p((e=>[...e,s]))},Ce=e=>{L(e),T(!1),H(!1),(m.length>1||R)&&Ie(),R||p([{id:"1",type:"assistant",content:d(),timestamp:new Date,agentId:e.id}]),localStorage.setItem("preferred-ai-agent",e.id)},Ae=()=>{if(ne&&ce.trim()){if(Ct.renameChat(ne,ce.trim())){const e=Ct.getAllChats();X(e)}}le(null),de("")},Se=()=>{le(null),de("")},Pe=e=>{const t=((new Date).getTime()-e.getTime())/36e5;return t<1?"Just now":t<24?`${Math.floor(t)}h ago`:t<168?`${Math.floor(t/24)}d ago`:e.toLocaleDateString()};e.useEffect((()=>{const e=localStorage.getItem("selected-ai-agent");if(e)try{const t=JSON.parse(e);L(t)}catch(t){console.warn("Failed to load saved agent:",t)}}),[]),e.useEffect((()=>{m.length>1&&Ie()}),[m,M]);const Ie=async()=>{var e,t;try{z({status:"saving"});const r=m.filter((e=>"user"===e.type)).length,a=r>0&&r%3==0,s=await Ct.saveChat(m,M,null==(e=o.currentProject)?void 0:e.id,null==(t=o.currentProject)?void 0:t.title,R||void 0,a);R||U(s.id),z({status:"saved",lastSaved:new Date})}catch(r){console.error("Failed to auto-save chat:",r),z({status:"error",error:r instanceof Error?r.message:"Save failed"}),setTimeout((()=>{z((e=>({...e,status:"saved",lastSaved:new Date})))}),5e3)}},Te=e=>{p(e.messages),U(e.id);const t=wt(e.agentId);t&&L(t),z({status:"saved",lastSaved:e.updatedAt})},Ee=async(e,t)=>{f(!0);try{let a=0;for(let s=0;s<o.panels.length;s++){const n=o.panels[s];try{const r=`Apply ${e} style to this scene: ${n.description}. ${t}`,l=await tt.generateScene(r,n.shotType,n.cameraAngle,e);l&&l.description&&(i({type:"UPDATE_PANEL",payload:{id:n.id,updates:{title:l.title||n.title,description:l.description,notes:`${e} style: ${l.notes||n.notes}`,updatedAt:new Date}}}),a++),s<o.panels.length-1&&await new Promise((e=>setTimeout(e,400)))}catch(r){console.error(`âŒ Failed to apply style to panel ${s+1}:`,r)}}}catch(a){console.error("âŒ Error applying style:",a)}finally{f(!1)}},De=async e=>{f(!0);try{let r=0;const a=["close-up","medium-shot","wide-shot","extreme-close-up","long-shot"],s=["eye-level","high-angle","low-angle","bird-eye","worm-eye","dutch-angle"];for(let n=0;n<o.panels.length;n++){const l=o.panels[n];try{const t=a[n%a.length],c=s[n%s.length],d=`Enhance the cinematography: ${l.description}. ${e}`,m=await tt.analyzeCinematography(d);if(m&&"object"==typeof m){const a=`Lighting: ${m.lighting||"N/A"}. Performance: ${m.performance||"N/A"}. Camera Movement: ${m.cameraMovement||"N/A"}. Composition: ${m.composition||"N/A"}. Sound: ${m.sound||"N/A"}.`,s={title:l.title,description:a,notes:`Enhanced cinematography: ${e}`,shotType:t,cameraAngle:c,updatedAt:new Date};i({type:"UPDATE_PANEL",payload:{id:l.id,updates:s}}),r++}n<o.panels.length-1&&await new Promise((e=>setTimeout(e,500)))}catch(t){console.error(`âŒ Failed to enhance cinematography for panel ${n+1}:`,t)}}}catch(r){console.error("âŒ Error enhancing cinematography:",r)}finally{f(!1)}},$e=async e=>{f(!0);try{const e=[];for(let t=0;t<o.panels.length;t++)0===t?e.push("wide-shot"):t===o.panels.length-1?e.push("close-up"):t%3==0?e.push("wide-shot"):t%3==1?e.push("medium-shot"):e.push("close-up");let r=0;for(let a=0;a<o.panels.length;a++){const s=o.panels[a],n=e[a];if(s.shotType!==n)try{i({type:"UPDATE_PANEL",payload:{id:s.id,updates:{shotType:n,notes:`Standardized shot type: ${s.notes||""}`,updatedAt:new Date}}}),r++}catch(t){console.error(`âŒ Failed to standardize panel ${a+1}:`,t)}}}catch(r){console.error("âŒ Error standardizing shot types:",r)}finally{f(!1)}},Me=async(e,t,r)=>{if(e<0||t>=o.panels.length||e>t)return void console.error("âŒ Invalid range for batch edit");const a=o.panels.slice(e,t+1);for(let o=0;o<a.length;o++){const t=a[o];try{const e=await tt.generateScene(`${r}. Current panel: "${t.title}" - ${t.description}`,t.shotType,t.cameraAngle,"enhanced");e&&(e.title||e.description)&&i({type:"UPDATE_PANEL",payload:{id:t.id,updates:{title:e.title||t.title,description:e.description||t.description,notes:e.notes||t.notes,shotType:e.shotType||t.shotType,cameraAngle:e.cameraAngle||t.cameraAngle,updatedAt:new Date}}}),o<a.length-1&&await new Promise((e=>setTimeout(e,1e3)))}catch(s){console.error(`âŒ Failed to process panel ${e+o+1}:`,s)}}},Le=async()=>{var e;if(0!==o.panels.length){f(!0);try{const t=o.panels.map(((e,t)=>`Panel ${t+1}: ${e.title} - ${e.description} (${e.shotType}, ${e.cameraAngle}, ${e.duration}s)`)).join("\n"),r=`Analyze this storyboard and provide professional feedback:\n\nPROJECT: ${(null==(e=o.currentProject)?void 0:e.title)||"Untitled"}\nTOTAL PANELS: ${o.panels.length}\n\nSTORYBOARD:\n${t}\n\nPlease provide:\n1. Story structure analysis\n2. Visual flow and pacing assessment  \n3. Shot variety and composition feedback\n4. Suggestions for improvement\n5. Professional filmmaking recommendations\n\nFocus on storytelling effectiveness and cinematic quality.`,a=await ge(r),s={id:Date.now().toString(),type:"assistant",content:`ðŸ“Š **Storyboard Analysis**\n\n${a}`,timestamp:new Date,agentId:M.id};p((e=>[...e,s]))}catch(t){const e={id:Date.now().toString(),type:"system",content:"Failed to analyze storyboard. Please try again.",timestamp:new Date,agentId:M.id};p((t=>[...t,e]))}finally{f(!1)}}else{const e={id:Date.now().toString(),type:"assistant",content:"Your storyboard is empty! Start by generating a storyboard or adding panels.",timestamp:new Date,agentId:M.id};p((t=>[...t,e]))}};return r?t.jsxs(t.Fragment,{children:[t.jsx(yt,{isOpen:r,title:`AI Assistant - ${M.name}`,subtitle:M.specialty,icon:t.jsx(c,{className:"w-5 h-5"}),defaultWidth:"340px",defaultHeight:"500px",minWidth:300,minHeight:350,maxWidth:"600px",maxHeight:"90vh",resizable:!0,minimizable:!0,maximizable:!0,windowId:"ai-assistant-main",zIndex:9050,onClose:a,children:t.jsxs("div",{className:"flex flex-col h-full",style:{backgroundColor:l.theme.colors.background.primary,color:l.theme.colors.text.primary},children:[t.jsxs("div",{className:"border-b flex-shrink-0 transition-all duration-300 "+(G?"shadow-sm":""),style:{backgroundColor:G?`${l.theme.colors.background.secondary}95`:l.theme.colors.background.secondary,borderColor:l.theme.colors.border.primary},children:[t.jsxs("div",{className:"flex items-center justify-between transition-all duration-200 "+(G?"p-1.5":"p-2"),children:[t.jsxs("div",{className:"flex items-center space-x-1.5",children:[t.jsx("div",{className:"w-6 h-6 rounded-lg flex items-center justify-center cursor-pointer hover:scale-105 transition-all duration-300 border",style:{backgroundColor:M.theme.primary,borderColor:l.theme.colors.border.primary},onClick:()=>T(!0),title:`Click to change agent - Currently: ${M.name}`,children:t.jsx("span",{className:"text-xs font-medium text-white",children:M.avatar})}),G?t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx("span",{className:"text-xs font-medium truncate max-w-[80px]",style:{color:l.theme.colors.text.primary},children:M.name}),W.length>0&&t.jsx("div",{className:"w-2 h-2 rounded-full animate-pulse",style:{backgroundColor:l.theme.colors.primary[400]},title:`${W.length} favorite agents available`})]}):t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center space-x-0.5",children:[t.jsx("h3",{className:"font-semibold text-xs truncate",style:{color:l.theme.colors.text.primary},children:M.name}),t.jsx("button",{onClick:()=>T(!0),className:"p-0.5 rounded transition-colors hover:bg-white/10",title:"Change AI Agent",style:{color:l.theme.colors.text.secondary},children:t.jsx(K,{className:"w-3 h-3"})})]}),t.jsx("span",{className:"text-xs truncate",style:{color:l.theme.colors.text.secondary},children:M.specialty})]})]}),t.jsxs("div",{className:"flex items-center space-x-0.5",children:[G&&t.jsxs("div",{className:"flex items-center space-x-0.5",children:[W.length>0&&t.jsx("button",{onClick:()=>T(!0),className:"text-xs p-1 rounded transition-all duration-200 hover:bg-white/10 hover:scale-110",title:"Quick access to favorite agents",style:{color:l.theme.colors.primary[500]},children:t.jsx(J,{className:"w-3 h-3 fill-current"})}),t.jsx("button",{onClick:()=>T(!0),className:"text-xs p-1 rounded transition-all duration-200 hover:bg-white/10 hover:scale-110",title:"Change agent",style:{color:l.theme.colors.text.secondary},children:t.jsx(K,{className:"w-3 h-3"})}),t.jsx("button",{onClick:()=>k(!0),className:"text-xs p-1 rounded transition-all duration-200 hover:bg-white/10 hover:scale-110",title:"Image settings",style:{color:l.theme.colors.text.secondary},children:t.jsx(g,{className:"w-3 h-3"})})]}),t.jsx("button",{onClick:()=>{const e=!G;q(e),e?(H(!1),Y(null)):W.length>0&&W.length<=3&&H(!0)},className:"text-xs p-1 rounded transition-all duration-200 hover:bg-white/10 hover:scale-110",title:G?"Expand header for more options":"Collapse header to save space",style:{color:l.theme.colors.text.secondary},children:G?t.jsx(A,{className:"w-3 h-3"}):t.jsx(C,{className:"w-3 h-3"})}),!G&&t.jsxs(t.Fragment,{children:[t.jsx(St,{saveState:O,className:"text-xs"}),W.length>0&&t.jsx("button",{onClick:()=>H(!B),className:"text-xs px-1.5 py-0.5 flex items-center space-x-0.5 transition-all duration-200 "+(B?"btn-primary":"btn-secondary"),title:"Quick switch favorite agents",children:t.jsx(J,{className:"w-3 h-3 "+(B?"fill-current":"")})})]}),t.jsxs("button",{onClick:()=>{p([{id:"1",type:"assistant",content:d(),timestamp:new Date,agentId:M.id}]),U(null),z({status:"idle"})},className:`btn-secondary text-xs ${G?"px-1 py-1":"px-1.5 py-0.5"} flex items-center space-x-0.5 transition-all duration-200`,title:"Start new chat",children:[t.jsx(h,{className:"w-3 h-3"}),!G&&t.jsx("span",{children:"New"})]})]})]}),!G&&t.jsx("div",{className:"px-2 pb-2 animate-slide-down",style:{backgroundColor:`${l.theme.colors.background.secondary}80`},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsxs("button",{onClick:()=>T(!0),className:"text-xs px-1.5 py-0.5 btn-secondary flex items-center space-x-0.5",title:"Change agent",children:[t.jsx(K,{className:"w-3 h-3"}),t.jsx("span",{children:"Agent"})]}),W.length>0&&t.jsxs("button",{onClick:()=>{H(!B),Y(null)},className:"text-xs px-1.5 py-0.5 flex items-center space-x-0.5 transition-all duration-200 "+(B?"btn-primary":"btn-secondary"),title:"Favorites",children:[t.jsx(J,{className:"w-3 h-3 "+(B?"fill-current":"")}),t.jsx("span",{children:"Fav"})]}),t.jsxs("button",{onClick:()=>{Y("history"===V?null:"history"),H(!1)},className:"text-xs px-1.5 py-0.5 flex items-center space-x-0.5 transition-all duration-200 "+("history"===V?"btn-primary":"btn-secondary"),title:"Chat history",children:[t.jsx(ae,{className:"w-3 h-3"}),t.jsx("span",{children:"History"})]})]}),t.jsx(St,{saveState:O,className:"text-xs"})]})}),!G&&B&&W.length>0&&t.jsx("div",{className:"px-2 pb-2 animate-slide-down",style:{backgroundColor:`${l.theme.colors.primary[50]}20`},children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h4",{className:"font-semibold text-xs",style:{color:l.theme.colors.text.primary},children:"â­ Favorite Agents"}),t.jsx("button",{onClick:()=>H(!1),className:"p-0.5 hover:bg-white/10 rounded transition-colors",style:{color:l.theme.colors.text.secondary},children:t.jsx(n,{className:"w-3 h-3"})})]}),t.jsxs("div",{className:"flex flex-wrap gap-1",children:[W.slice(0,6).map((e=>{const r=bt.find((t=>t.id===e));if(!r)return null;const a=r.id===M.id;return t.jsxs("button",{onClick:()=>(e=>{const t=bt.find((t=>t.id===e));t&&Ce(t)})(r.id),className:"flex items-center space-x-1 px-2 py-1 rounded-lg text-xs transition-all duration-200 hover:scale-105 touch-manipulation "+(a?"ring-2":""),style:{backgroundColor:a?`${r.theme.primary}40`:`${r.theme.primary}20`,color:a?r.theme.primary:l.theme.colors.text.primary,border:`1px solid ${r.theme.primary}50`,...a&&{ringColor:r.theme.primary}},title:`Switch to ${r.name} - ${r.specialty}`,children:[t.jsx("span",{className:"text-xs",children:r.avatar}),t.jsx("span",{className:"font-medium truncate max-w-[60px]",children:r.name}),a&&t.jsx("span",{className:"text-xs",children:"â€¢"})]},r.id)})),W.length>6&&t.jsx("button",{onClick:()=>T(!0),className:"flex items-center space-x-1 px-2 py-1 rounded-lg text-xs transition-all duration-200 hover:scale-105 border-dashed",style:{backgroundColor:`${l.theme.colors.background.secondary}50`,color:l.theme.colors.text.secondary,borderColor:l.theme.colors.border.primary},title:"View all favorites",children:t.jsxs("span",{children:["+",W.length-6]})})]}),t.jsx("div",{className:"text-xs",style:{color:l.theme.colors.text.secondary},children:"ðŸ’¡ Tip: Star agents in the selector to add them here"})]})}),!G&&"history"===V&&t.jsx("div",{className:"px-2 pb-2 animate-slide-down",style:{backgroundColor:`${l.theme.colors.background.secondary}40`},children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h4",{className:"font-semibold text-xs",style:{color:l.theme.colors.text.primary},children:["ðŸ“– Chat History (",Q.length,")"]}),t.jsx("button",{onClick:()=>Y(null),className:"p-0.5 hover:bg-white/10 rounded transition-colors",style:{color:l.theme.colors.text.secondary},children:t.jsx(n,{className:"w-3 h-3"})})]}),t.jsxs("div",{className:"relative",children:[t.jsx(Z,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 w-3 h-3",style:{color:l.theme.colors.text.secondary}}),t.jsx("input",{type:"text",value:ee,onChange:e=>re(e.target.value),placeholder:"Search chats...",className:"input-modern w-full text-xs pl-6 pr-2 py-1"})]}),t.jsxs("div",{className:"max-h-48 overflow-y-auto space-y-1",children:[0===se.length?t.jsx("div",{className:"text-xs text-center py-6",style:{color:l.theme.colors.text.secondary},children:0===Q.length?t.jsxs(t.Fragment,{children:["ðŸ’¡ No saved chats yet",t.jsx("br",{}),"Start a conversation to save your first chat"]}):"No chats match your search"}):se.slice(0,8).map((e=>{var r,a;const s=wt(e.agentId),o=(e=>{const t=wt(e);return(null==t?void 0:t.theme)||{primary:"#6366F1",secondary:"#818CF8",accent:"#E0E7FF",gradient:"from-indigo-600 to-purple-600"}})(e.agentId),n=e.id===R,i=ne===e.id;return t.jsx("div",{className:"relative p-2 rounded-lg border transition-all duration-200 hover:bg-white/5 "+(n?"ring-1":""),style:{backgroundColor:n?`${o.primary}20`:"transparent",borderColor:n?o.primary:l.theme.colors.border.primary,...n&&{ringColor:o.primary}},children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex-1 cursor-pointer",onClick:()=>(e=>{Te(e),Y(null)})(e),children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[t.jsx("span",{className:"text-xs",children:(null==s?void 0:s.avatar)||"ðŸ¤–"}),i?t.jsxs("div",{className:"flex-1 flex items-center space-x-1",children:[t.jsx("input",{type:"text",value:ce,onChange:e=>de(e.target.value),onKeyPress:e=>{"Enter"===e.key&&Ae(),"Escape"===e.key&&Se()},className:"flex-1 px-1 py-0.5 text-xs border rounded",style:{backgroundColor:l.theme.colors.background.secondary,borderColor:l.theme.colors.border.primary,color:l.theme.colors.text.primary},autoFocus:!0}),t.jsx("button",{onClick:Ae,className:"text-green-600 hover:text-green-700 text-xs",children:"âœ“"}),t.jsx("button",{onClick:Se,className:"text-red-600 hover:text-red-700 text-xs",children:"âœ•"})]}):t.jsxs("div",{className:"flex-1",children:[t.jsx("h5",{className:"font-medium text-xs truncate",style:{color:l.theme.colors.text.primary},children:e.name}),n&&t.jsx("span",{className:"text-xs px-1 py-0.5 rounded text-white",style:{backgroundColor:o.primary},children:"Current"})]})]}),t.jsxs("div",{className:"flex items-center space-x-1 text-xs ml-4",style:{color:l.theme.colors.text.secondary},children:[t.jsx(te,{className:"w-2.5 h-2.5"}),t.jsx("span",{children:e.agentName}),t.jsx("span",{children:"â€¢"}),t.jsx(S,{className:"w-2.5 h-2.5"}),t.jsx("span",{children:Pe(e.lastActivity)})]}),t.jsx("div",{className:"text-xs ml-4 mt-1 line-clamp-2",style:{color:l.theme.colors.text.secondary},children:e.messages.length>1?(null==(a=null==(r=e.messages.find((e=>"user"===e.type)))?void 0:r.content)?void 0:a.substring(0,60))+"...":"New conversation"})]}),t.jsxs("div",{className:"flex items-center space-x-0.5 ml-2",children:[t.jsx("button",{onClick:t=>{var r,a;t.stopPropagation(),r=e.id,a=e.name,le(r),de(a)},className:"p-0.5 hover:bg-white/10 rounded transition-colors",style:{color:l.theme.colors.text.secondary},title:"Rename chat",children:t.jsx($,{className:"w-2.5 h-2.5"})}),t.jsx("button",{onClick:t=>{t.stopPropagation(),(e=>{if(Ct.deleteChat(e)){const e=Ct.getAllChats();X(e)}})(e.id)},className:"p-0.5 hover:bg-red-100 rounded transition-colors text-red-600",title:"Delete chat",children:t.jsx(P,{className:"w-2.5 h-2.5"})})]})]})},e.id)})),se.length>8&&t.jsxs("div",{className:"text-xs text-center py-2",style:{color:l.theme.colors.text.secondary},children:["...and ",se.length-8," more"]})]})]})}),!G&&"settings"===V&&t.jsx("div",{className:"px-2 pb-2 animate-slide-down",style:{backgroundColor:`${l.theme.colors.background.secondary}40`},children:t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h4",{className:"font-semibold text-xs",style:{color:l.theme.colors.text.primary},children:"ðŸŽ¨ Image Settings"}),t.jsx("button",{onClick:()=>Y(null),className:"p-0.5 hover:bg-white/10 rounded transition-colors",style:{color:l.theme.colors.text.secondary},children:t.jsx(n,{className:"w-3 h-3"})})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium",style:{color:l.theme.colors.text.primary},children:"Model"}),t.jsxs("select",{value:me.model,onChange:e=>pe((t=>({...t,model:e.target.value}))),className:"input-modern w-full text-xs mt-0.5",children:[t.jsx("option",{value:"dall-e-3",children:"DALL-E 3 (Best Quality)"}),t.jsx("option",{value:"dall-e-2",children:"DALL-E 2 (Faster)"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium",style:{color:l.theme.colors.text.primary},children:"Style"}),t.jsxs("select",{value:me.style,onChange:e=>pe((t=>({...t,style:e.target.value}))),className:"input-modern w-full text-xs mt-0.5",children:[t.jsx("option",{value:"photorealistic",children:"Photorealistic"}),t.jsx("option",{value:"cinematic",children:"Cinematic"}),t.jsx("option",{value:"artistic",children:"Artistic"}),t.jsx("option",{value:"cartoon",children:"Cartoon"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"text-xs font-medium",style:{color:l.theme.colors.text.primary},children:"Quality"}),t.jsxs("select",{value:me.quality,onChange:e=>pe((t=>({...t,quality:e.target.value}))),className:"input-modern w-full text-xs mt-0.5",children:[t.jsx("option",{value:"standard",children:"Standard"}),t.jsx("option",{value:"hd",children:"HD (Higher Quality)"})]})]}),t.jsx("button",{onClick:()=>Y(null),className:"btn-primary text-xs px-2 py-1 w-full",children:"Apply Settings"})]})]})})]}),!tt.isReady()&&t.jsx("div",{className:"p-1.5 border-b flex-shrink-0",style:{backgroundColor:`${l.theme.colors.primary[100]}20`,borderColor:l.theme.colors.border.primary},children:t.jsxs("div",{className:"flex items-center space-x-1.5",children:[t.jsx("div",{className:"p-0.5 rounded",style:{backgroundColor:`${l.theme.colors.primary[500]}20`},children:t.jsx(g,{className:"w-3 h-3",style:{color:l.theme.colors.primary[500]}})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-xs font-medium",style:{color:l.theme.colors.text.primary},children:"Setup Required"}),t.jsx("p",{className:"text-xs",style:{color:l.theme.colors.text.secondary},children:"Add OpenAI API key"})]}),t.jsx("button",{onClick:()=>v(!0),className:"btn-primary text-xs px-1.5 py-0.5",children:"Add Key"})]})}),b&&t.jsx("div",{className:"p-2 border-b flex-shrink-0",style:{backgroundColor:l.theme.colors.background.secondary,borderColor:l.theme.colors.border.primary},children:t.jsxs("div",{className:"space-y-1.5",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-xs",style:{color:l.theme.colors.text.primary},children:"OpenAI API Key"}),t.jsx("p",{className:"text-xs",style:{color:l.theme.colors.text.secondary},children:"Required for AI features"})]}),t.jsx("button",{onClick:()=>v(!1),className:"p-0.5 hover:bg-white/10 rounded transition-colors",style:{color:l.theme.colors.text.secondary},children:t.jsx(n,{className:"w-3 h-3"})})]}),t.jsx("input",{type:"password",value:w,onChange:e=>j(e.target.value),placeholder:"sk-...",className:"input-modern w-full text-xs",onKeyPress:e=>"Enter"===e.key&&ue()}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-xs underline transition-colors",style:{color:l.theme.colors.primary[500]},children:"Get API key from OpenAI â†’"}),t.jsxs("div",{className:"flex space-x-1",children:[t.jsx("button",{onClick:()=>v(!1),className:"btn-secondary text-xs px-1.5 py-0.5",children:"Cancel"}),t.jsx("button",{onClick:ue,className:"btn-primary text-xs px-1.5 py-0.5",children:"Save Key"})]})]})]})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-1.5 space-y-1.5",style:{backgroundColor:l.theme.colors.background.primary},children:[m.map((e=>t.jsx("div",{className:`flex ${"user"===e.type?"justify-end":"justify-start"} animate-fade-in`,children:t.jsxs("div",{className:"max-w-[85%] rounded-lg shadow-sm transition-all duration-300 p-2 "+("user"===e.type?"ml-6":(e.type,"mr-6")),style:{backgroundColor:"user"===e.type?l.theme.colors.primary[500]:"system"===e.type?`${l.theme.colors.primary[100]}40`:l.theme.colors.background.secondary,color:"user"===e.type?"white":l.theme.colors.text.primary,borderColor:l.theme.colors.border.primary,border:"user"!==e.type?`1px solid ${l.theme.colors.border.primary}`:"none"},children:[t.jsx(Pt,{content:e.content,className:"text-xs leading-snug"}),t.jsxs("div",{className:"flex items-center justify-between mt-1 pt-1 border-t border-white/20",children:[t.jsx("p",{className:"text-xs opacity-70 font-medium",children:e.timestamp.toLocaleTimeString()}),"assistant"===e.type&&t.jsxs("div",{className:"flex items-center space-x-0.5",children:[t.jsx(J,{className:"w-3 h-3 opacity-50"}),t.jsx("span",{className:"text-xs opacity-70",children:"AI"})]})]})]})},e.id))),x&&t.jsx("div",{className:"flex justify-start animate-fade-in",children:t.jsx("div",{className:"p-2 rounded-lg border mr-6",style:{backgroundColor:l.theme.colors.background.secondary,borderColor:l.theme.colors.border.primary},children:t.jsxs("div",{className:"flex items-center space-x-1.5",children:[t.jsxs("div",{className:"flex space-x-0.5",children:[t.jsx("div",{className:"w-1.5 h-1.5 rounded-full animate-bounce",style:{backgroundColor:l.theme.colors.primary[400]}}),t.jsx("div",{className:"w-1.5 h-1.5 rounded-full animate-bounce",style:{backgroundColor:l.theme.colors.primary[400],animationDelay:"0.1s"}}),t.jsx("div",{className:"w-1.5 h-1.5 rounded-full animate-bounce",style:{backgroundColor:l.theme.colors.primary[400],animationDelay:"0.2s"}})]}),t.jsxs("span",{className:"text-xs font-medium",style:{color:l.theme.colors.text.secondary},children:[M.name," is thinking..."]})]})})}),t.jsx("div",{ref:he})]}),t.jsx("div",{className:"p-1.5 border-t flex-shrink-0",style:{backgroundColor:l.theme.colors.background.secondary,borderColor:l.theme.colors.border.primary},children:t.jsxs("div",{className:"space-y-1.5",children:[t.jsxs("div",{className:"flex items-end space-x-1.5",children:[t.jsx("div",{className:"flex-1 relative",children:t.jsx("textarea",{value:u,onChange:e=>y(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),xe())},placeholder:"Ask about storyboarding, scenes, or filmmaking...",className:"input-modern w-full text-xs resize-none",disabled:x,rows:u.includes("\n")?Math.min(u.split("\n").length,3):1,style:{minHeight:"32px",maxHeight:"72px"}})}),t.jsx("button",{onClick:xe,disabled:!u.trim()||x,className:"btn-primary p-1.5 flex items-center justify-center",style:{minHeight:"32px",minWidth:"32px"},children:x?t.jsx("div",{className:"w-3 h-3 border-2 border-white/30 border-t-white rounded-full animate-spin"}):t.jsx(ie,{className:"w-3 h-3"})})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-0.5 text-xs",style:{color:l.theme.colors.text.secondary},children:[t.jsx(F,{className:"w-3 h-3",style:{color:l.theme.colors.primary[500]}}),t.jsx("span",{children:"Shift+Enter for new line"})]}),!x&&u.trim()&&t.jsxs("div",{className:"flex items-center space-x-0.5 px-1.5 py-0.5 rounded text-xs font-medium",style:{backgroundColor:`${l.theme.colors.primary[100]}40`,color:l.theme.colors.primary[600]},children:[t.jsx("div",{className:"w-1.5 h-1.5 rounded-full",style:{backgroundColor:l.theme.colors.primary[500]}}),t.jsx("span",{children:"Ready"})]})]})]})})]})}),t.jsx(ft,{isOpen:N&&G,onClose:()=>k(!1),onSave:e=>{pe(e),k(!1)},currentSettings:me}),t.jsx(jt,{isOpen:I,onClose:()=>T(!1),onSelectAgent:Ce,currentAgent:M}),t.jsx(At,{isOpen:E&&G,onClose:()=>D(!1),onSelectChat:Te,currentChatId:R||void 0})]}):null}const Tt=[{value:"extreme-close-up",label:"Extreme Close-up",description:"Very tight framing on subject details"},{value:"close-up",label:"Close-up",description:"Tight framing focusing on subject"},{value:"medium-shot",label:"Medium Shot",description:"Subject from waist up"},{value:"wide-shot",label:"Wide Shot",description:"Subject and surroundings visible"},{value:"over-the-shoulder",label:"Over-the-shoulder",description:"Conversation perspective"},{value:"two-shot",label:"Two Shot",description:"Two subjects in frame"},{value:"establishing-shot",label:"Establishing Shot",description:"Sets scene location and context"}],Et=[{value:"eye-level",label:"Eye Level",description:"Camera at subject eye height"},{value:"high-angle",label:"High Angle",description:"Camera above subject looking down"},{value:"low-angle",label:"Low Angle",description:"Camera below subject looking up"},{value:"birds-eye-view",label:"Bird's Eye",description:"Directly overhead view"},{value:"worms-eye-view",label:"Worm's Eye",description:"Directly below looking up"},{value:"dutch-angle",label:"Dutch Angle",description:"Tilted camera for dramatic effect"}];function Dt({panel:r,isOpen:a,onClose:s}){const{dispatch:n}=We(),{state:i}=Je(),[l,c]=e.useState({title:"",description:"",shotType:"medium-shot",cameraAngle:"eye-level",notes:"",duration:3}),[m,p]=e.useState(!1),[h,u]=e.useState(!1);e.useEffect((()=>{r&&a?(u(!0),setTimeout((()=>{c({title:r.title||"",description:r.description||"",shotType:r.shotType||"medium-shot",cameraAngle:r.cameraAngle||"eye-level",notes:r.notes||"",duration:r.duration||3}),u(!1)}),100)):a&&!r&&u(!0)}),[r,a]),e.useEffect((()=>{a||(c({title:"",description:"",shotType:"medium-shot",cameraAngle:"eye-level",notes:"",duration:3}),p(!1),u(!1))}),[a]),e.useEffect((()=>{console.log("PanelEditor - Panel data:",r),console.log("PanelEditor - Is open:",a),console.log("PanelEditor - Form data:",l)}),[r,a,l]);const g=e=>{var t;const a=null==(t=e.target.files)?void 0:t[0];if(a&&r){const e=new FileReader;e.onload=e=>{var t;const a=null==(t=e.target)?void 0:t.result;n({type:"UPDATE_PANEL",payload:{id:r.id,updates:{imageUrl:a}}})},e.readAsDataURL(a)}},y=e=>{var t;const a=null==(t=e.target.files)?void 0:t[0];if(a&&r){const e=new FileReader;e.onload=e=>{var t;const a=null==(t=e.target)?void 0:t.result;n({type:"UPDATE_PANEL",payload:{id:r.id,updates:{videoUrl:a}}})},e.readAsDataURL(a)}};return a?a&&!r?t.jsx(yt,{isOpen:a,onClose:s,title:"Edit Panel",subtitle:"Loading...",icon:t.jsx(le,{className:"w-5 h-5"}),defaultWidth:"min(90vw, 1000px)",defaultHeight:"min(90vh, 800px)",maxWidth:"98vw",maxHeight:"98vh",resizable:!0,minimizable:!0,maximizable:!0,windowId:"panel-editor-loading",children:t.jsx("div",{className:"h-full flex items-center justify-center bg-primary",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full mx-auto mb-3"}),t.jsx("p",{className:"text-primary font-medium",children:"Loading panel data..."})]})})}):t.jsx(yt,{isOpen:a,onClose:s,title:r?`Edit Panel ${r.order+1}`:"Create New Panel",subtitle:(null==r?void 0:r.title)||"New Panel",icon:t.jsx(le,{className:"w-5 h-5"}),defaultWidth:"min(90vw, 1000px)",defaultHeight:"min(90vh, 800px)",maxWidth:"98vw",maxHeight:"98vh",resizable:!0,minimizable:!0,maximizable:!0,windowId:`panel-editor-${(null==r?void 0:r.id)||"new"}`,children:t.jsxs("div",{className:"h-full flex flex-col bg-primary",children:[h&&t.jsx("div",{className:"absolute inset-0 bg-primary/80 backdrop-blur-sm flex items-center justify-center z-50",children:t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-primary-500 border-t-transparent rounded-full mx-auto mb-3"}),t.jsx("p",{className:"text-primary font-medium",children:"Loading panel content..."})]})}),t.jsx("div",{className:"flex-1 overflow-y-auto p-4 sm:p-6",children:t.jsxs("div",{className:"panel-editor-grid",children:[t.jsxs("div",{className:"space-y-4 panel-editor-content",children:[t.jsxs("h3",{className:"font-medium text-primary flex items-center space-x-2",children:[t.jsx(o,{className:"w-4 h-4"}),t.jsx("span",{children:"Visual Content"})]}),t.jsxs("div",{className:"aspect-video bg-secondary rounded-lg border-2 border-dashed border-secondary flex items-center justify-center relative overflow-hidden",children:[(null==r?void 0:r.imageUrl)?t.jsx("img",{src:r.imageUrl,alt:r.title||"Panel image",className:"w-full h-full object-cover"}):t.jsxs("div",{className:"text-center p-4",children:[t.jsx(o,{className:"w-12 h-12 text-secondary mx-auto mb-2"}),t.jsx("p",{className:"text-sm text-secondary mb-2",children:"Add image or sketch"}),t.jsxs("label",{className:"btn-primary cursor-pointer inline-flex items-center",children:[t.jsx(w,{className:"w-4 h-4 mr-2"}),"Upload Image",t.jsx("input",{type:"file",accept:"image/*",onChange:g,className:"hidden"})]})]}),(null==r?void 0:r.imageUrl)&&t.jsxs("label",{className:"absolute top-2 right-2 bg-primary p-2 rounded-lg shadow-md cursor-pointer hover:bg-secondary transition-colors",children:[t.jsx(w,{className:"w-4 h-4 text-secondary"}),t.jsx("input",{type:"file",accept:"image/*",onChange:g,className:"hidden"})]})]}),t.jsxs("div",{className:"p-4 bg-secondary rounded-lg",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[t.jsx(d,{className:"w-4 h-4 text-secondary"}),t.jsx("span",{className:"text-sm font-medium text-primary",children:"Video Content"})]}),(null==r?void 0:r.videoUrl)?t.jsxs("div",{className:"space-y-2",children:[t.jsx("video",{src:r.videoUrl,controls:!0,className:"w-full rounded-lg",style:{maxHeight:"200px"}}),t.jsxs("label",{className:"btn-secondary text-xs cursor-pointer inline-flex items-center",children:[t.jsx(w,{className:"w-3 h-3 mr-1"}),"Replace Video",t.jsx("input",{type:"file",accept:"video/*",onChange:y,className:"hidden"})]})]}):t.jsxs("label",{className:"btn-secondary text-xs cursor-pointer inline-flex items-center w-full justify-center",children:[t.jsx(w,{className:"w-3 h-3 mr-1"}),"Upload Video",t.jsx("input",{type:"file",accept:"video/*",onChange:y,className:"hidden"})]})]}),(null==r?void 0:r.aiGeneratedPrompt)&&t.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(le,{className:"w-4 h-4 text-green-600"}),t.jsx("span",{className:"text-sm font-medium text-green-800",children:"AI Video Prompt"})]}),t.jsx("button",{onClick:()=>(async e=>{try{await navigator.clipboard.writeText(e),p(!0),setTimeout((()=>p(!1)),2e3)}catch(t){console.error("Failed to copy:",t)}})(r.aiGeneratedPrompt),className:"flex items-center space-x-1 px-2 py-1 text-xs bg-green-100 hover:bg-green-200 text-green-700 rounded transition-colors",children:m?t.jsxs(t.Fragment,{children:[t.jsx(ce,{className:"w-3 h-3"}),t.jsx("span",{children:"Copied!"})]}):t.jsxs(t.Fragment,{children:[t.jsx(R,{className:"w-3 h-3"}),t.jsx("span",{children:"Copy"})]})})]}),t.jsx("p",{className:"text-xs text-green-700 leading-relaxed",children:r.aiGeneratedPrompt}),t.jsx("p",{className:"text-xs text-green-600 mt-2 opacity-75",children:"Use this prompt with Runway ML, Pika Labs, or other AI video generation tools"})]})]}),t.jsxs("div",{className:"space-y-4 panel-editor-content",children:[t.jsx("div",{className:"flex items-center justify-between",children:t.jsxs("h3",{className:"font-medium flex items-center space-x-2",style:{color:i.theme.colors.text.primary},children:[t.jsx(le,{className:"w-4 h-4"}),t.jsx("span",{children:"Panel Details"})]})}),t.jsx(at,{context:"panel-editing",className:"text-xs"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Title"}),t.jsx("input",{type:"text",value:l.title,onChange:e=>c((t=>({...t,title:e.target.value}))),className:"input-modern w-full",placeholder:"Panel title..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Description"}),t.jsx("textarea",{value:l.description,onChange:e=>c((t=>({...t,description:e.target.value}))),rows:3,className:"textarea-modern w-full",placeholder:"Describe what happens in this panel..."})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Shot Type"}),t.jsx("select",{value:l.shotType,onChange:e=>c((t=>({...t,shotType:e.target.value}))),className:"select-modern w-full",children:Tt.map((e=>t.jsxs("option",{value:e.value,children:[e.label," - ",e.description]},e.value)))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Camera Angle"}),t.jsx("select",{value:l.cameraAngle,onChange:e=>c((t=>({...t,cameraAngle:e.target.value}))),className:"select-modern w-full",children:Et.map((e=>t.jsxs("option",{value:e.value,children:[e.label," - ",e.description]},e.value)))})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-sm font-medium text-secondary mb-1",children:[t.jsx(S,{className:"w-4 h-4 inline mr-1"}),"Duration (seconds)"]}),t.jsx("input",{type:"number",value:l.duration,onChange:e=>c((t=>({...t,duration:parseInt(e.target.value)||0}))),min:"1",max:"60",className:"input-modern w-full"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-secondary mb-1",children:"Director's Notes"}),t.jsx("textarea",{value:l.notes,onChange:e=>c((t=>({...t,notes:e.target.value}))),rows:3,className:"textarea-modern w-full",placeholder:"Additional notes, lighting, mood, etc..."})]})]})]})}),t.jsxs("div",{className:"flex justify-end space-x-3 p-6 border-t",style:{borderColor:i.theme.colors.border.primary},children:[t.jsx("button",{onClick:s,className:"btn-secondary",children:"Cancel"}),t.jsxs("button",{onClick:()=>{if(l.title.trim()){if(r)n({type:"UPDATE_PANEL",payload:{id:r.id,updates:{...l,updatedAt:new Date}}});else{const e={id:`panel-${Date.now()}`,...l,order:0,createdAt:new Date,updatedAt:new Date};n({type:"ADD_PANEL",payload:e})}s()}else alert("Please enter a panel title")},className:"btn-primary flex items-center space-x-2",children:[t.jsx(v,{className:"w-4 h-4"}),t.jsx("span",{children:r?"Save Changes":"Create Panel"})]})]})]})}):null}const $t=[{id:"dialogue-scene",title:"Dialogue Scene",description:"Two-person conversation template",icon:t.jsx(K,{className:"w-6 h-6"}),gradient:"from-blue-500 to-cyan-500",project:{id:"dialogue-template",title:"Dialogue Scene Template",description:"Template for filming a conversation between two characters",panels:[{id:"dialogue-1",title:"Establishing Shot",description:"Wide shot showing both characters and their environment",shotType:"wide-shot",cameraAngle:"eye-level",notes:"Set the scene and show relationship between characters",duration:4,order:0,createdAt:new Date,updatedAt:new Date},{id:"dialogue-2",title:"Character A Close-up",description:"Close-up of first character speaking",shotType:"close-up",cameraAngle:"eye-level",notes:"Focus on facial expressions and dialogue delivery",duration:3,order:1,createdAt:new Date,updatedAt:new Date},{id:"dialogue-3",title:"Character B Close-up",description:"Close-up of second character responding",shotType:"close-up",cameraAngle:"eye-level",notes:"Show reaction and response",duration:3,order:2,createdAt:new Date,updatedAt:new Date},{id:"dialogue-4",title:"Over Shoulder",description:"Over shoulder shot showing both characters",shotType:"over-the-shoulder",cameraAngle:"eye-level",notes:"Show interaction and maintain screen direction",duration:4,order:3,createdAt:new Date,updatedAt:new Date}],createdAt:new Date,updatedAt:new Date}},{id:"action-sequence",title:"Action Sequence",description:"High-energy action scene template",icon:t.jsx(k,{className:"w-6 h-6"}),gradient:"from-orange-500 to-red-500",project:{id:"action-template",title:"Action Sequence Template",description:"Template for filming fast-paced action scenes",panels:[{id:"action-1",title:"Wide Action Shot",description:"Wide shot establishing the action space",shotType:"wide-shot",cameraAngle:"high-angle",notes:"Show full scope of action, establish geography",duration:2,order:0,createdAt:new Date,updatedAt:new Date},{id:"action-2",title:"Character in Motion",description:"Medium shot of protagonist moving",shotType:"medium-shot",cameraAngle:"low-angle",notes:"Dynamic movement, heroic angle",duration:1,order:1,createdAt:new Date,updatedAt:new Date},{id:"action-3",title:"Impact Moment",description:"Extreme close-up of impact or contact",shotType:"extreme-close-up",cameraAngle:"dutch-angle",notes:"Quick cut, high impact moment",duration:1,order:2,createdAt:new Date,updatedAt:new Date},{id:"action-4",title:"Reaction Shot",description:"Close-up of character reaction",shotType:"close-up",cameraAngle:"eye-level",notes:"Show emotional response to action",duration:2,order:3,createdAt:new Date,updatedAt:new Date}],createdAt:new Date,updatedAt:new Date}},{id:"romantic-scene",title:"Romantic Scene",description:"Intimate romantic moment template",icon:t.jsx(Y,{className:"w-6 h-6"}),gradient:"from-pink-500 to-rose-500",project:{id:"romantic-template",title:"Romantic Scene Template",description:"Template for filming intimate romantic moments",panels:[{id:"romantic-1",title:"Setting the Mood",description:"Establishing shot with romantic lighting",shotType:"establishing-shot",cameraAngle:"eye-level",notes:"Soft lighting, romantic atmosphere",duration:5,order:0,createdAt:new Date,updatedAt:new Date},{id:"romantic-2",title:"Two Shot",description:"Medium shot of both characters together",shotType:"two-shot",cameraAngle:"eye-level",notes:"Show connection between characters",duration:4,order:1,createdAt:new Date,updatedAt:new Date},{id:"romantic-3",title:"Intimate Close-up",description:"Close-up focusing on emotional connection",shotType:"close-up",cameraAngle:"eye-level",notes:"Capture intimate emotions and expressions",duration:3,order:2,createdAt:new Date,updatedAt:new Date}],createdAt:new Date,updatedAt:new Date}}];function Mt({isOpen:r,onClose:a}){const{dispatch:s}=We(),{state:o}=Je(),[n,i]=e.useState(null);return r?t.jsx(yt,{isOpen:r,onClose:a,title:"Project Templates",subtitle:"Start with a pre-built storyboard template",icon:t.jsx(le,{className:"w-5 h-5"}),defaultWidth:"min(92vw, 1000px)",defaultHeight:"min(85vh, 700px)",maxWidth:"98vw",maxHeight:"95vh",resizable:!0,minimizable:!0,maximizable:!0,windowId:"project-templates",zIndex:9100,children:t.jsx("div",{className:"h-full overflow-y-auto",children:t.jsxs("div",{className:"p-6",children:[t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:$t.map((e=>t.jsxs("div",{className:"relative overflow-hidden rounded-lg border-2 transition-all cursor-pointer",style:{borderColor:n===e.id?o.theme.colors.primary[500]:o.theme.colors.border.secondary,backgroundColor:n===e.id?`${o.theme.colors.primary[50]}80`:"transparent"},onMouseOver:t=>{n!==e.id&&(t.currentTarget.style.borderColor=o.theme.colors.border.primary)},onMouseOut:t=>{n!==e.id&&(t.currentTarget.style.borderColor=o.theme.colors.border.secondary)},onClick:()=>i(e.id),children:[t.jsx("div",{className:`bg-gradient-to-r ${e.gradient} p-4 text-white`,children:t.jsxs("div",{className:"flex items-center space-x-3",children:[e.icon,t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold",children:e.title}),t.jsx("p",{className:"text-sm opacity-90",children:e.description})]})]})}),t.jsxs("div",{className:"p-4",children:[t.jsxs("div",{className:"text-sm mb-3",style:{color:o.theme.colors.text.secondary},children:[e.project.panels.length," panels â€¢ Total duration: "," ",e.project.panels.reduce(((e,t)=>e+(t.duration||0)),0),"s"]}),t.jsxs("div",{className:"space-y-2",children:[e.project.panels.slice(0,3).map(((e,r)=>t.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[t.jsx("div",{className:"w-4 h-4 rounded flex items-center justify-center font-medium",style:{backgroundColor:o.theme.colors.background.tertiary,color:o.theme.colors.text.secondary},children:r+1}),t.jsx("span",{className:"truncate",style:{color:o.theme.colors.text.primary},children:e.title})]},e.id))),e.project.panels.length>3&&t.jsxs("div",{className:"text-xs ml-6",style:{color:o.theme.colors.text.secondary},children:["+",e.project.panels.length-3," more panels"]})]})]}),t.jsx("div",{className:"p-4 border-t",style:{borderColor:o.theme.colors.border.secondary},children:t.jsx("button",{onClick:t=>{t.stopPropagation(),(e=>{confirm(`Load the "${e.title}" template? This will replace your current project.`)&&(s({type:"SET_PROJECT",payload:{...e.project,id:`template-${Date.now()}`,createdAt:new Date,updatedAt:new Date}}),a())})(e)},className:"w-full btn-primary text-sm py-2",children:"Use This Template"})})]},e.id)))}),t.jsxs("div",{className:"mt-6 p-4 border-2 border-dashed rounded-lg text-center",style:{borderColor:o.theme.colors.border.secondary},children:[t.jsx(le,{className:"w-8 h-8 mx-auto mb-2",style:{color:o.theme.colors.text.secondary}}),t.jsx("h3",{className:"font-medium mb-1",style:{color:o.theme.colors.text.primary},children:"Create Custom Template"}),t.jsx("p",{className:"text-sm mb-3",style:{color:o.theme.colors.text.secondary},children:"Start with a blank project and build your own storyboard from scratch"}),t.jsx("button",{onClick:()=>{s({type:"SET_PROJECT",payload:{id:`custom-${Date.now()}`,title:"Custom Storyboard Project",description:"A custom storyboard project",panels:[],createdAt:new Date,updatedAt:new Date}}),a()},className:"btn-secondary",children:"Start Blank Project"})]})]})})}):null}function Lt({isOpen:r,onClose:a}){const{state:s,dispatch:o}=We(),{state:n}=Je(),[i,c]=e.useState([]),[m,h]=e.useState(!1),[u,g]=e.useState({}),[y,x]=e.useState("grid"),[v,w]=e.useState(""),[j,C]=e.useState("all"),[A,P]=e.useState({}),[I,T]=e.useState({generated:0,total:0}),[E,D]=e.useState({style:"cinematic",duration:"3-5 seconds",aspectRatio:"16:9",quality:"high",motion:"smooth",lighting:"dramatic",mood:"dynamic"}),[$,M]=e.useState(!1);e.useEffect((()=>{r&&s.panels.length>0&&c(s.panels.map((e=>e.id)))}),[r,s.panels]),e.useEffect((()=>{const e=Object.keys(u).length,t=s.panels.length;T({generated:e,total:t})}),[u,s.panels]);const L=s.panels.filter((e=>{const t=!v||e.title.toLowerCase().includes(v.toLowerCase())||e.description.toLowerCase().includes(v.toLowerCase()),r="all"===j||"generated"===j&&u[e.id]||"pending"===j&&!u[e.id];return t&&r})),O=async e=>{var t,r,a,o,n,i;if(console.log("ðŸŽ¯ generateVideoPrompt called for panel:",e.id,"Description:",e.description),tt.isReady()){console.log("ðŸ¤– AI service is ready, generating contextual prompt with full project data...");try{const i={projectTitle:(null==(t=s.currentProject)?void 0:t.title)||"Untitled Project",projectDescription:(null==(r=s.currentProject)?void 0:r.description)||"",directorNotes:(null==(a=s.currentProject)?void 0:a.directorNotes)||"",videoStyle:(null==(o=s.currentProject)?void 0:o.videoStyle)||{},totalPanels:s.panels.length,currentPanelIndex:s.panels.findIndex((t=>t.id===e.id))+1,previousPanels:s.panels.slice(0,s.panels.findIndex((t=>t.id===e.id))).map((e=>({title:e.title,description:e.description,shotType:e.shotType,cameraAngle:e.cameraAngle,duration:e.duration,notes:e.notes}))),nextPanels:s.panels.slice(s.panels.findIndex((t=>t.id===e.id))+1).map((e=>({title:e.title,description:e.description,shotType:e.shotType,cameraAngle:e.cameraAngle,duration:e.duration,notes:e.notes}))),currentPanel:{title:e.title,description:e.description,shotType:e.shotType,cameraAngle:e.cameraAngle,duration:e.duration,notes:e.notes}},l=await F(i);if(l&&"string"==typeof l&&l.length>0)return console.log("âœ… AI generated contextual prompt:",l.substring(0,100)+"..."),l;{console.log("âš ï¸ AI contextual generation failed, trying scene generation...");const t=await tt.generateScene(`${e.description} | Project: ${i.projectTitle} | Director's Vision: ${i.directorNotes} | Context: Panel ${i.currentPanelIndex} of ${i.totalPanels}`,e.shotType,e.cameraAngle,"cinematic");if(console.log("ðŸ” AI service returned scene data:",{hasVideoPrompt:!!t.videoPrompt,videoPromptType:typeof t.videoPrompt,videoPromptLength:null==(n=t.videoPrompt)?void 0:n.length,sceneDataKeys:Object.keys(t)}),t&&t.videoPrompt&&"string"==typeof t.videoPrompt&&t.videoPrompt.length>0)return console.log("âœ… AI generated scene prompt:",t.videoPrompt.substring(0,50)+"..."),t.videoPrompt;console.log("âš ï¸ AI service returned invalid videoPrompt - using intelligent fallback"),console.log("   - videoPrompt type:",typeof t.videoPrompt),console.log("   - videoPrompt value:",t.videoPrompt),console.log("   - sceneData:",t)}}catch(l){console.error("âŒ Error generating AI video prompt:",l);const e=l;console.log("ðŸ“„ Error details:",{name:e.name||"Unknown",message:e.message||"Unknown error",stack:(null==(i=e.stack)?void 0:i.substring(0,200))||"No stack trace"})}}else console.log("ðŸ”§ AI service not ready, using intelligent contextual fallback");return console.log("ðŸ“ Creating intelligent contextual fallback prompt with project data..."),z(e,s)},F=async e=>{try{const t=`Create a professional, cinematic video generation prompt for an AI video tool (RunwayML, Pika Labs, Stable Video Diffusion, Luma Dream Machine).\n\nPROJECT CONTEXT:\n- Title: "${e.projectTitle}"\n- Description: "${e.projectDescription}"\n- Director's Vision: "${e.directorNotes}"\n- Video Style: ${JSON.stringify(e.videoStyle)}\n\nCURRENT PANEL (${e.currentPanelIndex} of ${e.totalPanels}):\n- Title: "${e.currentPanel.title}"\n- Description: "${e.currentPanel.description}"\n- Shot Type: ${e.currentPanel.shotType}\n- Camera Angle: ${e.currentPanel.cameraAngle}\n- Duration: ${e.currentPanel.duration} seconds\n- Notes: "${e.currentPanel.notes}"\n\nSTORY CONTEXT:\nPrevious panels: ${e.previousPanels.map(((e,t)=>`Panel ${t+1}: ${e.title} - ${e.description}`)).join(" | ")}\nNext panels: ${e.nextPanels.map(((t,r)=>`Panel ${e.currentPanelIndex+r+1}: ${t.title} - ${t.description}`)).join(" | ")}\n\nREQUIREMENTS:\nCreate a detailed video generation prompt that:\n1. Reflects the director's creative vision and project style\n2. Maintains visual continuity with previous/next panels\n3. Uses professional cinematography terminology\n4. Includes specific technical specifications (4K, 24fps, lighting, color grading)\n5. Incorporates camera movement and framing details\n6. Considers the panel's role in the overall story flow\n7. Optimizes for AI video generation tools\n\nGenerate ONLY the video prompt text, no explanations or formatting.`;return await tt.sendMessage([{role:"user",content:t}],{projectTitle:e.projectTitle,projectDescription:e.projectDescription,panelCount:e.totalPanels,totalDuration:4*e.totalPanels,currentPanel:e.currentPanel,allPanels:[...e.previousPanels,e.currentPanel,...e.nextPanels],directorNotes:e.directorNotes})||""}catch(t){return console.error("âŒ Error in contextual prompt generation:",t),""}},z=(e,t)=>{const r=t.currentProject,a=t.panels,s=a.findIndex((t=>t.id===e.id)),o=[];(null==r?void 0:r.directorNotes)&&o.push(`Directors Vision: ${r.directorNotes}`),(null==r?void 0:r.description)&&o.push(`Project Theme: ${r.description}`);const n=[];if(s>0){const e=a[s-1];n.push(`Following: ${e.title} (${e.shotType})`)}if(s<a.length-1){const e=a[s+1];n.push(`Leading to: ${e.title} (${e.shotType})`)}const i=(null==r?void 0:r.videoStyle)||{},l=[];i.genre&&l.push(`Genre: ${i.genre}`),i.mood&&l.push(`Mood: ${i.mood}`),i.colorPalette&&l.push(`Color Palette: ${i.colorPalette}`),i.cinematicStyle&&l.push(`Style: ${i.cinematicStyle}`);const c=U(e.shotType,e.cameraAngle),d=[`${e.description}.`,`${c.description} ${c.movement}`,o.length>0?o.join(". ")+".":"",n.length>0?n.join(", ")+".":"",l.length>0?l.join(", ")+".":"",`Professional cinematography, ${c.technical}`,`Duration: ${e.duration} seconds`,"4K resolution, cinematic lighting, color graded, film grain texture"].filter(Boolean).join(" ");return console.log("ðŸ“ Generated intelligent fallback prompt:",d.substring(0,100)+"..."),d},U=(e,t)=>{const r={"extreme-wide":{description:"Extreme wide shot capturing vast environment",movement:"with slow, sweeping camera movement",technical:"24fps, wide-angle lens, deep focus"},wide:{description:"Wide shot establishing scene context",movement:"with smooth establishing movement",technical:"24fps, standard lens, balanced exposure"},medium:{description:"Medium shot focusing on subject interaction",movement:"with subtle tracking or static framing",technical:"24fps, 50mm lens equivalent, natural depth of field"},"close-up":{description:"Close-up shot capturing emotional detail",movement:"with intimate, controlled camera work",technical:"24fps, 85mm lens equivalent, shallow depth of field"},"extreme-close-up":{description:"Extreme close-up revealing intricate details",movement:"with precise, minimal camera movement",technical:"24fps, macro lens, ultra-shallow focus"}},a=r[e]||r.medium,s={"eye-level":"at natural eye level perspective","low-angle":"from dramatic low angle looking up","high-angle":"from elevated high angle looking down","bird-eye":"from aerial bird's eye perspective","dutch-angle":"with dynamic tilted dutch angle"}[t]||"";return{...a,description:`${a.description} ${s}`.trim()}};return r?t.jsxs(yt,{isOpen:r,onClose:a,title:"Video Prompt Generator",subtitle:"AI-powered prompts for video generation tools",icon:t.jsx(d,{className:"w-5 h-5"}),defaultWidth:"min(88vw, 750px)",defaultHeight:"650px",minWidth:400,minHeight:500,maxWidth:"98vw",maxHeight:"95vh",className:"flex flex-col",children:[t.jsxs("div",{className:"relative flex items-center justify-between p-6 border-b border-primary bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 bg-[length:200%_100%] text-white animate-gradientMove",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-14 h-14 rounded-full flex items-center justify-center animate-float",style:{backgroundColor:"rgba(255, 255, 255, 0.15)"},children:t.jsx(b,{className:"w-7 h-7"})}),t.jsxs("div",{children:[t.jsxs("h2",{className:"text-3xl font-bold flex items-center space-x-2",children:[t.jsx("span",{children:"Video Prompt Generator"}),t.jsx(l,{className:"w-6 h-6 animate-sparkle"})]}),t.jsx("p",{className:"text-blue-100 text-lg",children:"AI-powered prompts for video generation tools"}),t.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[t.jsxs("div",{className:"text-blue-200 text-sm",children:["Progress: ",I.generated,"/",I.total," prompts"]}),t.jsx("div",{className:"w-32 h-2 rounded-full overflow-hidden",style:{backgroundColor:"rgba(255, 255, 255, 0.15)"},children:t.jsx("div",{className:"h-full rounded-full transition-all duration-200",style:{backgroundColor:"rgba(255, 255, 255, 0.7)",width:I.generated/Math.max(I.total,1)*100+"%"}})})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("button",{onClick:()=>x("grid"===y?"list":"grid"),className:"p-3 rounded-xl transition-all duration-300 group hover:bg-opacity-20",style:{backgroundColor:"rgba(255, 255, 255, 0.1)"},title:`Switch to ${"grid"===y?"list":"grid"} view`,children:"grid"===y?t.jsx(de,{className:"w-6 h-6 group-hover:scale-110 transition-transform"}):t.jsx(f,{className:"w-6 h-6 group-hover:scale-110 transition-transform"})}),t.jsx("button",{onClick:()=>{var e;const t=s.panels.map((e=>({panelNumber:e.order+1,title:e.title,description:e.description,shotType:e.shotType,cameraAngle:e.cameraAngle,duration:e.duration,prompt:u[e.id]||"Not generated"}))).map((e=>`Panel ${e.panelNumber}: ${e.title}\nDescription: ${e.description}\nShot: ${e.shotType} | Angle: ${e.cameraAngle} | Duration: ${e.duration}s\nVideo Prompt: ${e.prompt}\n${"=".repeat(80)}\n`)).join("\n"),r=new Blob([t],{type:"text/plain"}),a=URL.createObjectURL(r),o=document.createElement("a");o.href=a,o.download=`${(null==(e=s.currentProject)?void 0:e.title)||"storyboard"}_video_prompts.txt`,o.click(),URL.revokeObjectURL(a)},disabled:0===Object.keys(u).length,className:"p-3 rounded-xl transition-all duration-300 disabled:opacity-50 group hover:bg-opacity-20",style:{backgroundColor:"rgba(255, 255, 255, 0.1)"},title:"Export All Prompts",children:t.jsx(N,{className:"w-6 h-6 group-hover:scale-110 transition-transform"})}),t.jsx("button",{onClick:a,className:"p-3 rounded-xl transition-all duration-300 hover:scale-110 hover:bg-opacity-20",style:{backgroundColor:"rgba(255, 255, 255, 0.1)"},children:"âœ•"})]})]}),t.jsxs("div",{className:"p-6 border-b border-primary bg-secondary bg-opacity-70",children:[t.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 mb-4",children:[t.jsxs("div",{className:"relative flex-1 group",children:[t.jsx(Z,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-secondary group-focus-within:text-purple-500 transition-colors"}),t.jsx("input",{type:"text",value:v,onChange:e=>w(e.target.value),placeholder:"Search panels by title or description...",className:"w-full pl-12 pr-4 py-3 bg-primary border border-primary rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent text-primary placeholder-secondary transition-all duration-300 hover:bg-opacity-80 focus:scale-[1.02]"})]}),t.jsxs("select",{value:j,onChange:e=>C(e.target.value),className:"px-4 py-3 bg-primary border border-primary rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-transparent text-primary min-w-[200px] transition-all duration-300 hover:bg-opacity-80 focus:scale-[1.02]",children:[t.jsxs("option",{value:"all",children:["All Panels (",s.panels.length,")"]}),t.jsxs("option",{value:"generated",children:["Generated (",I.generated,")"]}),t.jsxs("option",{value:"pending",children:["Pending (",I.total-I.generated,")"]})]})]}),t.jsxs("div",{className:"flex flex-wrap gap-3",children:[t.jsx("button",{onClick:async()=>{if(!tt.isReady())return void alert("Please set up your OpenAI API key first in the AI Assistant settings.");h(!0);const e={};try{for(let r=0;r<s.panels.length;r++){const a=s.panels[r];if(u[a.id])e[a.id]=u[a.id];else{console.log(`ðŸŽ¬ Generating prompt ${r+1}/${s.panels.length} for panel: ${a.title}`);try{const t=await O(a);t&&t.length>0?(e[a.id]=t,o({type:"UPDATE_PANEL",payload:{id:a.id,updates:{aiGeneratedPrompt:t,videoPrompt:t,updatedAt:new Date}}}),console.log(`âœ… Generated prompt for panel ${r+1}: ${t.substring(0,50)}...`)):console.warn(`âš ï¸ Empty prompt generated for panel ${r+1}`)}catch(t){console.error(`âŒ Error generating prompt for panel ${r+1}:`,t)}await new Promise((e=>setTimeout(e,500)))}}g((t=>({...t,...e}))),console.log("ðŸŽ‰ Batch generation completed")}catch(t){console.error("âŒ Error in batch generation:",t),alert("Error generating prompts. Please check your API settings and try again.")}finally{h(!1)}},disabled:m,className:"btn-primary flex items-center space-x-2 transform hover:scale-105 transition-all duration-300 "+(m?"opacity-50 cursor-not-allowed":""),children:m?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-5 h-5 border-2 border-t-transparent rounded-full animate-spin",style:{borderColor:n.theme.colors.text.primary}}),t.jsx("span",{children:"Generating..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(k,{className:"w-5 h-5"}),t.jsx("span",{children:"Generate All Prompts"})]})}),!tt.isReady()&&t.jsxs("div",{className:"flex items-center space-x-2 px-4 py-2 bg-yellow-100 text-yellow-800 rounded-xl",children:[t.jsx(se,{className:"w-5 h-5"}),t.jsx("span",{className:"text-sm",children:"Please configure your OpenAI API key first"})]})]})]}),t.jsx("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar scrollable",children:0===L.length?t.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center animate-fadeIn",children:[t.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-blue-400 to-purple-400 rounded-full flex items-center justify-center mb-6 animate-bounce",children:t.jsx(Z,{className:"w-12 h-12 text-white"})}),t.jsx("h3",{className:"text-2xl font-bold text-primary mb-2",children:"No panels found"}),t.jsx("p",{className:"text-secondary text-lg",children:"Try adjusting your search or filter criteria"})]}):t.jsx("div",{className:""+("grid"===y?"grid grid-cols-1 lg:grid-cols-2 gap-6":"space-y-4"),children:L.map(((e,r)=>{const a=!!u[e.id],s=A[e.id];return t.jsxs("div",{className:"bg-primary rounded-2xl border border-primary p-6 transition-all duration-300 transform hover:scale-105 hover:shadow-xl glass-panel group "+(a?"ring-2 ring-green-200 bg-gradient-to-br from-green-50 to-blue-50":""),style:{animationDelay:50*r+"ms"},children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white font-bold "+(a?"bg-gradient-to-r from-green-500 to-blue-500":"bg-gradient-to-r from-gray-400 to-gray-500"),children:e.order+1}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-primary text-lg group-hover:text-purple-600 transition-colors",children:e.title}),t.jsxs("div",{className:"flex items-center space-x-3 mt-1",children:[t.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded-full text-xs font-medium",children:e.shotType}),t.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:e.cameraAngle}),t.jsxs("div",{className:"flex items-center space-x-1 text-secondary text-xs",children:[t.jsx(S,{className:"w-3 h-3"}),t.jsxs("span",{children:[e.duration,"s"]})]})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[a&&t.jsxs("div",{className:"flex items-center space-x-1 text-green-600 text-sm font-medium",children:[t.jsx(ce,{className:"w-4 h-4"}),t.jsx("span",{children:"Generated"})]}),t.jsx("button",{onClick:()=>(async e=>{if(tt.isReady()){h(!0);try{const t=await O(e);t&&(g((r=>({...r,[e.id]:t}))),o({type:"UPDATE_PANEL",payload:{id:e.id,updates:{aiGeneratedPrompt:t,videoPrompt:t,updatedAt:new Date}}}))}catch(t){console.error("Error regenerating prompt:",t),alert("Error regenerating prompt. Please try again.")}finally{h(!1)}}else alert("Please set up your OpenAI API key first in the AI Assistant settings.")})(e),disabled:m,className:"w-10 h-10 bg-purple-500 hover:bg-purple-600 text-white rounded-xl flex items-center justify-center transition-all duration-300 transform hover:scale-110 disabled:opacity-50",title:"Generate/Regenerate Prompt",children:m?t.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}):t.jsx(me,{className:"w-5 h-5"})})]})]}),t.jsx("div",{className:"mb-4 p-3 rounded-lg",style:{backgroundColor:n.theme.colors.background.secondary},children:t.jsx("p",{className:"text-secondary text-sm leading-relaxed",children:e.description})}),a?t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("h4",{className:"font-semibold text-primary flex items-center space-x-2",children:[t.jsx(p,{className:"w-4 h-4"}),t.jsx("span",{children:"Video Prompt"})]}),t.jsx("button",{onClick:()=>(async(e,t)=>{try{await navigator.clipboard.writeText(e),P((e=>({...e,[t]:!0}))),setTimeout((()=>{P((e=>({...e,[t]:!1})))}),2e3)}catch(r){console.error("Failed to copy:",r)}})(u[e.id],e.id),className:"flex items-center space-x-2 px-3 py-2 rounded-lg transition-all duration-300 transform hover:scale-105 "+(s?"bg-green-500 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:s?t.jsxs(t.Fragment,{children:[t.jsx(ce,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Copied!"})]}):t.jsxs(t.Fragment,{children:[t.jsx(R,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"Copy"})]})})]}),t.jsx("div",{className:"p-4 bg-gradient-to-br from-blue-50 to-purple-50 rounded-lg border border-blue-200",children:t.jsx("p",{className:"text-primary text-sm leading-relaxed whitespace-pre-wrap",children:u[e.id]})})]}):t.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-secondary-200 to-secondary-300 rounded-full flex items-center justify-center mb-4 animate-pulse",children:t.jsx(X,{className:"w-8 h-8",style:{color:n.theme.colors.text.tertiary}})}),t.jsx("p",{className:"text-secondary font-medium mb-2",children:"No prompt generated yet"}),t.jsx("p",{className:"text-secondary text-sm",children:"Click the regenerate button to create a video prompt"})]})]},e.id)}))})})]}):null}const Ot=[{id:"blank",name:"Blank Project",description:"Start from scratch",icon:"ðŸ“„"},{id:"commercial",name:"Commercial",description:"30-60 second commercial template",icon:"ðŸ“º"},{id:"social",name:"Social Media",description:"Short form content template",icon:"ðŸ“±"},{id:"narrative",name:"Narrative Film",description:"Long form storytelling template",icon:"ðŸŽ¬"},{id:"explainer",name:"Explainer Video",description:"Educational content template",icon:"ðŸŽ“"},{id:"music-video",name:"Music Video",description:"Music video template",icon:"ðŸŽµ"}];function Ft({isOpen:r,onClose:a}){const{dispatch:s}=We(),{state:o}=Je(),n=_e(o.theme),i=(e=>{const t=_e(e);return[{id:"blue",color:t.project.blue.background,name:"Blue"},{id:"purple",color:t.project.purple.background,name:"Purple"},{id:"green",color:t.project.green.background,name:"Green"},{id:"red",color:t.project.red.background,name:"Red"},{id:"orange",color:t.project.orange.background,name:"Orange"},{id:"pink",color:t.project.pink.background,name:"Pink"},{id:"indigo",color:t.project.indigo.background,name:"Indigo"},{id:"gray",color:t.project.gray.background,name:"Gray"}]})(o.theme),[l,c]=e.useState([]),[d,u]=e.useState(""),[y,x]=e.useState("all"),[b,v]=e.useState("updated"),[w,j]=e.useState("grid"),[k,C]=e.useState([]),[A,S]=e.useState(!1),[I,T]=e.useState(!1),[E,D]=e.useState(null),[M,L]=e.useState({title:"",description:"",tags:[],status:"draft",template:"blank",color:"#3B82F6",category:"",priority:"medium"});e.useEffect((()=>{O()}),[]);const O=async()=>{try{const e=(await Oe.getAllProjects()).map((e=>({id:e.id,title:e.title,description:e.description||"",panels:e.panels||[],directorNotes:"",createdAt:e.createdAt,updatedAt:e.updatedAt,isStarred:!1,isArchived:!1,tags:[],lastOpenedAt:e.updatedAt,thumbnailUrl:"",collaborators:[],status:"draft",color:"#3B82F6",template:"blank",category:"",priority:"medium"})));c(e)}catch(e){console.error("Error loading projects:",e)}},F=async e=>{try{const t={id:e.id,title:e.title,description:e.description,panels:e.panels,createdAt:e.createdAt,updatedAt:new Date};await Oe.saveProject(t);const r=l.map((t=>t.id===e.id?{...e,updatedAt:new Date}:t));c(r)}catch(t){console.error("Error saving project:",t)}},z=async e=>{const t={...e,lastOpenedAt:new Date};s({type:"SET_PROJECT",payload:t}),s({type:"SET_PANELS",payload:e.panels}),await F(t),a()},U=async e=>{const t={...e,id:`project-${Date.now()}`,title:`${e.title} (Copy)`,createdAt:new Date,updatedAt:new Date,lastOpenedAt:new Date,isStarred:!1},r={id:t.id,title:t.title,description:t.description,panels:t.panels,createdAt:t.createdAt,updatedAt:t.updatedAt};await Oe.saveProject(r);const a=[t,...l];c(a)},W=async e=>{const t={projects:l.filter((t=>e.includes(t.id))),exportedAt:new Date,version:"1.0"},r=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),a=URL.createObjectURL(r),s=document.createElement("a");s.href=a,s.download=`storyboard-projects-export-${Date.now()}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a)},_=l.filter((e=>{var t,r;const a=e.title.toLowerCase().includes(d.toLowerCase())||e.description.toLowerCase().includes(d.toLowerCase())||(null==(t=e.tags)?void 0:t.some((e=>e.toLowerCase().includes(d.toLowerCase()))))||(null==(r=e.category)?void 0:r.toLowerCase().includes(d.toLowerCase())),s="all"===y?!e.isArchived:"starred"===y?e.isStarred&&!e.isArchived:"recent"===y?!e.isArchived:"archived"!==y||e.isArchived;return a&&s})).sort(((e,t)=>{switch(b){case"title":return e.title.localeCompare(t.title);case"created":return new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime();case"panels":return t.panels.length-e.panels.length;default:return new Date(t.updatedAt).getTime()-new Date(e.updatedAt).getTime()}})),B=e.useMemo((()=>{const e=window.innerWidth>1200?1200:.9*window.innerWidth;return dt.getOptimalLayout(e,_.length)}),[_.length]),H=e=>{switch(e){case"completed":return n.status.success.background;case"review":return n.status.info.background;case"in-progress":return n.status.warning.background;default:return n.project.gray.background}},G=e=>{switch(e){case"completed":return"Complete";case"review":return"Review";case"in-progress":return"In Progress";default:return"Draft"}},q=e=>{switch(e){case"high":return n.status.error.background;case"medium":return n.status.warning.background;case"low":return n.status.success.background;default:return n.project.gray.background}};return r?t.jsx(yt,{isOpen:r,onClose:a,title:"Projects",subtitle:`${_.length} of ${l.length} projects`,icon:t.jsx(m,{className:"w-5 h-5"}),defaultWidth:"1400",defaultHeight:"900",maxWidth:"98vw",maxHeight:"98vh",minWidth:280,minHeight:400,resizable:!0,minimizable:!0,maximizable:!0,windowId:"project-manager",zIndex:9100,children:t.jsxs("div",{className:"h-full w-full flex flex-col bg-primary",children:[t.jsxs("div",{className:"border-b p-4",style:{backgroundColor:n.interactive.secondary.background,borderColor:n.interactive.secondary.border},children:[t.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4",children:[t.jsxs("div",{className:"flex-1 relative",children:[t.jsx(Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5",style:{color:n.interactive.secondary.text}}),t.jsx("input",{type:"text",placeholder:"Search projects by name, description, tags, or category...",value:d,onChange:e=>u(e.target.value),className:"w-full pl-11 pr-4 py-3 text-base rounded-xl transition-all duration-200",style:{backgroundColor:o.theme.colors.background.primary,border:`1px solid ${o.theme.colors.border.primary}`,color:o.theme.colors.text.primary},onFocus:e=>{e.currentTarget.style.borderColor=o.theme.colors.primary[500]},onBlur:e=>{e.currentTarget.style.borderColor=o.theme.colors.border.primary}})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("button",{onClick:()=>T(!I),className:"px-4 py-3 flex items-center gap-2 rounded-lg transition-all duration-200",style:{backgroundColor:I?n.interactive.primary.background:n.interactive.secondary.background,color:I?n.interactive.primary.text:n.interactive.secondary.text,border:`1px solid ${n.interactive.secondary.border}`},onMouseEnter:e=>{I||(e.currentTarget.style.backgroundColor=n.interactive.secondary.hover)},onMouseLeave:e=>{I||(e.currentTarget.style.backgroundColor=n.interactive.secondary.background)},children:[t.jsx(pe,{className:"w-4 h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Filters"})]}),t.jsxs("select",{value:b,onChange:e=>v(e.target.value),className:"px-3 py-3 rounded-xl text-sm transition-all duration-200",style:{backgroundColor:o.theme.colors.background.primary,border:`1px solid ${o.theme.colors.border.primary}`,color:o.theme.colors.text.primary},onFocus:e=>{e.currentTarget.style.borderColor=o.theme.colors.primary[500]},onBlur:e=>{e.currentTarget.style.borderColor=o.theme.colors.border.primary},children:[t.jsx("option",{value:"updated",children:"Recently Updated"}),t.jsx("option",{value:"created",children:"Recently Created"}),t.jsx("option",{value:"title",children:"Name A-Z"}),t.jsx("option",{value:"panels",children:"Panel Count"})]}),t.jsxs("div",{className:"flex rounded-lg p-1",style:{backgroundColor:n.interactive.secondary.background},children:[t.jsx("button",{onClick:()=>j("grid"),className:"p-2 rounded-md transition-all duration-200",style:{backgroundColor:"grid"===w?n.interactive.primary.background:"transparent",color:"grid"===w?n.interactive.primary.text:n.interactive.secondary.text},onMouseEnter:e=>{"grid"!==w&&(e.currentTarget.style.color=o.theme.colors.text.primary)},onMouseLeave:e=>{"grid"!==w&&(e.currentTarget.style.color=n.interactive.secondary.text)},children:t.jsx(f,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>j("list"),className:"p-2 rounded-md transition-all duration-200",style:{backgroundColor:"list"===w?n.interactive.primary.background:"transparent",color:"list"===w?n.interactive.primary.text:n.interactive.secondary.text},onMouseEnter:e=>{"list"!==w&&(e.currentTarget.style.color=o.theme.colors.text.primary)},onMouseLeave:e=>{"list"!==w&&(e.currentTarget.style.color=n.interactive.secondary.text)},children:t.jsx(de,{className:"w-4 h-4"})})]}),t.jsxs("button",{onClick:()=>S(!0),className:"px-6 py-3 flex items-center gap-2 rounded-lg transition-all duration-200 font-medium shadow-lg hover:shadow-xl",style:{backgroundColor:n.interactive.primary.background,color:n.interactive.primary.text},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=n.interactive.primary.hover,e.currentTarget.style.transform="translateY(-1px)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=n.interactive.primary.background,e.currentTarget.style.transform="translateY(0)"},children:[t.jsx(h,{className:"w-4 h-4"}),t.jsx("span",{children:"New Project"})]})]})]}),I&&t.jsx("div",{className:"mt-4 flex flex-wrap gap-2 p-4 rounded-xl",style:{backgroundColor:n.interactive.secondary.background},children:["all","starred","recent","archived"].map((e=>t.jsx("button",{onClick:()=>x(e),className:"px-4 py-2 rounded-lg text-sm font-medium transition-all duration-200",style:{backgroundColor:y===e?n.interactive.primary.background:"transparent",color:y===e?n.interactive.primary.text:n.interactive.secondary.text,border:`1px solid ${y===e?n.interactive.primary.background:"transparent"}`},onMouseEnter:t=>{y!==e&&(t.currentTarget.style.backgroundColor=n.interactive.secondary.hover)},onMouseLeave:t=>{y!==e&&(t.currentTarget.style.backgroundColor="transparent")},children:"all"===e?"All Projects":e.charAt(0).toUpperCase()+e.slice(1)},e)))}),k.length>0&&t.jsxs("div",{className:"mt-4 flex items-center justify-between p-3 rounded-xl border",style:{backgroundColor:n.status.info.light,borderColor:n.status.info.border},children:[t.jsxs("span",{className:"text-sm font-medium",style:{color:n.status.info.background},children:[k.length," project",k.length>1?"s":""," selected"]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>W(k),className:"px-3 py-2 text-sm rounded-lg transition-all duration-200",style:{backgroundColor:n.interactive.secondary.background,color:n.interactive.secondary.text,border:`1px solid ${n.interactive.secondary.border}`},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=n.interactive.secondary.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=n.interactive.secondary.background},children:t.jsx(N,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>(async e=>{const t=l.map((t=>e.includes(t.id)?{...t,isArchived:!t.isArchived}:t));c(t),C([])})(k),className:"px-3 py-2 text-sm rounded-lg transition-all duration-200",style:{backgroundColor:n.interactive.secondary.background,color:n.interactive.secondary.text,border:`1px solid ${n.interactive.secondary.border}`},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=n.interactive.secondary.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=n.interactive.secondary.background},children:t.jsx(he,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>(async e=>{if(!confirm(`Delete ${e.length} project(s)? This cannot be undone.`))return;for(const a of e)try{await Oe.deleteProject(a)}catch(r){console.error(`Error deleting project ${a}:`,r)}const t=l.filter((t=>!e.includes(t.id)));c(t),C([])})(k),className:"px-3 py-2 text-sm rounded-lg transition-all duration-200",style:{backgroundColor:n.status.error.background,color:n.status.error.text},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=n.status.error.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=n.status.error.background},children:t.jsx(P,{className:"w-4 h-4"})})]})]})]}),t.jsx("div",{className:"flex-1 overflow-auto w-full",children:A?t.jsxs("div",{className:"max-w-4xl mx-auto rounded-2xl p-8 border m-6",style:{backgroundColor:n.interactive.secondary.background,borderColor:n.interactive.secondary.border},children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-2xl font-bold",style:{color:n.text.primary.color},children:"Create New Project"}),t.jsx("button",{onClick:()=>S(!1),className:"p-2 rounded-lg transition-all duration-200",style:{color:n.interactive.secondary.text},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=n.interactive.secondary.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent"},children:t.jsx($,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold mb-3",style:{color:n.text.primary.color},children:"Project Name *"}),t.jsx("input",{type:"text",value:M.title,onChange:e=>L((t=>({...t,title:e.target.value}))),placeholder:"Enter your project name...",className:"w-full text-lg p-4 rounded-xl transition-all duration-200",style:{backgroundColor:o.theme.colors.background.primary,border:`1px solid ${o.theme.colors.border.primary}`,color:n.text.primary.color},onFocus:e=>{e.currentTarget.style.borderColor=o.theme.colors.primary[500]},onBlur:e=>{e.currentTarget.style.borderColor=o.theme.colors.border.primary},autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold mb-3",style:{color:n.text.primary.color},children:"Description"}),t.jsx("textarea",{value:M.description,onChange:e=>L((t=>({...t,description:e.target.value}))),placeholder:"Describe your project...",rows:3,className:"w-full p-4 rounded-xl transition-all duration-200",style:{backgroundColor:o.theme.colors.background.primary,border:`1px solid ${o.theme.colors.border.primary}`,color:n.text.primary.color},onFocus:e=>{e.currentTarget.style.borderColor=o.theme.colors.primary[500]},onBlur:e=>{e.currentTarget.style.borderColor=o.theme.colors.border.primary}})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold mb-3",style:{color:n.text.primary.color},children:"Category"}),t.jsx("input",{type:"text",value:M.category,onChange:e=>L((t=>({...t,category:e.target.value}))),placeholder:"e.g., Marketing, Internal, Client Work...",className:"w-full p-4 rounded-xl transition-all duration-200",style:{backgroundColor:o.theme.colors.background.primary,border:`1px solid ${o.theme.colors.border.primary}`,color:n.text.primary.color},onFocus:e=>{e.currentTarget.style.borderColor=o.theme.colors.primary[500]},onBlur:e=>{e.currentTarget.style.borderColor=o.theme.colors.border.primary}})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold mb-3",style:{color:n.text.primary.color},children:"Tags"}),t.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:M.tags.map(((e,r)=>t.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 bg-primary/20 text-primary rounded-full text-sm border border-primary/30",children:[t.jsx(ue,{className:"w-3 h-3"}),t.jsx("span",{children:e}),t.jsx("button",{onClick:()=>{return t=e,void L((e=>({...e,tags:e.tags.filter((e=>e!==t))})));var t},className:"hover:text-red-500 transition-colors",children:"Ã—"})]},r)))}),t.jsx("input",{type:"text",placeholder:"Add tags (press Enter)...",className:"input-modern w-full p-3 bg-primary border border-primary/30 focus:border-primary/60 rounded-xl",onKeyPress:e=>{var t;"Enter"===e.key&&(e.preventDefault(),(t=e.currentTarget.value).trim()&&!M.tags.includes(t.trim())&&L((e=>({...e,tags:[...e.tags,t.trim()]}))),e.currentTarget.value="")}})]})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-primary mb-3",children:"Template"}),t.jsx("div",{className:"grid grid-cols-2 gap-3",children:Ot.map((e=>t.jsxs("button",{onClick:()=>L((t=>({...t,template:e.id}))),className:"p-4 rounded-xl border-2 transition-all text-left "+(M.template===e.id?"border-primary/60 bg-primary/20":"border-primary/20 bg-primary/5 hover:border-primary/40"),children:[t.jsx("div",{className:"text-2xl mb-2",children:e.icon}),t.jsx("div",{className:"font-semibold text-primary text-sm",children:e.name}),t.jsx("div",{className:"text-xs text-secondary mt-1",children:e.description})]},e.id)))})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-primary mb-3",children:"Project Color"}),t.jsx("div",{className:"flex flex-wrap gap-3",children:i.map((e=>t.jsx("button",{onClick:()=>L((t=>({...t,color:e.color}))),className:"w-10 h-10 rounded-lg border-2 transition-all "+(M.color===e.color?"border-white scale-110 shadow-lg":"border-primary/20 hover:scale-105"),style:{backgroundColor:e.color}},e.id)))})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-primary mb-3",children:"Status"}),t.jsxs("select",{value:M.status,onChange:e=>L((t=>({...t,status:e.target.value}))),className:"select-modern w-full p-3 bg-primary border border-primary/30 focus:border-primary/60 rounded-xl",children:[t.jsx("option",{value:"draft",children:"Draft"}),t.jsx("option",{value:"in-progress",children:"In Progress"}),t.jsx("option",{value:"review",children:"Review"}),t.jsx("option",{value:"completed",children:"Completed"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-primary mb-3",children:"Priority"}),t.jsxs("select",{value:M.priority,onChange:e=>L((t=>({...t,priority:e.target.value}))),className:"select-modern w-full p-3 bg-primary border border-primary/30 focus:border-primary/60 rounded-xl",children:[t.jsx("option",{value:"low",children:"Low"}),t.jsx("option",{value:"medium",children:"Medium"}),t.jsx("option",{value:"high",children:"High"})]})]})]})]})]}),t.jsxs("div",{className:"flex gap-4 pt-8 mt-8 border-t",style:{borderColor:n.interactive.secondary.border},children:[t.jsx("button",{onClick:async()=>{if(!M.title.trim())return;const e={id:`project-${Date.now()}`,title:M.title.trim(),description:M.description.trim(),panels:[],directorNotes:"",createdAt:new Date,updatedAt:new Date,lastOpenedAt:new Date,isStarred:!1,isArchived:!1,tags:M.tags,status:M.status,collaborators:[],thumbnailUrl:"",color:M.color,template:M.template,category:M.category,priority:M.priority},t={id:e.id,title:e.title,description:e.description,panels:e.panels,createdAt:e.createdAt,updatedAt:e.updatedAt};await Oe.saveProject(t);const r=[e,...l];c(r),L({title:"",description:"",tags:[],status:"draft",template:"blank",color:"#3B82F6",category:"",priority:"medium"}),S(!1),z(e)},disabled:!M.title.trim(),className:"flex-1 py-4 text-lg font-semibold rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:M.title.trim()?n.interactive.primary.background:n.interactive.primary.disabled,color:n.interactive.primary.text},onMouseEnter:e=>{M.title.trim()&&(e.currentTarget.style.backgroundColor=n.interactive.primary.hover)},onMouseLeave:e=>{M.title.trim()&&(e.currentTarget.style.backgroundColor=n.interactive.primary.background)},children:"Create Project"}),t.jsx("button",{onClick:()=>S(!1),className:"flex-1 py-4 text-lg font-semibold rounded-lg transition-all duration-200",style:{backgroundColor:n.interactive.secondary.background,color:n.interactive.secondary.text,border:`1px solid ${n.interactive.secondary.border}`},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=n.interactive.secondary.hover},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=n.interactive.secondary.background},children:"Cancel"})]})]}):0===_.length?t.jsxs("div",{className:"text-center py-20 px-6",children:[t.jsx("div",{className:"w-32 h-32 rounded-3xl mx-auto mb-8 flex items-center justify-center",style:{background:`linear-gradient(135deg, ${o.theme.colors.primary[500]}20, ${o.theme.colors.secondary[500]}20)`},children:t.jsx(m,{className:"w-16 h-16",style:{color:`${o.theme.colors.text.primary}60`}})}),t.jsx("h3",{className:"text-2xl font-bold mb-4",style:{color:n.text.primary.color},children:d?"No projects found":"No projects yet"}),t.jsx("p",{className:"text-lg mb-8 max-w-md mx-auto",style:{color:n.text.secondary.color},children:d?"Try adjusting your search terms or filters":"Create your first project to start building amazing storyboards"}),!d&&t.jsxs("button",{onClick:()=>S(!0),className:"px-8 py-4 text-lg font-semibold rounded-lg transition-all duration-200 shadow-xl hover:shadow-2xl",style:{backgroundColor:n.interactive.primary.background,color:n.interactive.primary.text},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=n.interactive.primary.hover,e.currentTarget.style.transform="translateY(-2px)"},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=n.interactive.primary.background,e.currentTarget.style.transform="translateY(0)"},children:[t.jsx(h,{className:"w-5 h-5 mr-2"}),"Create Your First Project"]})]}):t.jsx("div",{className:"grid"===w?"grid p-6":"space-y-4 p-6",style:"grid"===w?{gridTemplateColumns:`repeat(${B.columns}, 1fr)`,gap:B.gap}:{},children:_.map((e=>{var r,a;return t.jsxs("div",{className:"group relative transition-all duration-300 transform hover:scale-105 rounded-2xl border hover:shadow-xl "+("grid"===w?"p-6":"p-4 flex items-center gap-4"),style:{backgroundColor:n.interactive.secondary.background,borderColor:n.interactive.secondary.border,borderLeftColor:e.color,borderLeftWidth:"grid"===w?"4px":"6px"},onMouseEnter:e=>{e.currentTarget.style.borderColor=o.theme.colors.primary[300]},onMouseLeave:e=>{e.currentTarget.style.borderColor=n.interactive.secondary.border},children:["grid"===w?t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:e.color}}),t.jsx("span",{className:"text-xs font-semibold px-2 py-1 rounded-full",style:{backgroundColor:"text-red-600"===q(e.priority)?"#fee2e2":"text-yellow-600"===q(e.priority)?"#fef3c7":"#f0fdf4",color:"text-red-600"===q(e.priority)?"#dc2626":"text-yellow-600"===q(e.priority)?"#d97706":"#059669"},children:null==(r=e.priority)?void 0:r.toUpperCase()})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:t=>{t.stopPropagation(),(async e=>{const t=l.find((t=>t.id===e));if(!t)return;const r={...t,isStarred:!t.isStarred};await F(r)})(e.id)},className:"p-2 rounded-lg transition-colors",style:{color:e.isStarred?"#eab308":n.text.tertiary.color,backgroundColor:e.isStarred?"#fef3c720":"transparent"},onMouseEnter:t=>{e.isStarred||(t.currentTarget.style.color="#eab308")},onMouseLeave:t=>{e.isStarred||(t.currentTarget.style.color=n.text.tertiary.color)},children:t.jsx(J,{className:"w-4 h-4",fill:e.isStarred?"currentColor":"none"})}),t.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[t.jsx("button",{onClick:t=>{t.stopPropagation(),U(e)},className:"p-2 rounded-lg transition-colors",style:{color:n.text.tertiary.color},onMouseEnter:e=>{e.currentTarget.style.color=n.text.primary.color},onMouseLeave:e=>{e.currentTarget.style.color=n.text.tertiary.color},title:"Duplicate",children:t.jsx(R,{className:"w-4 h-4"})}),t.jsx("button",{onClick:t=>{t.stopPropagation(),D(e)},className:"p-2 rounded-lg transition-colors",style:{color:n.text.tertiary.color},onMouseEnter:e=>{e.currentTarget.style.color=n.text.primary.color},onMouseLeave:e=>{e.currentTarget.style.color=n.text.tertiary.color},title:"Edit",children:t.jsx(g,{className:"w-4 h-4"})}),t.jsx("button",{onClick:t=>{t.stopPropagation(),W([e.id])},className:"p-2 rounded-lg transition-colors",style:{color:n.text.tertiary.color},onMouseEnter:e=>{e.currentTarget.style.color=n.text.primary.color},onMouseLeave:e=>{e.currentTarget.style.color=n.text.tertiary.color},title:"Export",children:t.jsx(N,{className:"w-4 h-4"})})]})]})]}),t.jsxs("div",{className:"mb-4",onClick:()=>z(e),children:[t.jsx("h3",{className:"font-bold text-lg mb-2 line-clamp-2",style:{color:n.text.primary.color},children:e.title}),e.description&&t.jsx("p",{className:"text-sm line-clamp-3 mb-3",style:{color:n.text.secondary.color},children:e.description}),e.category&&t.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[t.jsx(p,{className:"w-3 h-3",style:{color:n.text.tertiary.color}}),t.jsx("span",{className:"text-xs",style:{color:n.text.tertiary.color},children:e.category})]}),e.tags&&e.tags.length>0&&t.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[e.tags.slice(0,3).map(((e,r)=>t.jsx("span",{className:"px-2 py-1 rounded-full text-xs",style:{backgroundColor:`${o.theme.colors.primary[500]}20`,color:o.theme.colors.primary[600]},children:e},r))),e.tags.length>3&&t.jsxs("span",{className:"px-2 py-1 rounded-full text-xs",style:{backgroundColor:n.interactive.secondary.background,color:n.text.tertiary.color},children:["+",e.tags.length-3]})]}),t.jsxs("div",{className:"flex items-center justify-between text-xs",style:{color:n.text.muted.color},children:[t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(ge,{className:"w-3 h-3"}),new Date(e.updatedAt).toLocaleDateString()]}),t.jsxs("span",{className:"flex items-center gap-1",children:[t.jsx(ye,{className:"w-3 h-3"}),e.panels.length," panels"]})]})]}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${H(e.status)} text-white`,children:G(e.status)}),t.jsx("input",{type:"checkbox",checked:k.includes(e.id),onChange:t=>{t.stopPropagation(),C((r=>t.target.checked?[...r,e.id]:r.filter((t=>t!==e.id))))},className:"w-4 h-4 rounded accent-primary"})]})]}):t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-6 h-6 rounded-full flex-shrink-0",style:{backgroundColor:e.color}}),t.jsxs("div",{className:"flex-1 min-w-0",onClick:()=>z(e),children:[t.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[t.jsx("h3",{className:"font-semibold text-lg truncate",style:{color:n.text.primary.color},children:e.title}),e.isStarred&&t.jsx(J,{className:"w-4 h-4 text-yellow-500",fill:"currentColor"}),t.jsx("span",{className:"text-xs font-semibold px-2 py-1 rounded-full",style:{backgroundColor:"text-red-600"===q(e.priority)?"#fee2e2":"text-yellow-600"===q(e.priority)?"#fef3c7":"#f0fdf4",color:"text-red-600"===q(e.priority)?"#dc2626":"text-yellow-600"===q(e.priority)?"#d97706":"#059669"},children:null==(a=e.priority)?void 0:a.toUpperCase()})]}),e.description&&t.jsx("p",{className:"text-sm truncate mb-2",style:{color:n.text.secondary.color},children:e.description}),t.jsxs("div",{className:"flex items-center gap-4 text-xs",style:{color:n.text.muted.color},children:[t.jsxs("span",{children:[e.panels.length," panels"]}),t.jsx("span",{children:new Date(e.updatedAt).toLocaleDateString()}),t.jsx("span",{className:"capitalize",children:G(e.status)}),e.category&&t.jsx("span",{children:e.category})]})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:t=>{t.stopPropagation(),U(e)},className:"p-2 rounded-lg transition-colors",style:{color:n.text.tertiary.color},onMouseEnter:e=>{e.currentTarget.style.color=n.text.primary.color},onMouseLeave:e=>{e.currentTarget.style.color=n.text.tertiary.color},title:"Duplicate",children:t.jsx(R,{className:"w-4 h-4"})}),t.jsx("button",{onClick:t=>{t.stopPropagation(),D(e)},className:"p-2 rounded-lg transition-colors",style:{color:n.text.tertiary.color},onMouseEnter:e=>{e.currentTarget.style.color=n.text.primary.color},onMouseLeave:e=>{e.currentTarget.style.color=n.text.tertiary.color},title:"Edit",children:t.jsx(g,{className:"w-4 h-4"})}),t.jsx("input",{type:"checkbox",checked:k.includes(e.id),onChange:t=>{t.stopPropagation(),C((r=>t.target.checked?[...r,e.id]:r.filter((t=>t!==e.id))))},className:"w-4 h-4 rounded accent-primary"})]})]}),"grid"===w&&k.includes(e.id)&&t.jsx("div",{className:"absolute inset-0 bg-primary/20 backdrop-blur-sm rounded-2xl border-2 border-primary/50 flex items-center justify-center",children:t.jsx(ye,{className:"w-8 h-8 text-primary"})})]},e.id)}))})}),E&&t.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",children:t.jsxs("div",{className:"bg-secondary rounded-2xl p-6 max-w-md w-full border border-primary/20",children:[t.jsx("h3",{className:"text-xl font-bold text-primary mb-4",children:"Edit Project"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-primary mb-2",children:"Project Name"}),t.jsx("input",{type:"text",value:E.title,onChange:e=>D((t=>t?{...t,title:e.target.value}:null)),className:"input-modern w-full p-3 bg-primary border border-primary/30 rounded-xl"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-primary mb-2",children:"Color"}),t.jsx("div",{className:"flex gap-2",children:i.map((e=>t.jsx("button",{onClick:()=>D((t=>t?{...t,color:e.color}:null)),className:"w-8 h-8 rounded-lg border-2 transition-all "+(E.color===e.color?"border-white scale-110":"border-primary/20 hover:scale-105"),style:{backgroundColor:e.color}},e.id)))})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-primary mb-2",children:"Status"}),t.jsxs("select",{value:E.status,onChange:e=>D((t=>t?{...t,status:e.target.value}:null)),className:"select-modern w-full p-2 bg-primary border border-primary/30 rounded-lg text-sm",children:[t.jsx("option",{value:"draft",children:"Draft"}),t.jsx("option",{value:"in-progress",children:"In Progress"}),t.jsx("option",{value:"review",children:"Review"}),t.jsx("option",{value:"completed",children:"Completed"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-primary mb-2",children:"Priority"}),t.jsxs("select",{value:E.priority,onChange:e=>D((t=>t?{...t,priority:e.target.value}:null)),className:"select-modern w-full p-2 bg-primary border border-primary/30 rounded-lg text-sm",children:[t.jsx("option",{value:"low",children:"Low"}),t.jsx("option",{value:"medium",children:"Medium"}),t.jsx("option",{value:"high",children:"High"})]})]})]})]}),t.jsxs("div",{className:"flex gap-3 mt-6",children:[t.jsx("button",{onClick:()=>{(async(e,t)=>{const r=l.find((t=>t.id===e));if(!r)return;const a={...r,...t,updatedAt:new Date};await F(a),D(null)})(E.id,E)},className:"btn-primary flex-1 py-3",children:"Save Changes"}),t.jsx("button",{onClick:()=>D(null),className:"btn-secondary flex-1 py-3",children:"Cancel"})]})]})})]})}):null}function zt({isOpen:r,onClose:a}){const{state:s,setTheme:o}=Je(),[i,c]=e.useState(!1),[d,m]=e.useState(s.currentTheme),p=e.useRef(null),h=e.useMemo((()=>Object.values(Be)),[]),g=e.useMemo((()=>({light:"â˜€ï¸ Classic & Clean",dark:"ðŸŒ™ Easy on the Eyes",purple:"ðŸŽ¨ Creative & Artistic",blue:"ðŸ’¼ Professional & Calm",green:"ðŸŒ¿ Natural & Fresh",orange:"ðŸ”¥ Warm & Energetic",rose:"ðŸŒ¹ Elegant & Romantic",emerald:"ðŸ’Ž Rich & Vibrant",teal:"ðŸŒŠ Cool & Modern",amber:"â˜€ï¸ Bright & Cheerful",violet:"ðŸ”® Mysterious & Bold",slate:"ðŸ”ï¸ Minimal & Sophisticated"})),[]),y=e.useCallback((async e=>{if(!i&&e!==s.currentTheme){c(!0),m(e),await new Promise((e=>setTimeout(e,100)));try{o(e)}finally{setTimeout((()=>c(!1)),300)}}}),[o,s.currentTheme,i]),x=e.useCallback((()=>{i||a()}),[a,i]);return e.useEffect((()=>{m(s.currentTheme)}),[s.currentTheme]),r?t.jsx(yt,{isOpen:r,onClose:x,title:"Theme Settings",subtitle:`Customize your workspace appearance â€¢ ${h.length} themes available`,icon:t.jsx(u,{className:"w-5 h-5"}),defaultWidth:"min(92vw, 1000px)",defaultHeight:"min(85vh, 700px)",maxWidth:"98vw",maxHeight:"95vh",resizable:!0,minimizable:!0,maximizable:!0,windowId:"theme-settings",zIndex:9100,children:t.jsxs("div",{className:"h-full flex flex-col transform-gpu",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-primary/20 bg-secondary/30 backdrop-blur-sm",children:[t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center shadow-sm transition-all duration-300",style:{background:`linear-gradient(135deg, ${s.theme.colors.primary[600]}, ${s.theme.colors.primary[700]})`},children:t.jsx(u,{className:"w-4 h-4 text-white"})}),t.jsx("div",{className:"text-sm text-secondary",children:"Choose your preferred theme"})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsxs("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-lg border transition-all duration-200",style:{backgroundColor:`${s.theme.colors.background.tertiary}50`,borderColor:`${s.theme.colors.border.primary}40`},children:[t.jsx(xe,{className:"w-4 h-4 opacity-60",style:{color:s.theme.colors.text.secondary}}),t.jsx(fe,{className:"w-4 h-4 opacity-60",style:{color:s.theme.colors.text.secondary}}),t.jsx(be,{className:"w-4 h-4 opacity-60",style:{color:s.theme.colors.text.secondary}})]}),t.jsx("button",{onClick:x,disabled:i,className:"p-3 rounded-xl transition-all duration-200 border border-transparent hover:shadow-lg group disabled:opacity-50",style:{color:s.theme.colors.text.secondary},onMouseEnter:e=>{i||(e.currentTarget.style.backgroundColor=`${s.theme.colors.background.tertiary}80`,e.currentTarget.style.borderColor=`${s.theme.colors.border.primary}60`,e.currentTarget.style.color=s.theme.colors.text.primary)},onMouseLeave:e=>{e.currentTarget.style.backgroundColor="transparent",e.currentTarget.style.borderColor="transparent",e.currentTarget.style.color=s.theme.colors.text.secondary},children:t.jsx(n,{className:"w-5 h-5 transition-transform duration-200"})})]})]}),t.jsxs("div",{className:"p-6 overflow-y-auto flex-1 scrollable",style:{backgroundColor:`${s.theme.colors.background.tertiary}20`,color:s.theme.colors.text.primary},children:[t.jsx("div",{className:"mb-6 p-4 rounded-xl border backdrop-blur-sm transition-all duration-300",style:{background:`linear-gradient(to right, ${s.theme.colors.primary[500]}20, ${s.theme.colors.primary[600]}20)`,borderColor:`${s.theme.colors.border.primary}60`},children:t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("div",{className:"w-8 h-8 rounded-full border-2 shadow-lg transition-all duration-500",style:{backgroundColor:s.theme.colors.primary[600],borderColor:`${s.theme.colors.primary[300]}60`,animation:i?"pulse 1s ease-in-out infinite":"none"}}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("p",{className:"text-lg font-semibold transition-colors duration-200",style:{color:s.theme.colors.text.primary},children:["Current Theme: ",s.theme.name]}),t.jsx("p",{className:"text-sm transition-colors duration-200",style:{color:s.theme.colors.text.secondary},children:i?"Applying theme changes...":"Theme changes are saved automatically and persist across sessions"})]}),t.jsx(l,{className:"w-6 h-6 transition-all duration-300",style:{color:s.theme.colors.text.primary,animation:i?"spin 1s linear infinite":"none"}})]})}),t.jsx("div",{ref:p,className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:h.map((e=>{var r;const a=d===e.id,o=s.currentTheme===e.id;return t.jsxs("div",{className:`relative cursor-pointer rounded-xl border-2 transition-all duration-300 overflow-hidden group transform-gpu ${a?"border-primary-400 ring-2 ring-primary-200/50 shadow-xl shadow-primary-500/20 scale-105":"border-primary/30 hover:border-primary/60 hover:shadow-lg hover:scale-102"} ${i&&!a?"opacity-60 pointer-events-none":""}`,style:{willChange:"transform, box-shadow",transform:"translateZ(0) "+(a?"scale(1.02)":"scale(1)")},onClick:()=>y(e.id),children:[t.jsxs("div",{className:"h-32 p-5 flex items-center justify-between relative overflow-hidden",style:{backgroundColor:e.colors.background.secondary,backgroundImage:`linear-gradient(135deg, ${e.colors.background.secondary}, ${e.colors.background.tertiary||e.colors.background.primary})`},children:[t.jsx("div",{className:"absolute inset-0 opacity-10 pointer-events-none",style:{backgroundImage:`radial-gradient(circle at 30% 70%, ${e.colors.primary[500]} 0%, transparent 50%)`}}),t.jsxs("div",{className:"flex items-center space-x-4 relative z-10",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl shadow-lg border border-white/20 transition-transform duration-300",style:{background:`linear-gradient(135deg, ${e.colors.primary[600]}, ${e.colors.primary[500]})`,transform:a?"scale(1.1)":"scale(1)"}}),t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"w-20 h-3 rounded-full transition-all duration-200",style:{backgroundColor:e.colors.text.primary}}),t.jsx("div",{className:"w-16 h-2 rounded-full transition-all duration-200",style:{backgroundColor:e.colors.text.secondary}}),t.jsx("div",{className:"w-12 h-2 rounded-full opacity-60 transition-all duration-200",style:{backgroundColor:e.colors.text.secondary}})]})]}),t.jsx("div",{className:"flex flex-col space-y-1 relative z-10",children:[e.colors.primary[500],e.colors.primary[400],e.colors.primary[300]].map(((e,r)=>t.jsx("div",{className:"w-4 h-8 rounded-lg shadow-md transition-transform duration-200",style:{backgroundColor:e,transform:a?`scale(1.1) translateX(${2*r}px)`:"scale(1)"}},r)))}),a&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary-500/20 to-primary-600/30 backdrop-blur-sm flex items-center justify-center",children:t.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center shadow-2xl transition-all duration-300",children:t.jsx(ce,{className:"w-8 h-8 text-primary-600"})})}),i&&a&&t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary-500/10 to-primary-600/20 backdrop-blur-sm flex items-center justify-center",children:t.jsx("div",{className:"w-12 h-12 border-4 border-white border-t-primary-600 rounded-full animate-spin"})})]}),t.jsxs("div",{className:"p-5 border-t transition-all duration-200",style:{backgroundColor:e.colors.background.primary,borderColor:(null==(r=e.colors.border)?void 0:r.primary)||e.colors.primary[200]},children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-bold text-lg transition-colors duration-200",style:{color:e.colors.text.primary},children:e.name}),t.jsx("p",{className:"text-sm mt-1 transition-colors duration-200",style:{color:e.colors.text.secondary},children:g[e.id]})]}),o&&t.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ml-3 shadow-lg transition-all duration-300",style:{backgroundColor:e.colors.primary[600]},children:t.jsx(l,{className:"w-4 h-4 text-white"})})]}),t.jsxs("div",{className:"mt-3 flex flex-wrap gap-1",children:["dark"===e.id&&t.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-gray-800 text-gray-200",children:"Dark Mode"}),"light"===e.id&&t.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-gray-100 text-gray-800",children:"Light Mode"}),!["light","dark"].includes(e.id)&&t.jsx("span",{className:"px-2 py-1 text-xs rounded-full",style:{backgroundColor:e.colors.primary[100],color:e.colors.primary[800]},children:"Colorful"}),t.jsx("span",{className:"px-2 py-1 text-xs rounded-full bg-green-100 text-green-800",children:"High Contrast"})]})]}),t.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/0 to-white/5 opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none rounded-xl"})]},e.id)}))}),t.jsx("div",{className:"mt-8 p-5 bg-gradient-to-r from-tertiary/50 to-secondary/50 rounded-xl border border-primary/20 backdrop-blur-sm",children:t.jsxs("div",{className:"flex items-start space-x-4",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg flex items-center justify-center flex-shrink-0",children:t.jsx(l,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-primary mb-2",children:"Pro Tips for Theme Selection"}),t.jsxs("ul",{className:"text-sm text-secondary space-y-1",children:[t.jsxs("li",{children:["â€¢ ",t.jsx("strong",{children:"Dark themes"})," reduce eye strain during long work sessions"]}),t.jsxs("li",{children:["â€¢ ",t.jsx("strong",{children:"Light themes"})," provide better contrast for detailed work"]}),t.jsxs("li",{children:["â€¢ ",t.jsx("strong",{children:"Colored themes"})," can match your project's mood and style"]}),t.jsx("li",{children:"â€¢ All themes are designed for optimal readability and accessibility"})]})]})]})})]}),t.jsxs("div",{className:"flex justify-between items-center p-6 border-t border-primary/20 bg-secondary/30 backdrop-blur-sm rounded-b-2xl",children:[t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-secondary",children:[t.jsx(u,{className:"w-4 h-4"}),t.jsx("span",{children:i?"Applying theme...":"Themes apply instantly across all components"})]}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:()=>y("light"),disabled:i||"light"===s.currentTheme,className:"px-4 py-2 bg-white/10 hover:bg-white/20 rounded-lg transition-all duration-200 text-primary border border-white/20 hover:border-white/40 disabled:opacity-50 disabled:cursor-not-allowed",children:"Reset to Light"}),t.jsx("button",{onClick:x,disabled:i,className:"btn-primary px-6 py-2 shadow-lg hover:shadow-xl transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:"Done"})]})]})]})}):null}function Rt({isOpen:r,onClose:a,onOpenThemeSettings:s}){const{state:o}=Je(),[n,i]=e.useState("general"),[l,c]=e.useState({openaiApiKey:"",autoSave:!0,notifications:!0,videoQuality:"high",exportFormat:"json",aiModel:"gpt-4o-mini",imageModel:"dall-e-3",maxTokens:4096,temperature:.7,language:"en"}),[d,m]=e.useState("idle"),[p,h]=e.useState(!1);e.useEffect((()=>{y()}),[]);const y=async()=>{try{const e=await Oe.getSettings(),t=tt.getApiKey();c((r=>{var a;return{...r,openaiApiKey:t||"",...e,autoSave:null==(a=e.autoSave)||a}}))}catch(e){console.error("Error loading settings:",e)}};if(!r)return null;const x=[{id:"general",label:"General",icon:fe,gradient:"from-blue-500 to-cyan-500"},{id:"ai",label:"AI Settings",icon:k,gradient:"from-purple-500 to-pink-500"},{id:"themes",label:"Themes",icon:u,gradient:"from-pink-500 to-rose-500"},{id:"advanced",label:"Advanced",icon:we,gradient:"from-orange-500 to-red-500"}];return t.jsxs(yt,{isOpen:r,onClose:a,title:"Settings & Preferences",subtitle:"Configure your workspace â€¢ AI models â€¢ Export settings",icon:t.jsx(g,{className:"w-5 h-5"}),defaultWidth:"min(92vw, 1000px)",defaultHeight:"min(85vh, 700px)",maxWidth:"98vw",maxHeight:"95vh",resizable:!0,minimizable:!0,maximizable:!0,windowId:"settings-menu",zIndex:9100,children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-primary/20 bg-secondary/30",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center shadow-sm",style:{background:`linear-gradient(135deg, ${o.theme.colors.primary[600]}, ${o.theme.colors.primary[700]})`},children:t.jsx(g,{className:"w-4 h-4 text-white"})}),t.jsx("div",{className:"text-sm text-secondary",children:"Customize your Storyboard AI experience"})]}),t.jsxs("div",{className:`flex items-center space-x-2 px-3 py-2 rounded-lg transition-all duration-300 ${("saving"===d?"bg-blue-500/20 text-blue-400":"saved"===d&&"bg-green-500/20 text-green-400")||"error"===d&&"bg-red-500/20 text-red-400"||"bg-tertiary/50 text-secondary"}`,children:["saving"===d&&t.jsx(ve,{className:"w-4 h-4 animate-spin"}),"saved"===d&&t.jsx(oe,{className:"w-4 h-4"}),"error"===d&&t.jsx(se,{className:"w-4 h-4"}),"idle"===d&&t.jsx(v,{className:"w-4 h-4"}),t.jsxs("span",{className:"text-xs font-medium",children:["saving"===d&&"Saving...","saved"===d&&"Saved","error"===d&&"Error","idle"===d&&"Ready"]})]})]}),t.jsxs("div",{className:"flex flex-col md:flex-row h-full max-h-[80vh]",children:[t.jsxs("div",{className:"w-full md:w-64 border-b md:border-b-0 md:border-r p-4 md:p-6",style:{borderColor:o.theme.colors.border.primary,backgroundColor:o.theme.colors.background.secondary},children:[t.jsx("nav",{className:"flex md:flex-col space-x-2 md:space-x-0 md:space-y-2 overflow-x-auto md:overflow-x-visible",children:x.map((({id:e,label:r,icon:a,gradient:s})=>t.jsxs("button",{onClick:()=>i(e),className:"flex-shrink-0 md:flex-shrink flex items-center space-x-3 p-3 md:p-4 rounded-lg transition-all duration-200",style:{backgroundColor:n===e?o.theme.colors.primary[500]:"transparent",color:n===e?"#ffffff":o.theme.colors.text.secondary},onMouseEnter:t=>{n!==e&&(t.currentTarget.style.backgroundColor=o.theme.colors.background.tertiary,t.currentTarget.style.color=o.theme.colors.text.primary)},onMouseLeave:t=>{n!==e&&(t.currentTarget.style.backgroundColor="transparent",t.currentTarget.style.color=o.theme.colors.text.secondary)},children:[t.jsx(a,{className:"w-4 h-4 md:w-5 md:h-5"}),t.jsx("span",{className:"font-medium text-sm md:text-base whitespace-nowrap",children:r})]},e)))}),t.jsxs("div",{className:"mt-8 space-y-3",children:[t.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider",style:{color:o.theme.colors.text.secondary},children:"Quick Actions"}),t.jsxs("button",{onClick:()=>{const e={settings:{...l,openaiApiKey:""},exportedAt:new Date,version:"1.0"},t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download="storyboard-settings-export.json",document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)},className:"w-full flex items-center space-x-3 p-3 rounded-lg transition-all duration-200 group",style:{backgroundColor:`${o.theme.colors.background.tertiary}60`,color:o.theme.colors.text.secondary},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=`${o.theme.colors.background.tertiary}80`,e.currentTarget.style.color=o.theme.colors.text.primary},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=`${o.theme.colors.background.tertiary}60`,e.currentTarget.style.color=o.theme.colors.text.secondary},children:[t.jsx(N,{className:"w-4 h-4 group-hover:scale-110 transition-transform"}),t.jsx("span",{className:"text-sm",children:"Export Settings"})]}),t.jsxs("label",{className:"w-full flex items-center space-x-3 p-3 rounded-lg transition-all duration-200 cursor-pointer group",style:{backgroundColor:`${o.theme.colors.background.tertiary}60`,color:o.theme.colors.text.secondary},onMouseEnter:e=>{e.currentTarget.style.backgroundColor=`${o.theme.colors.background.tertiary}80`,e.currentTarget.style.color=o.theme.colors.text.primary},onMouseLeave:e=>{e.currentTarget.style.backgroundColor=`${o.theme.colors.background.tertiary}60`,e.currentTarget.style.color=o.theme.colors.text.secondary},children:[t.jsx(w,{className:"w-4 h-4 group-hover:scale-110 transition-transform"}),t.jsx("span",{className:"text-sm",children:"Import Settings"}),t.jsx("input",{type:"file",accept:".json",onChange:e=>{var t;const r=null==(t=e.target.files)?void 0:t[0];if(!r)return;const a=new FileReader;a.onload=e=>{var t;try{const r=JSON.parse(null==(t=e.target)?void 0:t.result);r.settings&&(c((e=>({...e,...r.settings,openaiApiKey:e.openaiApiKey}))),m("saved"),setTimeout((()=>m("idle")),2e3))}catch(r){console.error("Error importing settings:",r),m("error"),setTimeout((()=>m("idle")),3e3)}},a.readAsText(r)},className:"hidden"})]}),t.jsxs("button",{onClick:()=>{confirm("Reset all settings to defaults? This cannot be undone.")&&c({openaiApiKey:l.openaiApiKey,autoSave:!0,notifications:!0,videoQuality:"high",exportFormat:"json",aiModel:"gpt-4o-mini",imageModel:"dall-e-3",maxTokens:4096,temperature:.7,language:"en"})},className:"w-full flex items-center space-x-3 p-3 rounded-lg bg-red-500/20 hover:bg-red-500/30 transition-all duration-200 text-red-400 hover:text-red-300 group",children:[t.jsx(se,{className:"w-4 h-4 group-hover:scale-110 transition-transform"}),t.jsx("span",{className:"text-sm",children:"Reset to Defaults"})]})]})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-6 scrollable backdrop-blur-sm",style:{backgroundColor:`${o.theme.colors.background.tertiary}30`,color:o.theme.colors.text.primary},children:["general"===n&&t.jsx("div",{className:"space-y-6 animate-fade-in",children:t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center space-x-2",style:{color:o.theme.colors.text.primary},children:[t.jsx(fe,{className:"w-5 h-5"}),t.jsx("span",{children:"General Preferences"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsx("div",{className:"backdrop-blur-sm rounded-xl p-5 border transition-all duration-300",style:{backgroundColor:`${o.theme.colors.background.secondary}70`,borderColor:`${o.theme.colors.border.primary}60`},onMouseEnter:e=>{e.currentTarget.style.borderColor=`${o.theme.colors.border.primary}90`},onMouseLeave:e=>{e.currentTarget.style.borderColor=`${o.theme.colors.border.primary}60`},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium",style:{color:o.theme.colors.text.primary},children:"Auto Save"}),t.jsx("p",{className:"text-sm mt-1",style:{color:o.theme.colors.text.secondary},children:"Automatically save changes as you work"})]}),t.jsx("button",{onClick:()=>c((e=>({...e,autoSave:!e.autoSave}))),className:"relative w-12 h-6 rounded-full transition-all duration-300 "+(l.autoSave?"bg-green-500":"bg-secondary-400"),children:t.jsx("div",{className:"absolute top-1 w-4 h-4 bg-white rounded-full shadow-lg transition-transform duration-300 "+(l.autoSave?"translate-x-7":"translate-x-1")})})]})}),t.jsx("div",{className:"bg-secondary/40 backdrop-blur-sm rounded-xl p-5 border border-primary/20 hover:border-primary/40 transition-all duration-300",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-primary",children:"Notifications"}),t.jsx("p",{className:"text-sm text-secondary/80 mt-1",children:"Show system notifications and alerts"})]}),t.jsx("button",{onClick:()=>c((e=>({...e,notifications:!e.notifications}))),className:"relative w-12 h-6 rounded-full transition-all duration-300 "+(l.notifications?"bg-blue-500":"bg-secondary-400"),children:t.jsx("div",{className:"absolute top-1 w-4 h-4 bg-white rounded-full shadow-lg transition-transform duration-300 "+(l.notifications?"translate-x-7":"translate-x-1")})})]})}),t.jsx("div",{className:"bg-secondary/40 backdrop-blur-sm rounded-xl p-5 border border-primary/20 hover:border-primary/40 transition-all duration-300",children:t.jsxs("div",{children:[t.jsxs("h4",{className:"font-medium text-primary mb-3 flex items-center space-x-2",children:[t.jsx(je,{className:"w-4 h-4"}),t.jsx("span",{children:"Language"})]}),t.jsxs("select",{value:l.language,onChange:e=>c((t=>({...t,language:e.target.value}))),className:"select-modern w-full bg-tertiary/50 border border-primary/30 focus:border-primary/60",children:[t.jsx("option",{value:"en",children:"English"}),t.jsx("option",{value:"es",children:"EspaÃ±ol"}),t.jsx("option",{value:"fr",children:"FranÃ§ais"}),t.jsx("option",{value:"de",children:"Deutsch"}),t.jsx("option",{value:"ja",children:"æ—¥æœ¬èªž"})]})]})}),t.jsx("div",{className:"bg-secondary/40 backdrop-blur-sm rounded-xl p-5 border border-primary/20 hover:border-primary/40 transition-all duration-300",children:t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-primary mb-3",children:"Default Export Format"}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:["json","pdf","video"].map((e=>t.jsx("button",{onClick:()=>c((t=>({...t,exportFormat:e}))),className:"p-2 rounded-lg text-sm font-medium transition-all duration-200",style:{backgroundColor:l.exportFormat===e?o.theme.colors.primary[500]:`${o.theme.colors.background.tertiary}80`,color:l.exportFormat===e?"#ffffff":o.theme.colors.text.secondary,boxShadow:l.exportFormat===e?"0 4px 12px rgba(0,0,0,0.15)":"none"},onMouseEnter:t=>{l.exportFormat!==e&&(t.currentTarget.style.backgroundColor=`${o.theme.colors.background.tertiary}90`,t.currentTarget.style.color=o.theme.colors.text.primary)},onMouseLeave:t=>{l.exportFormat!==e&&(t.currentTarget.style.backgroundColor=`${o.theme.colors.background.tertiary}80`,t.currentTarget.style.color=o.theme.colors.text.secondary)},children:e.toUpperCase()},e)))})]})})]})]})}),"ai"===n&&t.jsx("div",{className:"space-y-6 animate-fade-in",children:t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-semibold text-primary mb-4 flex items-center space-x-2",children:[t.jsx(k,{className:"w-5 h-5"}),t.jsx("span",{children:"AI Configuration"})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-secondary/40 backdrop-blur-sm rounded-xl p-6 border border-primary/20 hover:border-primary/40 transition-all duration-300",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("h4",{className:"font-medium text-primary flex items-center space-x-2",children:[t.jsx(we,{className:"w-4 h-4"}),t.jsx("span",{children:"OpenAI API Key"})]}),t.jsxs("button",{onClick:()=>h(!p),className:"flex items-center space-x-1 text-secondary hover:text-primary transition-colors",children:[t.jsx(_,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:p?"Hide":"Show"})]})]}),t.jsx("input",{type:p?"text":"password",value:l.openaiApiKey,onChange:e=>c((t=>({...t,openaiApiKey:e.target.value}))),placeholder:"sk-...",className:"input-modern w-full bg-tertiary/50 border border-primary/30 focus:border-primary/60"}),t.jsxs("p",{className:"text-xs text-secondary/80 mt-2",children:["Your API key is stored locally and never shared. Get one from"," ",t.jsx("a",{href:"https://platform.openai.com/api-keys",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-secondary underline",children:"OpenAI Platform"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-secondary/40 backdrop-blur-sm rounded-xl p-5 border border-primary/20 hover:border-primary/40 transition-all duration-300",children:[t.jsx("h4",{className:"font-medium text-primary mb-3",children:"Text Generation Model"}),t.jsxs("select",{value:l.aiModel,onChange:e=>c((t=>({...t,aiModel:e.target.value}))),className:"select-modern w-full bg-tertiary/50 border border-primary/30 focus:border-primary/60",children:[t.jsx("option",{value:"gpt-4o-mini",children:"GPT-4o Mini (Fast & Economic)"}),t.jsx("option",{value:"gpt-4o",children:"GPT-4o (Balanced)"}),t.jsx("option",{value:"gpt-4",children:"GPT-4 (Most Capable)"})]})]}),t.jsxs("div",{className:"bg-secondary/40 backdrop-blur-sm rounded-xl p-5 border border-primary/20 hover:border-primary/40 transition-all duration-300",children:[t.jsx("h4",{className:"font-medium text-primary mb-3",children:"Image Generation Model"}),t.jsxs("select",{value:l.imageModel,onChange:e=>c((t=>({...t,imageModel:e.target.value}))),className:"select-modern w-full bg-tertiary/50 border border-primary/30 focus:border-primary/60",children:[t.jsx("option",{value:"dall-e-3",children:"DALL-E 3 (Best Quality)"}),t.jsx("option",{value:"dall-e-2",children:"DALL-E 2 (Faster)"})]})]})]})]})]})}),"themes"===n&&t.jsx("div",{className:"space-y-6 animate-fade-in",children:t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-semibold text-primary mb-4 flex items-center space-x-2",children:[t.jsx(u,{className:"w-5 h-5"}),t.jsx("span",{children:"Theme & Appearance"})]}),t.jsxs("div",{className:"bg-secondary/40 backdrop-blur-sm rounded-xl p-6 border border-primary/20 hover:border-primary/40 transition-all duration-300",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-primary",children:"Theme Settings"}),t.jsx("p",{className:"text-sm text-secondary/80 mt-1",children:"Customize your workspace appearance"})]}),t.jsx("button",{onClick:s,className:"btn-primary px-4 py-2 text-sm shadow-lg hover:shadow-xl transition-all duration-300",children:"Open Theme Selector"})]}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mt-4",children:t.jsxs("div",{className:"flex items-center space-x-2 p-3 rounded-lg bg-tertiary/30",children:[t.jsx("div",{className:"w-4 h-4 rounded-full border-2 border-white/30",style:{backgroundColor:o.theme.colors.primary[500]}}),t.jsxs("span",{className:"text-sm font-medium text-primary",children:["Current: ",o.theme.name]})]})})]})]})}),"advanced"===n&&t.jsx("div",{className:"space-y-6 animate-fade-in",children:t.jsxs("div",{children:[t.jsxs("h3",{className:"text-lg font-semibold text-primary mb-4 flex items-center space-x-2",children:[t.jsx(we,{className:"w-5 h-5"}),t.jsx("span",{children:"Advanced Settings"})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-secondary/40 backdrop-blur-sm rounded-xl p-5 border border-primary/20 hover:border-primary/40 transition-all duration-300",children:[t.jsx("h4",{className:"font-medium text-primary mb-3",children:"Max Tokens"}),t.jsx("input",{type:"range",min:"1000",max:"8000",step:"500",value:l.maxTokens,onChange:e=>c((t=>({...t,maxTokens:parseInt(e.target.value)}))),className:"w-full accent-primary"}),t.jsxs("div",{className:"flex justify-between text-sm text-secondary mt-2",children:[t.jsx("span",{children:"1000"}),t.jsx("span",{className:"font-medium",children:l.maxTokens}),t.jsx("span",{children:"8000"})]})]}),t.jsxs("div",{className:"bg-secondary/40 backdrop-blur-sm rounded-xl p-5 border border-primary/20 hover:border-primary/40 transition-all duration-300",children:[t.jsx("h4",{className:"font-medium text-primary mb-3",children:"Creativity (Temperature)"}),t.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:l.temperature,onChange:e=>c((t=>({...t,temperature:parseFloat(e.target.value)}))),className:"w-full accent-primary"}),t.jsxs("div",{className:"flex justify-between text-sm text-secondary mt-2",children:[t.jsx("span",{children:"0 (Focused)"}),t.jsx("span",{className:"font-medium",children:l.temperature}),t.jsx("span",{children:"1 (Creative)"})]})]}),t.jsxs("div",{className:"bg-secondary/40 backdrop-blur-sm rounded-xl p-5 border border-primary/20 hover:border-primary/40 transition-all duration-300",children:[t.jsx("h4",{className:"font-medium text-primary mb-3",children:"Video Export Quality"}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:["standard","high","ultra"].map((e=>t.jsx("button",{onClick:()=>c((t=>({...t,videoQuality:e}))),className:"p-2 rounded-lg text-sm font-medium transition-all duration-200",style:{backgroundColor:l.videoQuality===e?o.theme.colors.primary[500]:`${o.theme.colors.background.tertiary}80`,color:l.videoQuality===e?"#ffffff":o.theme.colors.text.secondary,boxShadow:l.videoQuality===e?"0 4px 12px rgba(0,0,0,0.15)":"none"},onMouseEnter:t=>{l.videoQuality!==e&&(t.currentTarget.style.backgroundColor=`${o.theme.colors.background.tertiary}90`,t.currentTarget.style.color=o.theme.colors.text.primary)},onMouseLeave:t=>{l.videoQuality!==e&&(t.currentTarget.style.backgroundColor=`${o.theme.colors.background.tertiary}80`,t.currentTarget.style.color=o.theme.colors.text.secondary)},children:e.charAt(0).toUpperCase()+e.slice(1)},e)))})]})]})]})})]})]}),t.jsxs("div",{className:"flex justify-between items-center p-6 border-t border-primary/20 bg-secondary/30 backdrop-blur-sm",children:[t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-secondary",children:[t.jsx(u,{className:"w-4 h-4"}),t.jsx("span",{children:"Settings are saved automatically"})]}),t.jsx("div",{className:"flex space-x-3",children:t.jsx("button",{onClick:async()=>{m("saving");try{l.openaiApiKey.trim()&&tt.setApiKey(l.openaiApiKey.trim()),await Oe.saveSettings({autoSave:l.autoSave,notifications:l.notifications,videoQuality:l.videoQuality,exportFormat:l.exportFormat,aiModel:l.aiModel,imageModel:l.imageModel,maxTokens:l.maxTokens,temperature:l.temperature,language:l.language,lastUsed:new Date}),m("saved"),setTimeout((()=>m("idle")),2e3)}catch(e){console.error("Error saving settings:",e),m("error"),setTimeout((()=>m("idle")),3e3)}},disabled:"saving"===d,className:"btn-primary px-6 py-2 shadow-lg hover:shadow-xl transition-all duration-300 disabled:opacity-50",children:"saving"===d?"Saving...":"Save Changes"})})]})]})}const Ut=({isOpen:r,onClose:a})=>{const{state:s}=Je(),[o,n]=e.useState(new Set(["getting-started"])),c=[{id:"getting-started",title:"Getting Started",icon:F,content:[{title:"Quick Start",tips:['Click "New Project" in the sidebar to create your first storyboard',"Use project templates for common story types (film, commercial, etc.)","Switch between Grid and Timeline views using the header buttons","Double-click any panel to edit its content"]}]},{id:"ai-assistant",title:"AI Assistant",icon:l,content:[{title:"Story Generation",tips:["Describe your story concept and let AI generate panel scripts","Use specific genres and moods for better results","Ask for revisions by describing what you want changed","Generate multiple variations to compare options"]},{title:"Image Generation",tips:["Be descriptive about visual style, lighting, and composition","Specify camera angles (close-up, wide shot, bird's eye, etc.)","Include artistic styles (photorealistic, cartoon, sketch, etc.)","Mention specific details like time of day, weather, or mood"]},{title:"AI Settings",tips:["Adjust image dimensions for your project needs","Choose between different AI models for varied results","Set consistent style preferences for your entire project","Use custom prompts to maintain visual consistency"]}]},{id:"panel-editing",title:"Panel Editing",icon:Ne,content:[{title:"Panel Content",tips:["Write clear, concise scene descriptions","Include dialogue, sound effects, and camera notes","Use the visual notes section for specific shot details","Add timing information for animated sequences"]},{title:"Organization",tips:["Use meaningful panel titles for easy navigation","Organize panels logically in sequence","Use the timeline view to see story flow","Drag and drop panels to reorder them"]}]},{id:"video-prompts",title:"Video Generation",icon:le,content:[{title:"Creating Video Prompts",tips:["Generate detailed video prompts from your storyboard","Include camera movements, transitions, and effects","Specify duration and pacing for each shot","Export prompts for use with video AI tools like Runway or Pika"]}]},{id:"project-management",title:"Project Management",icon:ke,content:[{title:"Saving & Loading",tips:["Projects auto-save as you work","Export projects as JSON files for backup","Import existing projects to continue work","Use descriptive project names and descriptions"]}]},{id:"customization",title:"Customization",icon:g,content:[{title:"Themes & Display",tips:["Choose from multiple color themes in settings","Themes apply consistently across all interfaces","Dark mode reduces eye strain during long sessions","Colored themes can match your project's mood"]},{title:"Views & Layout",tips:["Grid view: Best for detailed panel editing","Timeline view: Perfect for story flow and sequencing","Resize panels by dragging corners","Use full-screen mode for focused work"]}]}];return r?t.jsx(yt,{isOpen:r,onClose:a,title:"Storyboard AI User Guide",subtitle:"Learn how to create amazing storyboards",icon:t.jsx(T,{className:"w-5 h-5"}),defaultWidth:"min(92vw, 900px)",defaultHeight:"min(85vh, 700px)",maxWidth:"98vw",maxHeight:"95vh",resizable:!0,minimizable:!0,maximizable:!0,windowId:"user-guide",zIndex:9100,children:t.jsx("div",{className:"h-full overflow-y-auto",children:t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[t.jsx(T,{className:"h-6 w-6",style:{color:s.theme.colors.primary[600]}}),t.jsx("h2",{className:"text-xl font-semibold",style:{color:s.theme.colors.text.primary},children:"Welcome to Storyboard AI"})]}),t.jsxs("div",{className:"space-y-4 p-6",children:[c.map((e=>{const r=e.icon,a=o.has(e.id);return t.jsxs("div",{className:"border rounded-lg overflow-hidden",style:{backgroundColor:s.theme.colors.background.secondary,borderColor:s.theme.colors.border.primary},children:[t.jsxs("button",{onClick:()=>(e=>{const t=new Set(o);t.has(e)?t.delete(e):t.add(e),n(t)})(e.id),className:"w-full flex items-center justify-between p-4 text-left transition-colors",style:{color:s.theme.colors.text.primary},onMouseOver:e=>{e.currentTarget.style.backgroundColor=s.theme.colors.background.tertiary},onMouseOut:e=>{e.currentTarget.style.backgroundColor="transparent"},children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(r,{className:"h-5 w-5",style:{color:s.theme.colors.primary[600]}}),t.jsx("span",{className:"font-medium",children:e.title})]}),a?t.jsx(A,{className:"h-4 w-4"}):t.jsx(i,{className:"h-4 w-4"})]}),a&&t.jsx("div",{className:"px-4 pb-4",children:e.content.map(((e,r)=>t.jsxs("div",{className:"mb-4 last:mb-0",children:[t.jsx("h4",{className:"font-medium mb-2",style:{color:s.theme.colors.text.primary},children:e.title}),t.jsx("ul",{className:"space-y-2",children:e.tips.map(((e,r)=>t.jsxs("li",{className:"flex items-start space-x-2 text-sm",style:{color:s.theme.colors.text.secondary},children:[t.jsx("span",{className:"block w-1 h-1 rounded-full mt-2 flex-shrink-0",style:{backgroundColor:s.theme.colors.primary[500]}}),t.jsx("span",{children:e})]},r)))})]},r)))})]},e.id)})),t.jsxs("div",{className:"border rounded-lg p-4 mt-6",style:{backgroundColor:s.theme.colors.primary[50],borderColor:s.theme.colors.primary[200]},children:[t.jsxs("h3",{className:"font-semibold mb-3 flex items-center space-x-2",style:{color:s.theme.colors.primary[800]},children:[t.jsx(F,{className:"h-5 w-5"}),t.jsx("span",{children:"Pro Tips"})]}),t.jsxs("ul",{className:"space-y-2 text-sm",children:[t.jsx("li",{style:{color:s.theme.colors.primary[700]},children:"â€¢ Use keyboard shortcuts: Ctrl/Cmd + N for new panel, Ctrl/Cmd + S to save"}),t.jsx("li",{style:{color:s.theme.colors.primary[700]},children:"â€¢ Right-click panels for quick actions like duplicate, delete, or move"}),t.jsx("li",{style:{color:s.theme.colors.primary[700]},children:"â€¢ Keep AI prompts specific but not overly detailed for best results"}),t.jsx("li",{style:{color:s.theme.colors.primary[700]},children:"â€¢ Use the timeline view to spot pacing issues in your story"})]})]})]})]})})}):null},Wt=[{id:"storyboard",label:"Storyboard",icon:t.jsx(o,{className:"w-6 h-6"}),description:"Create and edit panels"},{id:"ai-assistant",label:"AI Assistant",icon:t.jsx(c,{className:"w-6 h-6"}),description:"Chat with AI helper"},{id:"video-prompts",label:"Video Prompts",icon:t.jsx(d,{className:"w-6 h-6"}),description:"Generate video prompts"},{id:"projects",label:"Projects",icon:t.jsx(ke,{className:"w-6 h-6"}),description:"Manage projects"},{id:"templates",label:"Templates",icon:t.jsx(p,{className:"w-6 h-6"}),description:"Browse templates"},{id:"settings",label:"Settings",icon:t.jsx(g,{className:"w-6 h-6"}),description:"App preferences"}];function _t({isOpen:r,onClose:a,onNavigate:s,currentSection:i}){const[l,c]=e.useState(!1),{state:d}=Je();e.useEffect((()=>(r?(document.body.style.overflow="hidden",c(!1)):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"})),[r]);const m=()=>{c(!0),setTimeout((()=>{a(),c(!1)}),300)};return r||l?t.jsxs("div",{className:"fixed inset-0 z-50 md:hidden",children:[t.jsx("div",{className:"absolute inset-0 bg-black transition-opacity duration-300 "+(r&&!l?"bg-opacity-60":"bg-opacity-0"),onClick:m}),t.jsxs("div",{className:"absolute left-0 top-0 h-full w-80 max-w-[85vw] shadow-2xl transform transition-transform duration-300 ease-out "+(r&&!l?"translate-x-0":"-translate-x-full"),style:{backgroundColor:d.theme.colors.background.primary,borderRight:`1px solid ${d.theme.colors.border.primary}`},children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b text-white",style:{background:`linear-gradient(135deg, ${d.theme.colors.primary[600]}, ${d.theme.colors.primary[700]})`,borderColor:d.theme.colors.border.primary},children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center",style:{backgroundColor:"rgba(255, 255, 255, 0.2)"},children:t.jsx(o,{className:"w-6 h-6"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"font-bold text-lg",children:"Storyboard AI"}),t.jsx("p",{className:"text-white/80 text-sm",children:"Navigation Menu"})]})]}),t.jsx("button",{onClick:m,className:"w-10 h-10 rounded-lg flex items-center justify-center transition-colors hover:bg-white/20",style:{backgroundColor:"rgba(255, 255, 255, 0.1)"},children:t.jsx(n,{className:"w-6 h-6"})})]}),t.jsxs("div",{className:"flex-1 overflow-y-auto scrollable",children:[t.jsx("div",{className:"p-4 space-y-2",children:Wt.map(((e,r)=>t.jsxs("button",{onClick:()=>{return t=e.id,s(t),void m();var t},className:"w-full flex items-center space-x-4 p-4 rounded-xl transition-all duration-200 transform hover:scale-105 animate-menu-item-entrance transform-gpu border-2 "+(i===e.id?"shadow-lg":"border-transparent hover:shadow-md"),style:{animationDelay:50*r+"ms",backgroundColor:i===e.id?`${d.theme.colors.primary[100]}`:d.theme.colors.background.secondary,borderColor:i===e.id?d.theme.colors.primary[300]:"transparent"},children:[t.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center shadow-sm",style:{background:i===e.id?`linear-gradient(135deg, ${d.theme.colors.primary[500]}, ${d.theme.colors.primary[600]})`:d.theme.colors.background.primary,color:i===e.id?"white":d.theme.colors.text.secondary},children:e.icon}),t.jsxs("div",{className:"flex-1 text-left",children:[t.jsx("h3",{className:"font-semibold",style:{color:i===e.id?d.theme.colors.primary[700]:d.theme.colors.text.primary},children:e.label}),t.jsx("p",{className:"text-sm",style:{color:d.theme.colors.text.tertiary},children:e.description})]}),i===e.id&&t.jsx("div",{className:"w-3 h-3 rounded-full animate-pulse",style:{backgroundColor:d.theme.colors.primary[500]}})]},e.id)))}),t.jsx("div",{className:"p-4 mt-8 border-t",style:{borderColor:d.theme.colors.border.primary},children:t.jsxs("div",{className:"rounded-xl p-4",style:{backgroundColor:`${d.theme.colors.primary[50]}`,border:`1px solid ${d.theme.colors.primary[200]}`},children:[t.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[t.jsx(u,{className:"w-5 h-5",style:{color:d.theme.colors.primary[600]}}),t.jsx("span",{className:"font-medium",style:{color:d.theme.colors.primary[800]},children:"Quick Tip"})]}),t.jsx("p",{className:"text-sm",style:{color:d.theme.colors.primary[700]},children:"Swipe right or tap the menu button to access navigation anytime. Long press panels for quick actions!"})]})})]})]})]}):null}var Bt=Object.defineProperty,Ht=(e,t,r)=>((e,t,r)=>t in e?Bt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r)(e,"symbol"!=typeof t?t+"":t,r);const Gt=class e{constructor(){Ht(this,"progressCallback")}static getInstance(){return e.instance||(e.instance=new e),e.instance}setProgressCallback(e){this.progressCallback=e}updateProgress(e,t,r,a,s){this.progressCallback&&this.progressCallback({stage:e,progress:t,total:r,currentItem:a,errors:s})}async exportProject(e,t){const r=Oe.getSettings(),a={...t,quality:t.quality||r.videoQuality||"high"};switch(a.format){case"json":return this.exportAsJSON(e,a);case"pdf":return this.exportAsPDF(e,a);case"images":return this.exportAsImageBundle(e,a);case"video-sequence":return this.exportAsVideoSequence(e,a);case"html":return this.exportAsHTML(e,a);default:throw new Error(`Unsupported export format: ${a.format}`)}}async exportAsJSON(e,t){this.updateProgress("Preparing JSON export",0,3);const r={...e,panels:await Promise.all(e.panels.map((async e=>{let r=e.imageUrl;if(e.imageUrl&&e.imageUrl.startsWith("stored:"))try{const t=e.imageUrl.replace("stored:",""),a=await Oe.getImageFromDB(t);a?(r=a,console.log(`ðŸ“¸ Restored image for export: ${t}`)):(console.warn(`âš ï¸ Could not restore image: ${t}`),r=void 0)}catch(a){console.warn("Error restoring image:",a),r=void 0}return{...e,imageUrl:!1!==t.includeImages?r:void 0,videoPrompt:e.videoPrompt||e.aiGeneratedPrompt,aiGeneratedPrompt:e.aiGeneratedPrompt||e.videoPrompt}})))};this.updateProgress("Creating export data",1,3);const a={project:r,metadata:{exportedAt:(new Date).toISOString(),exportedBy:"Storyboard AI",version:"1.0.0",options:{includeImages:!1!==t.includeImages,includeVideos:!1!==t.includeVideos,includePrompts:!1!==t.includePrompts,includeNotes:!1!==t.includeNotes}},settings:(()=>{const e=Oe.getSettings();return e.openaiApiKey&&(e.openaiApiKey="[REMOVED_FOR_SECURITY]"),e})()};this.updateProgress("Finalizing JSON export",2,3);const s=JSON.stringify(a,null,2);return this.updateProgress("JSON export complete",3,3),new Blob([s],{type:"application/json"})}async exportAsPDF(e,t){const r=await Se((()=>import("./pdf-Dpb-j42P.js").then((e=>e.j))),__vite__mapDeps([0,1,2])).then((e=>e.default));this.updateProgress("Initializing PDF export",0,e.panels.length+3);const a=new r({orientation:t.orientation||"portrait",unit:"mm",format:t.pageSize||"a4"}),s=a.internal.pageSize.getWidth(),o=a.internal.pageSize.getHeight(),n=20,i=s-40;if(a.setFontSize(24),a.text(e.title,n,40),a.setFontSize(12),e.description&&a.text(e.description,n,55),a.text(`Created: ${e.createdAt.toLocaleDateString()}`,n,70),a.text(`Updated: ${e.updatedAt.toLocaleDateString()}`,n,80),a.text(`Panels: ${e.panels.length}`,n,90),e.directorNotes&&!1!==t.includeNotes){a.setFontSize(14),a.text("Director Notes:",n,110),a.setFontSize(10);const t=a.splitTextToSize(e.directorNotes,i);a.text(t,n,125)}this.updateProgress("Creating title page",1,e.panels.length+3);for(let d=0;d<e.panels.length;d++){const r=e.panels[d];this.updateProgress("Adding panels to PDF",d+2,e.panels.length+3,`Panel ${d+1}: ${r.title}`),a.addPage(),a.setFontSize(16),a.text(`Panel ${d+1}: ${r.title}`,n,35);let s=55;if(r.imageUrl&&!1!==t.includeImages)try{let e=r.imageUrl;if(r.imageUrl.startsWith("stored:")){const t=r.imageUrl.replace("stored:",""),a=await Oe.getImageFromDB(t);if(!a)throw new Error(`Could not restore image: ${t}`);e=a,console.log(`ðŸ“¸ Restored image for PDF: ${t}`)}const o=document.createElement("canvas"),l=o.getContext("2d"),c=new Image;await new Promise(((r,d)=>{c.onload=()=>{const e=.9*i,d="ultra"===t.quality?300:"high"===t.quality?200:150;let{width:m,height:p}=c;const h=Math.min(e/m,d/p);m*=h,p*=h,o.width=m,o.height=p,l&&(l.imageSmoothingEnabled=!0,l.imageSmoothingQuality="high",l.drawImage(c,0,0,m,p));const u="ultra"===t.quality?"image/png":"image/jpeg",g="ultra"===t.quality?1:"high"===t.quality?.95:.85,y=l.canvas.toDataURL(u,g),x="image/png"===u?"PNG":"JPEG";a.addImage(y,x,n,s,.8*m,.8*p),s+=.8*p+10,r(null)},c.onerror=d,c.src=e}))}catch(c){console.warn(`Failed to add image for panel ${d+1}:`,c)}a.setFontSize(12),a.text("Description:",n,s),s+=7,a.setFontSize(10);const o=a.splitTextToSize(r.description,i);if(a.text(o,n,s),s+=5*o.length+10,a.setFontSize(10),a.text(`Shot Type: ${r.shotType}`,n,s),a.text(`Camera Angle: ${r.cameraAngle}`,n+i/2,s),s+=7,a.text(`Duration: ${r.duration}s`,n,s),s+=10,r.notes&&!1!==t.includeNotes){a.setFontSize(11),a.text("Notes:",n,s),s+=7,a.setFontSize(9);const e=a.splitTextToSize(r.notes,i);a.text(e,n,s),s+=4*e.length+10}const l=r.videoPrompt||r.aiGeneratedPrompt;if(l&&!1!==t.includePrompts){a.setFontSize(11),a.text("Video Prompt:",n,s),s+=7,a.setFontSize(9);const e=a.splitTextToSize(l,i);a.text(e,n,s)}}this.updateProgress("Finalizing PDF",e.panels.length+2,e.panels.length+3);const l=a.getNumberOfPages();for(let d=1;d<=l;d++)a.setPage(d),a.setFontSize(8),a.text(`Page ${d} of ${l}`,s-n-20,o-10),a.text(`${e.title} - Storyboard AI`,n,o-10);return this.updateProgress("PDF export complete",e.panels.length+3,e.panels.length+3),new Blob([a.output("blob")],{type:"application/pdf"})}async exportAsImageBundle(e,t){const r=await Se((()=>import("./jszip.min-2X8rbmn9.js").then((e=>e.j))),__vite__mapDeps([3,2])).then((e=>e.default));this.updateProgress("Creating image bundle",0,e.panels.length+2);const a=new r,s=a.folder("images"),o=[],n={title:e.title,description:e.description,createdAt:e.createdAt,updatedAt:e.updatedAt,totalPanels:e.panels.length,directorNotes:e.directorNotes};a.file("project-info.json",JSON.stringify(n,null,2));for(let d=0;d<e.panels.length;d++){const t=e.panels[d];if(this.updateProgress("Processing images",d+1,e.panels.length+2,`Panel ${d+1}: ${t.title}`),t.imageUrl)try{let e,r=t.imageUrl;if(t.imageUrl.startsWith("stored:")){const e=t.imageUrl.replace("stored:",""),a=await Oe.getImageFromDB(e);if(!a)throw new Error(`Could not restore image: ${e}`);r=a,console.log(`ðŸ“¸ Restored image for bundle: ${e}`)}if(r.startsWith("data:")){const t=await fetch(r);e=await t.blob()}else{const t=await fetch(r);e=await t.blob()}const o=`panel_${String(d+1).padStart(3,"0")}_${t.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}.jpg`;null==s||s.file(o,e);const n={order:d+1,title:t.title,description:t.description,shotType:t.shotType,cameraAngle:t.cameraAngle,duration:t.duration,notes:t.notes,videoPrompt:t.videoPrompt||t.aiGeneratedPrompt,fileName:o};a.file(`panel_${String(d+1).padStart(3,"0")}_info.json`,JSON.stringify(n,null,2))}catch(c){const e=`Failed to export image for panel ${d+1}: ${t.title}`;o.push(e),console.warn(e,c)}}const i={exportedAt:(new Date).toISOString(),exportedBy:"Storyboard AI",project:n,totalImages:e.panels.filter((e=>e.imageUrl)).length,errors:o.length>0?o:void 0};a.file("export-summary.json",JSON.stringify(i,null,2)),this.updateProgress("Compressing image bundle",e.panels.length+2,e.panels.length+2);const l=await a.generateAsync({type:"blob",compression:!1!==t.compression?"DEFLATE":"STORE",compressionOptions:{level:"ultra"===t.quality?9:"high"===t.quality?6:3}});return o.length>0&&this.updateProgress("Image bundle complete with errors",e.panels.length+2,e.panels.length+2,void 0,o),l}async exportAsVideoSequence(e,t){this.updateProgress("Creating video sequence export",0,1);const r={project:{title:e.title,description:e.description,totalDuration:e.panels.reduce(((e,t)=>e+t.duration),0)},sequence:e.panels.map(((t,r)=>({order:r+1,title:t.title,description:t.description,duration:t.duration,shotType:t.shotType,cameraAngle:t.cameraAngle,notes:t.notes,videoPrompt:t.videoPrompt||t.aiGeneratedPrompt,imageReference:t.imageUrl?`panel_${String(r+1).padStart(3,"0")}.jpg`:null,timecode:{start:e.panels.slice(0,r).reduce(((e,t)=>e+t.duration),0),end:e.panels.slice(0,r+1).reduce(((e,t)=>e+t.duration),0)}}))),metadata:{exportedAt:(new Date).toISOString(),exportedBy:"Storyboard AI",version:"1.0.0",format:"video-sequence",settings:{quality:t.quality,includePrompts:!1!==t.includePrompts}},directorNotes:e.directorNotes,videoStyle:e.videoStyle};this.updateProgress("Video sequence export complete",1,1);const a=JSON.stringify(r,null,2);return new Blob([a],{type:"application/json"})}async exportAsHTML(e,t){this.updateProgress("Creating HTML export",0,2);const r=await Promise.all(e.panels.map((async e=>{let t=e.imageUrl;if(e.imageUrl&&e.imageUrl.startsWith("stored:"))try{const r=e.imageUrl.replace("stored:",""),a=await Oe.getImageFromDB(r);a?(t=a,console.log(`ðŸ“¸ Restored image for HTML: ${r}`)):(console.warn(`âš ï¸ Could not restore image: ${r}`),t=void 0)}catch(r){console.warn("Error restoring image:",r),t=void 0}return{...e,imageUrl:t}})));this.updateProgress("Generating HTML content",1,2);const a=`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>${e.title} - Storyboard</title>\n    <style>\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n            line-height: 1.6;\n            color: #333;\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 20px;\n            background: #f8f9fa;\n        }\n        .header {\n            background: white;\n            padding: 30px;\n            border-radius: 12px;\n            box-shadow: 0 2px 20px rgba(0,0,0,0.1);\n            margin-bottom: 30px;\n        }\n        .project-title {\n            font-size: 2.5rem;\n            font-weight: bold;\n            margin-bottom: 10px;\n            color: #2c3e50;\n        }\n        .project-description {\n            font-size: 1.2rem;\n            color: #666;\n            margin-bottom: 20px;\n        }\n        .project-meta {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 15px;\n            font-size: 0.9rem;\n            color: #777;\n        }\n        .director-notes {\n            background: #e8f4fd;\n            padding: 20px;\n            border-radius: 8px;\n            margin: 20px 0;\n            border-left: 4px solid #3498db;\n        }\n        .panels {\n            display: grid;\n            gap: 30px;\n        }\n        .panel {\n            background: white;\n            border-radius: 12px;\n            box-shadow: 0 2px 20px rgba(0,0,0,0.1);\n            overflow: hidden;\n        }\n        .panel-header {\n            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n            color: white;\n            padding: 20px;\n        }\n        .panel-number {\n            font-size: 0.9rem;\n            opacity: 0.9;\n            margin-bottom: 5px;\n        }\n        .panel-title {\n            font-size: 1.5rem;\n            font-weight: bold;\n            margin-bottom: 10px;\n        }\n        .panel-content {\n            padding: 20px;\n        }\n        .panel-image {\n            width: 100%;\n            max-width: 600px;\n            height: auto;\n            border-radius: 8px;\n            margin-bottom: 20px;\n            box-shadow: 0 4px 15px rgba(0,0,0,0.2);\n        }\n        .panel-details {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\n            gap: 15px;\n            margin-bottom: 20px;\n        }\n        .detail-item {\n            background: #f8f9fa;\n            padding: 10px 15px;\n            border-radius: 6px;\n            border-left: 3px solid #3498db;\n        }\n        .detail-label {\n            font-size: 0.8rem;\n            color: #666;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n            margin-bottom: 3px;\n        }\n        .detail-value {\n            font-weight: 600;\n            color: #2c3e50;\n        }\n        .panel-description {\n            font-size: 1rem;\n            line-height: 1.7;\n            margin-bottom: 15px;\n        }\n        .panel-notes {\n            background: #fff3cd;\n            padding: 15px;\n            border-radius: 6px;\n            border-left: 3px solid #ffc107;\n            margin-bottom: 15px;\n        }\n        .panel-prompt {\n            background: #d1ecf1;\n            padding: 15px;\n            border-radius: 6px;\n            border-left: 3px solid #17a2b8;\n            font-family: monospace;\n            font-size: 0.9rem;\n            line-height: 1.5;\n        }\n        .export-info {\n            text-align: center;\n            color: #666;\n            font-size: 0.9rem;\n            margin-top: 30px;\n            padding: 20px;\n            background: white;\n            border-radius: 8px;\n        }\n        @media print {\n            body { background: white; }\n            .panel { break-inside: avoid; margin-bottom: 30px; }\n        }\n    </style>\n</head>\n<body>\n    <div class="header">\n        <h1 class="project-title">${e.title}</h1>\n        ${e.description?`<p class="project-description">${e.description}</p>`:""}\n        <div class="project-meta">\n            <div><strong>Created:</strong> ${e.createdAt.toLocaleDateString()}</div>\n            <div><strong>Updated:</strong> ${e.updatedAt.toLocaleDateString()}</div>\n            <div><strong>Total Panels:</strong> ${r.length}</div>\n            <div><strong>Total Duration:</strong> ${r.reduce(((e,t)=>e+t.duration),0)}s</div>\n        </div>\n        ${e.directorNotes&&!1!==t.includeNotes?`\n        <div class="director-notes">\n            <h3>Director's Notes</h3>\n            <p>${e.directorNotes.replace(/\n/g,"<br>")}</p>\n        </div>\n        `:""}\n    </div>\n\n    <div class="panels">\n        ${r.map(((e,r)=>`\n        <div class="panel">\n            <div class="panel-header">\n                <div class="panel-number">Panel ${r+1}</div>\n                <div class="panel-title">${e.title}</div>\n            </div>\n            <div class="panel-content">\n                ${e.imageUrl&&!1!==t.includeImages?`\n                <img src="${e.imageUrl}" alt="${e.title}" class="panel-image">\n                `:""}\n                \n                <div class="panel-description">${e.description}</div>\n                \n                <div class="panel-details">\n                    <div class="detail-item">\n                        <div class="detail-label">Shot Type</div>\n                        <div class="detail-value">${e.shotType}</div>\n                    </div>\n                    <div class="detail-item">\n                        <div class="detail-label">Camera Angle</div>\n                        <div class="detail-value">${e.cameraAngle}</div>\n                    </div>\n                    <div class="detail-item">\n                        <div class="detail-label">Duration</div>\n                        <div class="detail-value">${e.duration}s</div>\n                    </div>\n                </div>\n                \n                ${e.notes&&!1!==t.includeNotes?`\n                <div class="panel-notes">\n                    <strong>Notes:</strong><br>\n                    ${e.notes.replace(/\n/g,"<br>")}\n                </div>\n                `:""}\n                \n                ${(e.videoPrompt||e.aiGeneratedPrompt)&&!1!==t.includePrompts?`\n                <div class="panel-prompt">\n                    <strong>Video Prompt:</strong><br>\n                    ${(e.videoPrompt||e.aiGeneratedPrompt||"").replace(/\n/g,"<br>")}\n                </div>\n                `:""}\n            </div>\n        </div>\n        `)).join("")}\n    </div>\n\n    <div class="export-info">\n        Exported from Storyboard AI on ${(new Date).toLocaleDateString()}\n    </div>\n</body>\n</html>\n    `.trim();return this.updateProgress("HTML export complete",2,2),a}async downloadExport(e,t){try{const r=await this.exportProject(e,t);let a,s,o;switch(t.format){case"json":a=`${e.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_export.json`,s="application/json",o=r;break;case"pdf":a=`${e.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_storyboard.pdf`,s="application/pdf",o=r;break;case"images":a=`${e.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_images.zip`,s="application/zip",o=r;break;case"video-sequence":a=`${e.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_video_sequence.json`,s="application/json",o=r;break;case"html":a=`${e.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_storyboard.html`,s="text/html",o=new Blob([r],{type:s});break;default:throw new Error(`Unsupported download format: ${t.format}`)}const n=o instanceof Blob?URL.createObjectURL(o):`data:${s};charset=utf-8,${encodeURIComponent(o)}`,i=document.createElement("a");i.href=n,i.download=a,document.body.appendChild(i),i.click(),document.body.removeChild(i),o instanceof Blob&&URL.revokeObjectURL(n)}catch(r){throw console.error("Export failed:",r),r}}};Ht(Gt,"instance");const qt=Gt.getInstance();function Vt({isOpen:r,onClose:a}){var s;const{state:o}=We(),{state:n}=Je(),i=n.theme,[l,c]=e.useState("json"),[d,m]=e.useState(!1),[h,u]=e.useState(null),[g,y]=e.useState(null),[x,f]=e.useState(!1),[b,v]=e.useState(null),[w,j]=e.useState({quality:"high",includeImages:!0,includePrompts:!0,includeNotes:!0,compression:!0,pageSize:"A4",orientation:"portrait"});e.useEffect((()=>{r&&(f(!1),v(null),console.log("ðŸš€ ExportDialog opened"))}),[r]),e.useEffect((()=>{try{const e=Oe.getSettings();j((t=>({...t,format:l,quality:e.videoQuality||"high"})))}catch(e){console.error("âŒ Error loading export settings:",e),v("Failed to load export settings")}}),[l]),e.useEffect((()=>{try{return qt.setProgressCallback(u),()=>{qt.setProgressCallback((()=>{}))}}catch(e){console.error("âŒ Error setting up progress callback:",e),v("Failed to initialize export system")}}),[]);const k=[{value:"json",label:"JSON Project",description:"Complete project data for import/backup",icon:p,color:"blue"},{value:"pdf",label:"PDF Storyboard",description:"Professional presentation format",icon:p,color:"red"},{value:"images",label:"Image Bundle",description:"ZIP file with all panel images",icon:Ce,color:"green"},{value:"video-sequence",label:"Video Sequence",description:"Timeline data for video editing",icon:le,color:"purple"},{value:"html",label:"HTML Storyboard",description:"Shareable web page format",icon:je,color:"orange"}],C=()=>h?Math.round(h.progress/h.total*100):0;return r?x&&b?t.jsx(yt,{isOpen:r,onClose:a,title:"Export Error",subtitle:"Something went wrong",icon:t.jsx(N,{className:"w-5 h-5"}),defaultWidth:"400px",defaultHeight:"300px",windowId:"export-error",zIndex:9200,children:t.jsxs("div",{className:"p-6 text-center",children:[t.jsx("div",{className:"mb-4",children:t.jsx(se,{className:"w-12 h-12 mx-auto text-red-500"})}),t.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Export Failed"}),t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:b}),t.jsxs("div",{className:"flex space-x-3 justify-center",children:[t.jsx("button",{onClick:()=>{f(!1),v(null)},className:"px-4 py-2 rounded-lg",style:{backgroundColor:i.colors.background.tertiary,color:i.colors.text.primary,border:`1px solid ${i.colors.border.primary}`},children:"Try Again"}),t.jsx("button",{onClick:a,className:"px-4 py-2 rounded-lg",style:{backgroundColor:i.colors.primary[500],color:"#ffffff"},children:"Close"})]})]})}):t.jsx(yt,{isOpen:r,onClose:a,title:"Export Project",subtitle:`Export "${(null==(s=o.currentProject)?void 0:s.title)||"Untitled"}" in various formats`,icon:t.jsx(N,{className:"w-5 h-5"}),defaultWidth:"min(90vw, 800px)",defaultHeight:"min(85vh, 700px)",maxWidth:"95vw",maxHeight:"95vh",resizable:!0,minimizable:!0,maximizable:!0,windowId:"export-dialog",zIndex:9200,children:t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsx("div",{className:"p-6 border-b",style:{backgroundColor:i.colors.background.secondary,borderColor:i.colors.border.primary},children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold",style:{color:i.colors.text.primary},children:"Choose Export Format"}),t.jsx("p",{className:"text-sm mt-1",style:{color:i.colors.text.secondary},children:"Select how you want to export your storyboard"})]}),o.currentProject&&t.jsxs("div",{className:"text-right",children:[t.jsx("div",{className:"text-sm font-medium",style:{color:i.colors.text.primary},children:o.currentProject.title}),t.jsxs("div",{className:"text-xs",style:{color:i.colors.text.tertiary},children:[o.panels.length," panels â€¢ Updated ",o.currentProject.updatedAt.toLocaleDateString()]})]})]})}),t.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[t.jsxs("div",{className:"space-y-4 mb-8",children:[t.jsx("h4",{className:"font-medium",style:{color:i.colors.text.primary},children:"Export Format"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:k.map((e=>{const r=e.icon,a=l===e.value;return t.jsx("button",{onClick:()=>c(e.value),className:"p-4 rounded-xl border-2 transition-all duration-200 text-left",style:{backgroundColor:a?`${i.colors.primary[500]}20`:i.colors.background.tertiary,borderColor:a?i.colors.primary[500]:i.colors.border.primary,color:i.colors.text.primary},children:t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:`${i.colors.primary[500]}20`},children:t.jsx(r,{className:"w-5 h-5",style:{color:i.colors.primary[500]}})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-medium",children:e.label}),t.jsx("div",{className:"text-sm mt-1",style:{color:i.colors.text.secondary},children:e.description})]}),a&&t.jsx(oe,{className:"w-5 h-5",style:{color:i.colors.primary[500]}})]})},e.value)}))})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsx("h4",{className:"font-medium",style:{color:i.colors.text.primary},children:"Export Options"}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:i.colors.text.primary},children:"Quality"}),t.jsx("div",{className:"grid grid-cols-3 gap-2",children:["standard","high","ultra"].map((e=>t.jsx("button",{onClick:()=>j((t=>({...t,quality:e}))),className:"p-2 rounded-lg text-sm font-medium transition-all duration-200",style:{backgroundColor:w.quality===e?i.colors.primary[500]:i.colors.background.tertiary,color:w.quality===e?"#ffffff":i.colors.text.primary,border:`1px solid ${w.quality===e?i.colors.primary[500]:i.colors.border.primary}`},children:e.charAt(0).toUpperCase()+e.slice(1)},e)))})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:w.includeImages,onChange:e=>j((t=>({...t,includeImages:e.target.checked}))),className:"rounded border-2",style:{borderColor:i.colors.border.primary,backgroundColor:i.colors.background.primary}}),t.jsx("span",{className:"text-sm",style:{color:i.colors.text.primary},children:"Include Images"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:w.includePrompts,onChange:e=>j((t=>({...t,includePrompts:e.target.checked}))),className:"rounded border-2",style:{borderColor:i.colors.border.primary,backgroundColor:i.colors.background.primary}}),t.jsx("span",{className:"text-sm",style:{color:i.colors.text.primary},children:"Include Video Prompts"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:w.includeNotes,onChange:e=>j((t=>({...t,includeNotes:e.target.checked}))),className:"rounded border-2",style:{borderColor:i.colors.border.primary,backgroundColor:i.colors.background.primary}}),t.jsx("span",{className:"text-sm",style:{color:i.colors.text.primary},children:"Include Notes"})]}),t.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:w.compression,onChange:e=>j((t=>({...t,compression:e.target.checked}))),className:"rounded border-2",style:{borderColor:i.colors.border.primary,backgroundColor:i.colors.background.primary}}),t.jsx("span",{className:"text-sm",style:{color:i.colors.text.primary},children:"Use Compression"})]})]}),"pdf"===l&&t.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:i.colors.text.primary},children:"Page Size"}),t.jsxs("select",{value:w.pageSize,onChange:e=>j((t=>({...t,pageSize:e.target.value}))),className:"w-full p-2 rounded-lg border",style:{backgroundColor:i.colors.background.tertiary,borderColor:i.colors.border.primary,color:i.colors.text.primary},children:[t.jsx("option",{value:"A4",children:"A4"}),t.jsx("option",{value:"Letter",children:"Letter"}),t.jsx("option",{value:"Legal",children:"Legal"}),t.jsx("option",{value:"A3",children:"A3"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:i.colors.text.primary},children:"Orientation"}),t.jsxs("select",{value:w.orientation,onChange:e=>j((t=>({...t,orientation:e.target.value}))),className:"w-full p-2 rounded-lg border",style:{backgroundColor:i.colors.background.tertiary,borderColor:i.colors.border.primary,color:i.colors.text.primary},children:[t.jsx("option",{value:"portrait",children:"Portrait"}),t.jsx("option",{value:"landscape",children:"Landscape"})]})]})]})]}),d&&h&&t.jsxs("div",{className:"mt-8 p-4 rounded-xl border",style:{backgroundColor:i.colors.background.secondary,borderColor:i.colors.border.primary},children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium",style:{color:i.colors.text.primary},children:h.stage}),t.jsxs("span",{className:"text-sm",style:{color:i.colors.text.secondary},children:[C(),"%"]})]}),t.jsx("div",{className:"w-full h-2 rounded-full overflow-hidden",style:{backgroundColor:i.colors.background.tertiary},children:t.jsx("div",{className:"h-full transition-all duration-300",style:{backgroundColor:i.colors.primary[500],width:`${C()}%`}})}),h.currentItem&&t.jsx("div",{className:"text-xs mt-2",style:{color:i.colors.text.tertiary},children:h.currentItem}),h.errors&&h.errors.length>0&&t.jsx("div",{className:"mt-2 space-y-1",children:h.errors.map(((e,r)=>t.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[t.jsx(se,{className:"w-3 h-3 text-red-500"}),t.jsx("span",{style:{color:i.colors.text.tertiary},children:e})]},r)))})]}),g&&!d&&t.jsxs("div",{className:"mt-8 p-4 rounded-xl border",style:{backgroundColor:g.success?"#10b98120":"#ef444420",borderColor:g.success?"#10b981":"#ef4444"},children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[g.success?t.jsx(oe,{className:"w-5 h-5 text-green-600"}):t.jsx(se,{className:"w-5 h-5 text-red-600"}),t.jsx("span",{className:"font-medium",style:{color:g.success?"#10b981":"#ef4444"},children:g.message})]}),g.filename&&t.jsxs("div",{className:"text-sm mt-1",style:{color:i.colors.text.secondary},children:["Saved as: ",g.filename]})]})]}),t.jsxs("div",{className:"p-6 border-t flex justify-between items-center",style:{backgroundColor:i.colors.background.secondary,borderColor:i.colors.border.primary},children:[t.jsxs("div",{className:"text-sm",style:{color:i.colors.text.secondary},children:[o.panels.length," panels ready for export"]}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("button",{onClick:a,disabled:d,className:"px-4 py-2 rounded-lg transition-all duration-200 disabled:opacity-50",style:{backgroundColor:i.colors.background.tertiary,color:i.colors.text.primary,border:`1px solid ${i.colors.border.primary}`},children:"Cancel"}),t.jsx("button",{onClick:async()=>{if(o.currentProject){m(!0),u(null),y(null),f(!1),v(null);try{console.log("ðŸŽ¬ Starting export process...",{format:l,project:o.currentProject.title});const e={...w,format:l};await qt.downloadExport(o.currentProject,e);const t=`${o.currentProject.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_${l}`;y({success:!0,message:`Successfully exported ${o.currentProject.title}`,filename:t}),await Oe.saveSettings({exportFormat:l}),console.log("âœ… Export completed successfully")}catch(e){console.error("âŒ Export failed:",e),f(!0);const t=e instanceof Error?e.message:"Export failed";v(t),y({success:!1,message:t})}finally{m(!1),u(null)}}else alert("No project to export")},disabled:d||!o.currentProject||0===o.panels.length,className:"px-6 py-2 rounded-lg font-medium transition-all duration-200 disabled:opacity-50 flex items-center space-x-2",style:{backgroundColor:i.colors.primary[500],color:"#ffffff"},children:d?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),t.jsx("span",{children:"Exporting..."})]}):t.jsxs(t.Fragment,{children:[t.jsx(N,{className:"w-4 h-4"}),t.jsxs("span",{children:["Export ",l.toUpperCase()]})]})})]})]})]})}):null}function Jt(){const{state:r}=We(),[a,s]=e.useState(null),[o,n]=e.useState(!1),[i,m]=e.useState([]),[u,g]=e.useState(!1),[y,x]=e.useState(!1),[f,b]=e.useState(!1),[v,w]=e.useState(!1),[j,N]=e.useState(!1),[k,C]=e.useState(!1),[A,S]=e.useState(!1),[P,I]=e.useState(!1),[T,E]=e.useState(!1),[D,$]=e.useState("grid"),[M,L]=e.useState("storyboard");return t.jsxs("div",{className:"h-screen bg-secondary flex flex-col overflow-hidden relative",children:[t.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[t.jsx("div",{className:"absolute top-20 left-10 w-32 h-32 bg-primary rounded-full mix-blend-multiply opacity-20 animate-float",style:{backgroundColor:"var(--primary-200)"}}),t.jsx("div",{className:"absolute top-40 right-10 w-40 h-40 bg-primary rounded-full mix-blend-multiply opacity-20 animate-float",style:{animationDelay:"2s",backgroundColor:"var(--primary-300)"}}),t.jsx("div",{className:"absolute bottom-20 left-1/3 w-36 h-36 bg-primary rounded-full mix-blend-multiply opacity-20 animate-float",style:{animationDelay:"4s",backgroundColor:"var(--primary-400)"}})]}),t.jsx(Qe,{onToggleAI:()=>n(!o),isAIOpen:o,viewMode:D,onViewModeChange:$,onOpenTemplates:()=>g(!0),onOpenProjectManager:()=>b(!0),onOpenThemeSettings:()=>w(!0),onOpenSettings:()=>N(!0),onOpenUserGuide:()=>C(!0),onOpenExportDialog:()=>E(!0),currentSection:M,onToggleMobileDrawer:()=>I(!P),isMobileDrawerOpen:P}),t.jsxs("div",{className:"flex-1 flex overflow-hidden relative",children:[t.jsx("div",{className:"hidden md:block",children:t.jsx(Xe,{onNewProject:()=>b(!0),onOpenTemplates:()=>g(!0),onToggleAI:()=>n(!o),onGenerateVideoPrompts:()=>x(!0),onOpenProjectManager:()=>b(!0),onOpenSettings:()=>N(!0)})}),t.jsx("main",{className:"flex-1 flex flex-col bg-primary relative overflow-hidden",children:t.jsx("div",{className:"flex-1 overflow-hidden p-2 md:p-4",children:"timeline"===D?t.jsx(ot,{}):t.jsx(st,{selectedPanel:a,onSelectPanel:s,onEditPanel:e=>{if(i.find((t=>t.panelId===e)))return;const t={id:`editor-${e}-${Date.now()}`,panelId:e,isOpen:!0};m((e=>[...e,t])),s(e)}})})})]}),t.jsxs("div",{className:"md:hidden fixed bottom-20 right-4 flex flex-col space-y-3 z-30",children:[t.jsx("button",{onClick:()=>n(!0),className:"w-14 h-14 btn-primary rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 touch-manipulation","aria-label":"Open AI Assistant",children:t.jsx(c,{className:"w-6 h-6"})}),t.jsx("button",{onClick:()=>x(!0),className:"w-14 h-14 btn-success rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 touch-manipulation","aria-label":"Video Prompts",children:t.jsx(d,{className:"w-6 h-6"})}),t.jsx("button",{onClick:()=>g(!0),className:"w-14 h-14 btn-primary rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 touch-manipulation","aria-label":"Templates",children:t.jsx(p,{className:"w-6 h-6"})}),t.jsx("button",{onClick:()=>{const e={id:`temp-panel-${Date.now()}`,order:r.panels.length},t={id:`editor-new-${Date.now()}`,panelId:e.id,isOpen:!0};m((e=>[...e,t]))},className:"w-16 h-16 btn-warning rounded-full flex items-center justify-center shadow-lg hover:shadow-xl transition-all duration-300 transform hover:scale-110 touch-manipulation","aria-label":"Add Panel",children:t.jsx(h,{className:"w-8 h-8"})})]}),t.jsx(_t,{isOpen:P,onClose:()=>I(!1),onNavigate:e=>{switch(L(e),n(!1),x(!1),b(!1),g(!1),w(!1),N(!1),C(!1),S(!1),e){case"ai-assistant":n(!0);break;case"video-prompts":x(!0);break;case"projects":b(!0);break;case"templates":g(!0);break;case"settings":N(!0)}},currentSection:M}),t.jsx(It,{isOpen:o,onClose:()=>n(!1)}),i.map((e=>{const a=r.panels.find((t=>t.id===e.panelId))||null;return t.jsx(Dt,{panel:a,isOpen:e.isOpen,onClose:()=>{return t=e.id,void m((e=>e.filter((e=>e.id!==t))));var t}},e.id)})),t.jsx(Mt,{isOpen:u,onClose:()=>g(!1)}),t.jsx(Lt,{isOpen:y,onClose:()=>x(!1)}),t.jsx(Ft,{isOpen:f,onClose:()=>b(!1)}),t.jsx(Rt,{isOpen:j,onClose:()=>N(!1),onOpenThemeSettings:()=>{N(!1),w(!0)}}),t.jsx(zt,{isOpen:v,onClose:()=>w(!1)}),t.jsx(Ut,{isOpen:k,onClose:()=>C(!1)}),t.jsx(jt,{isOpen:A,onClose:()=>S(!1),onSelectAgent:e=>{console.log("Selected agent:",e),S(!1)}}),t.jsx(Vt,{isOpen:T,onClose:()=>E(!1)}),t.jsxs("div",{className:"md:hidden bg-primary text-primary px-4 py-3 flex items-center justify-between border-t border-primary",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),t.jsx("span",{className:"text-sm font-medium",children:"Ready to create"})]}),t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx(l,{className:"w-4 h-4"}),t.jsx("span",{className:"text-sm",children:"AI Powered"})]})]})]})}function Kt(){return t.jsx(Ve,{children:t.jsx(Ue,{children:t.jsx(Jt,{})})})}console.log("ðŸš€ main.tsx loaded!");const Yt=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),Qt=/iPad|iPhone|iPod/.test(navigator.userAgent);(Yt||Qt)&&console.log("ðŸŽ Safari/iOS detected - using compatibility mode");try{!function(){const e=document.documentElement,t=getComputedStyle(e).getPropertyValue("--bg-primary");t&&""!==t.trim()||(console.warn("âš ï¸ CSS variables not found, initializing defaults"),e.style.setProperty("--bg-primary","#ffffff"),e.style.setProperty("--bg-secondary","#f9fafb"),e.style.setProperty("--bg-tertiary","#f3f4f6"),e.style.setProperty("--text-primary","#111827"),e.style.setProperty("--text-secondary","#4b5563"),e.style.setProperty("--text-tertiary","#6b7280"),e.style.setProperty("--border-primary","#e5e7eb"),e.style.setProperty("--border-secondary","#d1d5db"))}();const e=document.getElementById("root");if(console.log("ðŸ“ Root element:",e),!e)throw new Error("Root element not found!");const r=Te.createRoot(e);console.log("âœ… React root created"),r.render(t.jsx(Kt,{})),console.log("âœ… App rendered!")}catch(Xt){console.error("âŒ Error in main.tsx:",Xt);const e=Xt instanceof Error?Xt.message:String(Xt),t=document.createElement("div");t.style.cssText="\n    padding: 20px;\n    margin: 20px;\n    background: #fee;\n    border: 2px solid #f44;\n    border-radius: 8px;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;\n    color: #333;\n    line-height: 1.5;\n  ",t.innerHTML=`\n    <h2 style="margin: 0 0 10px 0; color: #d00;">ðŸš¨ App Loading Error</h2>\n    <p><strong>Error:</strong> ${e}</p>\n    <p><strong>Browser:</strong> ${navigator.userAgent}</p>\n    <p><strong>Time:</strong> ${(new Date).toLocaleString()}</p>\n    <details style="margin-top: 15px;">\n      <summary style="cursor: pointer; font-weight: bold;">Technical Details</summary>\n      <pre style="background: #f5f5f5; padding: 10px; margin-top: 10px; overflow: auto; font-size: 12px;">${Xt instanceof Error?Xt.stack||"No stack trace available":"Unknown error"}</pre>\n    </details>\n    <p style="margin-top: 15px; font-size: 14px; color: #666;">\n      If this problem persists on Safari, try refreshing the page or check the browser console for more details.\n    </p>\n  `,document.body.appendChild(t)}
